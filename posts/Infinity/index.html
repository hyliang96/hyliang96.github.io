<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon16.png">
  <link rel="mask-icon" href="/images/favicon.svg" color="#222">
  <meta name="google-site-verification" content="VYSqFXy4SdSulNvauNz8l6z0WDUa1-t62R0hKya9Xmw">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"hyliang96.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.8.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>
<meta name="description" content="执行命令或文件 以下对zsh与bash同时成立 参考">
<meta property="og:type" content="article">
<meta property="og:title" content="bash及zsh语法">
<meta property="og:url" content="https://hyliang96.github.io/posts/Infinity/index.html">
<meta property="og:site_name" content="丹炉志">
<meta property="og:description" content="执行命令或文件 以下对zsh与bash同时成立 参考">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-05-24T20:03:03.000Z">
<meta property="article:modified_time" content="2024-10-14T15:51:27.797Z">
<meta property="article:author" content="∞亼">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://hyliang96.github.io/posts/Infinity/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://hyliang96.github.io/posts/Infinity/","path":"posts/Infinity/","title":"bash及zsh语法"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>bash及zsh语法 | 丹炉志</title>
  



<link rel="dns-prefetch" href="https://waline-hyliang96.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">丹炉志</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">深度学习及其运维日志</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>概览</a></li>
        <li class="menu-item menu-item-tools"><a href="/categories/%E5%99%A8/" rel="section"><i class="fa fa-wrench fa-fw"></i>器</a></li>
        <li class="menu-item menu-item-academics"><a href="/categories/%E6%9C%AF/" rel="section"><i class="fa fa-book fa-fw"></i>术</a></li>
        <li class="menu-item menu-item-philosophy"><a href="/categories/%E9%81%93/" rel="section"><i class="fas fa-circle-notch fa-fw"></i>道</a></li>
        <li class="menu-item menu-item-book"><a href="/categories/%E4%B9%A6%E7%B1%8D/" rel="section"><i class="fa fa-bookmark fa-fw"></i>书</a></li>
        <li class="menu-item menu-item-movie"><a href="/categories/%E5%BD%B1/" rel="section"><i class="fa fa-film fa-fw"></i>影</a></li>
        <li class="menu-item menu-item-photo"><a href="/categories/%E7%85%A7%E7%89%87/" rel="section"><i class="fas fa-photo-video fa-fw"></i>相</a></li>
        <li class="menu-item menu-item-essay"><a href="/categories/%E9%9A%8F%E7%AC%94/" rel="section"><i class="fas fa-edit fa-fw"></i>杂谈</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%E6%88%96%E6%96%87%E4%BB%B6"><span class="nav-text">执行命令或文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%A8%E5%BD%93%E5%89%8Dshell%E6%89%A7%E8%A1%8C"><span class="nav-text">在当前shell执行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%80%E6%96%B0shell%E6%89%A7%E8%A1%8C"><span class="nav-text">开新shell执行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%80%E5%AD%90shell%E6%89%A7%E8%A1%8C"><span class="nav-text">开子shell执行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%A1%E9%81%93-%E5%91%BD%E4%BB%A41-%E5%91%BD%E4%BB%A42"><span class="nav-text">管道 命令1 | 命令2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%A1%E9%81%93%E4%B8%8E%E5%BE%AA%E7%8E%AF%E4%BD%93-%E7%AE%A1%E9%81%93%E7%BB%84%E5%90%88"><span class="nav-text">管道与循环体&#x2F;管道组合</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%9D%97%E7%9A%84%E6%80%A7%E8%B4%A8"><span class="nav-text">代码块的性质</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%9D%97%E7%9A%84%E7%BB%84%E5%90%88%E5%91%BD%E4%BB%A4"><span class="nav-text">代码块的组合命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BE%AA%E7%8E%AF%E4%BD%93"><span class="nav-text">循环体</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E4%BD%93"><span class="nav-text">条件体</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%8E%B7%E5%BE%97%E5%91%BD%E4%BB%A4%E8%BE%93%E5%87%BA"><span class="nav-text">获得命令输出</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BE%93%E5%87%BA%E8%BF%94%E5%9B%9E%E4%B8%BA%E5%8C%BF%E5%90%8D%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-text">$(...) &#96;....&#96;输出返回为匿名字符串</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%90shell%E6%89%A7%E8%A1%8C"><span class="nav-text">子shell执行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BE%93%E5%87%BA"><span class="nav-text">输出</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BE%93%E5%87%BA%E8%BF%94%E5%9B%9E%E4%B8%BA%E5%8C%BF%E5%90%8D%E6%96%87%E4%BB%B6"><span class="nav-text">&lt;(...)输出返回为匿名文件</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%90%84%E7%A7%8D%E5%BC%95%E5%8F%B7"><span class="nav-text">各种引号</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BD%AC%E4%B9%89"><span class="nav-text">转义</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%AD%97%E7%AC%A6%E4%B8%B2-%E5%90%84%E7%A7%8D%E5%BC%95%E5%8F%B7"><span class="nav-text">创建字符串, 各种引号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BE%93%E5%87%BA-_2"><span class="nav-text">输出</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%8C%E5%BC%95%E5%8F%B7%E7%9A%84%E4%BC%98%E5%85%88%E7%BA%A7"><span class="nav-text">双引号的优先级</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F"><span class="nav-text">局部变量</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%A4%E6%96%AD"><span class="nav-text">判断</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A6%82%E8%BF%B0"><span class="nav-text">概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%A4%E6%96%AD%E8%AF%AD%E5%8F%A5"><span class="nav-text">判断语句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E7%89%B9%E6%AE%8A%E5%88%A4%E6%96%AD"><span class="nav-text">其他特殊判断</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97"><span class="nav-text">逻辑运算</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8E-%E8%BE%A8%E6%9E%90"><span class="nav-text">[[ ... ]] 与 [ ... ] 辨析</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%BE%93%E5%85%A5"><span class="nav-text">输入</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#get-one-char"><span class="nav-text">get one char</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%A2%E9%97%AEY-N"><span class="nav-text">询问Y&#x2F;N</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%87%8D%E5%AE%9A%E5%90%91"><span class="nav-text">重定向</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BE%93%E5%85%A5%E9%87%8D%E5%AE%9A%E5%90%91"><span class="nav-text">输入重定向</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8E"><span class="nav-text">&lt; 与 &lt;&lt;&lt;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%88%B0%E5%8F%98%E9%87%8F"><span class="nav-text">读取文件到变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E8%A1%8C%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-text">&lt;&lt; 多行字符串</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BE%93%E5%87%BA%E9%87%8D%E5%AE%9A%E5%90%91"><span class="nav-text">输出重定向</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8E-_2"><span class="nav-text">&gt; 与 &gt;&gt;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#tee-%E6%8E%A8%E8%8D%90"><span class="nav-text">tee [推荐]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#dd"><span class="nav-text">dd</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%82%E6%95%B0%E4%BC%A0%E8%BE%93"><span class="nav-text">参数传输</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#xargs%E5%91%BD%E4%BB%A4"><span class="nav-text">xargs命令</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%90%8E%E5%8F%B0%E8%BF%90%E8%A1%8C"><span class="nav-text">后台运行</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E5%8F%B0%E8%BF%90%E8%A1%8C-%E9%87%8D%E5%AE%9A%E5%90%91%E8%BE%93%E5%87%BA"><span class="nav-text">前台运行+重定向输出</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%8E%E5%8F%B0%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9D%9F%E6%8F%92%E6%92%AD%E7%9F%AD%E4%BF%A1"><span class="nav-text">后台运行结束插播短信</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%8E%E5%8F%B0%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9D%9F%E4%B8%8D%E6%8F%92%E6%92%AD%E7%9F%AD%E4%BF%A1-%E8%BE%93%E5%87%BA%E9%87%8D%E5%AE%9A%E5%90%91"><span class="nav-text">后台运行结束不插播短信+输出重定向</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%8E%E5%8F%B0%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9D%9F%E6%8F%92%E6%92%AD%E7%9F%AD%E4%BF%A1-%E8%BE%93%E5%87%BA%E9%87%8D%E5%AE%9A%E5%90%91"><span class="nav-text">后台运行结束插播短信+输出重定向</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%9A%E8%BF%9B%E7%A8%8B%E5%90%8E%E5%8F%B0%E8%BF%90%E8%A1%8C-%E8%BF%90%E8%A1%8C%E5%AE%8C%E9%9B%86%E4%B8%AD%E8%BE%93%E5%87%BA"><span class="nav-text">多进程后台运行+运行完集中输出</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97"><span class="nav-text">数学运算</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-text">字符串</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%95%BF%E5%BA%A6"><span class="nav-text">字符串长度</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%95%BF%E5%BA%A6-%E5%90%AB%E9%A2%9C%E8%89%B2%E6%8E%A7%E5%88%B6%E7%AC%A6"><span class="nav-text">字符串长度 (含颜色控制符)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%95%BF%E5%BA%A6-%E5%8E%BB%E9%99%A4%E9%A2%9C%E8%89%B2%E6%8E%A7%E5%88%B6%E7%AC%A6"><span class="nav-text">字符串长度 (去除颜色控制符)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8F%96%E5%AD%90%E4%B8%B2"><span class="nav-text">字符串取子串</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#string-%E5%A7%8B-%E9%95%BF-%E4%BB%8E0%E5%BC%80%E5%A7%8B-bash-zsh-%E6%94%AF%E6%8C%81-string-%E5%A7%8B-0-%E6%AD%A2-0-%E4%BB%85zsh%E6%94%AF%E6%8C%81"><span class="nav-text">{string:始:长} (从0开始) bash&#x2F;zsh 支持, {string:始&gt;&#x3D;0:止&lt;0}  仅zsh支持</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#string-%E5%A7%8B-%E6%AD%A2-%E4%BB%8E1%E5%BC%80%E5%A7%8B-%E4%BB%85-zsh-%E6%94%AF%E6%8C%81"><span class="nav-text">$string[始,止] (从1开始) 仅 zsh 支持</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%81%8D%E5%8E%86%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-text">遍历字符串</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5"><span class="nav-text">字符串拼接</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E6%95%B0%E7%BB%84"><span class="nav-text">字符串转数组</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#12312%E5%90%8E%E6%9C%893%E4%B8%AA%E7%A9%BA%E6%A0%BC"><span class="nav-text">(12312后有3个空格)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8sed%E6%9B%BF%E6%8D%A2"><span class="nav-text">用sed替换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8perl%E6%9B%BF%E6%8D%A2"><span class="nav-text">用perl替换</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%96%E7%AC%AC%E5%87%A0%E8%A1%8C"><span class="nav-text">取第几行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%88%AA%E5%8F%96"><span class="nav-text">截取</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%AD%E6%B3%95"><span class="nav-text">语法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8%E6%B3%95"><span class="nav-text">用法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B0%83%E7%94%A8"><span class="nav-text">调用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#bash"><span class="nav-text">bash</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#zsh"><span class="nav-text">zsh</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BE%93%E5%87%BA-_3"><span class="nav-text">输出</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BE%93%E5%85%A5-_2"><span class="nav-text">输入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BD%AC%E4%B9%89-_2"><span class="nav-text">转义</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E7%BB%84"><span class="nav-text">数组</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%98%BE%E7%A4%BA%E6%95%B0%E7%BB%84"><span class="nav-text">显示数组</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E7%BB%84%E5%8F%96%E5%85%83%E7%B4%A0"><span class="nav-text">数组取元素</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#array-%E5%A7%8B-%E9%95%BF-%E4%BB%8E0%E5%BC%80%E5%A7%8B-sh-bash-zsh%E5%85%B1%E4%BA%AB"><span class="nav-text">${array[@]:始:长} (从0开始)  sh&#x2F;bash&#x2F;zsh共享</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0-%E4%BB%8E1%E5%BC%80%E5%A7%8B-sh-bash-zsh%E5%85%B1%E4%BA%AB"><span class="nav-text">$数 (从1开始)   sh&#x2F;bash&#x2F;zsh共享</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#array-%E6%95%B0-%E2%80%9D-bash%E4%BB%8E0%E5%BC%80%E5%A7%8B-zsh%E4%BB%8E1%E5%BC%80%E5%A7%8B"><span class="nav-text">&quot;${array[数]}” (bash从0开始, zsh从1开始)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#array-%E5%A7%8B-%E6%AD%A2-%E4%BB%8E1%E5%BC%80%E5%A7%8B-%E4%BB%85zsh%E6%94%AF%E6%8C%81"><span class="nav-text">${array[始,止]} (从1开始)  仅zsh支持</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E7%BB%84%E9%95%BF%E5%BA%A6"><span class="nav-text">数组长度</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E6%98%AF%E6%95%B0%E7%BB%84"><span class="nav-text">判断是否是数组</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E7%BB%84%E8%B5%8B%E5%80%BC%E4%B8%8E%E6%8B%BC%E6%8E%A5"><span class="nav-text">数组赋值与拼接</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%9F%E6%88%90range"><span class="nav-text">生成range</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E7%BB%84range"><span class="nav-text">一组range</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E7%BB%84range%E6%8B%BC%E6%8E%A5%E8%B5%B7%E6%9D%A5"><span class="nav-text">多组range拼接起来</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%8E%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BD%E6%95%B0%E7%BB%84"><span class="nav-text">从文件加载数组</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%81%8D%E5%8E%86%E6%95%B0%E7%BB%84"><span class="nav-text">遍历数组</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%81%8D%E5%8E%86%E5%85%83%E7%B4%A0"><span class="nav-text">遍历元素</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%81%8D%E5%8E%86%E7%BC%96%E5%8F%B7"><span class="nav-text">遍历编号</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E8%BF%94%E5%9B%9E%E6%95%B0%E7%BB%84"><span class="nav-text">命令返回数组</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%95%E4%B8%80-for-%E5%91%BD%E4%BB%A4-%E6%88%96-%E5%91%BD%E4%BB%A4"><span class="nav-text">法一 for + $(命令) 或 &#96;命令&#96;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%95%E4%BA%8C-%E7%94%A8declare-p-array%E4%BD%9C%E4%B8%BA%E8%A1%A8%E7%A4%BA"><span class="nav-text">法二 用declare -p array作为表示</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%95%E4%B8%89-%E4%BF%AE%E6%94%B9%E5%88%86%E9%9A%94%E7%AC%A6"><span class="nav-text">法三 修改分隔符</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%95%E7%94%A8%E4%BC%A0%E5%8F%82%E2%80%94%E2%80%94%E5%9C%A8%E5%87%BD%E6%95%B0%E4%B8%AD%E4%BF%AE%E6%94%B9%E5%8F%82%E6%95%B0"><span class="nav-text">引用传参——在函数中修改参数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%90%E8%A1%8C%E6%95%B0%E7%BB%84"><span class="nav-text">运行数组</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%94%99%E8%AF%AF%E7%9A%84%E5%81%9A%E6%B3%95"><span class="nav-text">错误的做法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A3%E7%A1%AE%E7%9A%84%E5%81%9A%E6%B3%95"><span class="nav-text">正确的做法</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%BE%93%E5%87%BA%E8%A1%A8%E6%A0%BC"><span class="nav-text">输出表格</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#column-%E5%91%BD%E4%BB%A4"><span class="nav-text">column 命令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sudo%E6%89%A7%E8%A1%8C"><span class="nav-text">sudo执行</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#sudo%E6%89%A7%E8%A1%8C%E9%9D%9Esudo%E7%9A%84%E5%87%BD%E6%95%B0"><span class="nav-text">sudo执行非sudo的函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sudo%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%AE%B5"><span class="nav-text">sudo执行代码段</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sudo%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6"><span class="nav-text">sudo执行文件</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="∞亼"
      src="/images/heat.jpg">
  <p class="site-author-name" itemprop="name">∞亼</p>
  <div class="site-description" itemprop="description">一切节约归根到底是时间的节约</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">82</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/hyliang96" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hyliang96" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hyliang96@gmail.com" title="E-Mail → mailto:hyliang96@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

  <a href="https://github.com/hyliang96" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hyliang96.github.io/posts/Infinity/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/heat.jpg">
      <meta itemprop="name" content="∞亼">
      <meta itemprop="description" content="一切节约归根到底是时间的节约">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="丹炉志">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          bash及zsh语法
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-05-25 04:03:03" itemprop="dateCreated datePublished" datetime="2019-05-25T04:03:03+08:00">2019-05-25</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2024-10-14 23:51:27" itemprop="dateModified" datetime="2024-10-14T23:51:27+08:00">2024-10-14</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%99%A8/" itemprop="url" rel="index"><span itemprop="name">器</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%99%A8/shell/" itemprop="url" rel="index"><span itemprop="name">shell</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/posts/Infinity/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/posts/Infinity/" data-xid="/posts/Infinity/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>33k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1:49</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="执行命令或文件"><a class="header-anchor" href="#执行命令或文件"></a>执行命令或文件</h1>
<p>以下对zsh与bash同时成立</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/solaraceboy/article/details/79131772">参考</a></p>
<p>下述<code>文件</code>为shell语言的脚本，常见为<code>.sh</code>文件或<code>.bash_xxxx</code>类文件</p>
<h3 id="在当前shell执行"><a class="header-anchor" href="#在当前shell执行"></a>在当前shell执行</h3>
<ul>
<li>使用当前shell的变量/函数/当前路径, , 不论是否export</li>
<li>创、变、删的 变量/函数/当前路,  不论是否export,  都会保存在当前shell里面</li>
</ul>
<p><code>source 文件 </code>（等价于 <code>. 文件 </code>）</p>
<ul>
<li>文件不必有可执行权限</li>
</ul>
<p><code>命令</code> , <code>&#123; 命令块;&#125;</code> , 循环体/条件体</p>
<ul>
<li><code>&#123;</code>后要有空格, <code>&#125;</code>前要有<code>;</code>(但无需空格), 才能在bash运行, 不然只能zsh下运行</li>
<li><code>&#123; 命令块;&#125;</code> , 循环体/条件体, 即相当于运行了匿名函数</li>
<li><code>&#123; 命令块;&#125;</code> 与<code>命令块</code>产生相同的标准输出和标准错误</li>
</ul>
<h3 id="开新shell执行"><a class="header-anchor" href="#开新shell执行"></a>开新shell执行</h3>
<p><code>./文件 </code>或 <code>&lt;某种SHELL&gt; 文件</code></p>
<ul>
<li>
<p>开新shell运行, 会加载执行的shell 的 profile 文件 (例如<code>.profile</code>, <code>.zshenv</code>)</p>
</li>
<li>
<p>继承全局变量(即export了的变量):</p>
<ul>
<li>新shell继承 (即copy) 当前shell中 export 了的变量, 不继承当前shell中未export的变量</li>
<li>新shell新建/改变 的 变量/函数/当前路径, 不论新shell是否export它们, 在新shell结束后注销, 不会被带回当前shell</li>
<li>新shell结束后, 当前shell的变量均无变化</li>
</ul>
</li>
<li>
<p>执行的shell:</p>
<ul>
<li><code>&lt;某种SHELL&gt; 文件</code>, 包括<code>sh 文件</code> , 文件不必有可执行权限</li>
<li><code>./文件 </code>等价于<code>sh 文件</code>，但要求文件有可执行（<code>x</code>）权限，授权方式<code>chmod +x 文件</code>）</li>
</ul>
</li>
<li>
<p>shell的区别</p>
<ul>
<li>sh: 全称 POSIX shell, <code>./文件 </code> 所使用的shell, 所有 unix  系统共有
<ul>
<li>POSIX: 可移植操作系统接口Portable Operating System Interface of UNIX</li>
</ul>
</li>
<li>bash:  全称 Bourne Shell, 增强版的sh, 更常用,  大多数Linux发行版默认的交互shell</li>
<li>zsh: 全称 z shell, 类似bash的shell, 改善交互体验</li>
</ul>
</li>
<li>
<p><code>$SHELL 文件</code>：用当前默认的交互shell（可能是zsh或bash等）执行，文件不必有可执行权限</p>
<ul>
<li><code>$SHELL</code> 是当前默认的交互shell</li>
<li><code>$SHELL -c '命令'</code>：用当当前默认的交互shell执行</li>
<li><code>chsh -s $(which &lt;shell名&gt;)</code> : 修改默认的交互shell</li>
</ul>
</li>
</ul>
<h3 id="开子shell执行"><a class="header-anchor" href="#开子shell执行"></a>开子shell执行</h3>
<ul>
<li>不是另启一个新shell，故不会加载执行的shell 的 profile 文件 (例如<code>.profile</code>, <code>.zshenv</code>)</li>
<li>开子shell, 与当前shell是同一个shell类型 (即, 是sh,bash, 还是zsh)</li>
<li>继承父shell的所有变量, 不论是否export</li>
<li>子shell新建的、改变的 变量/函数/当前路径 不会被带回父shell，不论是否使用export, 在子shell结束后注销, 子shell结束后父shell的变量均无变化</li>
</ul>
<p><code>value=`命令`</code>，等价于 <code>value=$(命令)</code></p>
<ul>
<li>输出返回到value，value为一个字符串，可以有换行符；value不是数组</li>
</ul>
<p><code>(命令块)</code></p>
<ul>
<li>与<code>命令块</code>产生相同的标准输出和标准错误</li>
<li><code>(</code> 后与<code>)</code>前无需空格, 有也能运行; <code>命令块</code> 后无需<code>;</code>, 有也能运行.</li>
</ul>
<p>例子</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">pwd</span>
<span class="token punctuation">(</span>cd <span class="token punctuation">..</span><span class="token punctuation">;</span> <span class="token builtin class-name">pwd</span><span class="token punctuation">)</span>
<span class="token builtin class-name">pwd</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>返回</p>
<blockquote>
  <pre class="line-numbers language-none"><code class="language-none">&#x2F;home&#x2F;you&#x2F;ENV&#x2F;CONF
&#x2F;home&#x2F;you&#x2F;ENV
&#x2F;home&#x2F;you&#x2F;ENV&#x2F;CONF<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</blockquote>
<p>然而</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">pwd</span>
<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span><span class="token punctuation">;</span> <span class="token builtin class-name">pwd</span>
<span class="token builtin class-name">pwd</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>返回</p>
<blockquote>
  <pre class="line-numbers language-none"><code class="language-none">&#x2F;home&#x2F;haoyu&#x2F;ENV&#x2F;CONF
&#x2F;home&#x2F;haoyu&#x2F;ENV
&#x2F;home&#x2F;haoyu&#x2F;ENV<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h3 id="管道-命令1-命令2"><a class="header-anchor" href="#管道-命令1-命令2"></a>管道 <code>命令1 | 命令2</code></h3>
<ul>
<li><code>命令1</code> (非管道结尾的命令), 均是在当前shell分别开子shell, <code>命令1</code>  的修改/创建的变量(不论是否export), 不会留给 <code>命令2</code> 与 后续的父shell</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">a</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>   <span class="token assign-left variable">a</span><span class="token operator">=</span><span class="token number">2</span> <span class="token operator">|</span> <span class="token builtin class-name">echo</span> <span class="token variable">$a</span> <span class="token punctuation">;</span>   <span class="token builtin class-name">echo</span> <span class="token variable">$a</span>
<span class="token assign-left variable">a</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>   <span class="token builtin class-name">export</span> <span class="token assign-left variable">a</span><span class="token operator">=</span><span class="token number">2</span> <span class="token operator">|</span> <span class="token builtin class-name">echo</span> <span class="token variable">$a</span> <span class="token punctuation">;</span>   <span class="token builtin class-name">echo</span> <span class="token variable">$a</span>
<span class="token comment"># bash 和 zsh 下均输出</span>
<span class="token comment"># 1</span>
<span class="token comment"># 1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><code>命令2</code> (管道结尾的命令) 在zsh下是 <a href="#%E5%9C%A8%E5%BD%93%E5%89%8Dshell%E6%89%A7%E8%A1%8C">在当前shell执行</a>, 改/创建的变量(不论是否export), 会留给后续的父shell</li>
<li><code>命令2</code> (管道结尾的命令) 在bash下是 开子shell执行, 改/创建的变量(不论是否export), 不会留给后续的父shell</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"> <span class="token assign-left variable">a</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">b</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">c</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token assign-left variable">a</span><span class="token operator">=</span><span class="token number">2</span> <span class="token operator">|</span> <span class="token assign-left variable">b</span><span class="token operator">=</span><span class="token number">2</span> <span class="token operator">|</span> <span class="token assign-left variable">c</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span> <span class="token builtin class-name">echo</span> <span class="token variable">$a</span> <span class="token variable">$b</span> <span class="token variable">$c</span>
<span class="token comment"># zsh下输出 1 1 2</span>
<span class="token comment"># bash下输出 1 1 1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="管道与循环体-管道组合"><a class="header-anchor" href="#管道与循环体-管道组合"></a>管道与循环体/管道组合</h3>
<ul>
<li>
<p><code>命令|循环体</code>, 在bash中循环体是<strong>子shell</strong>执行; 在zsh中循环体是当前shell执行</p>
</li>
<li>
<p>循环体与重定向 ( <code>&lt;&lt;&lt;</code> <code>&lt;&lt;</code>  <code>&lt;</code> <code>&lt; &lt;(...)</code>  )组合起来, 则循环体在bash和shell中均是用当前shell执行</p>
</li>
<li>
<p>故而, 如需修改<strong>此代码块外的变量</strong> (例如给一个array加成员, 给计数器加值), 建议能用重定向, 就用重定向写, 以便zsh和bash兼容.</p>
<p>即, 要写成</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">循环或条件体 <span class="token operator">&lt;&lt;&lt;</span> <span class="token string">"<span class="token variable">$&#123;string&#125;</span>"</span>
循环或条件体 <span class="token operator">&lt;</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span> 命令块 <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>而不要</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> -E <span class="token string">"<span class="token variable">$&#123;string&#125;</span>"</span> <span class="token operator">|</span> 循环或条件体
<span class="token punctuation">(</span> 命令块 <span class="token punctuation">)</span> <span class="token operator">|</span> 循环或条件体
<span class="token punctuation">&#123;</span> 命令块<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token operator">|</span> 循环或条件<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>例如</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span> <span class="token builtin class-name">read</span> -r line<span class="token punctuation">;</span> <span class="token keyword">do</span> <span class="token assign-left variable">array</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token string">"<span class="token variable">$&#123;line&#125;</span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">done</span> <span class="token operator">&lt;&lt;&lt;</span> <span class="token punctuation">\</span>
<span class="token string">'asda'</span><span class="token string">$'<span class="token entity" title="\n">\n</span>'</span>'adasadasd<span class="token string">'$'</span><span class="token punctuation">\</span>n<span class="token string">''</span>asdasdasdassd<span class="token string">'
declare -p array
# bash 输出
# declare -a array='</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"asda"</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"adasadasd"</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"asdasdasdassd"</span><span class="token punctuation">)</span>'
<span class="token comment"># zsh 输出</span>
<span class="token comment"># typeset -a array=( asda adasadasd asdasdasdassd )</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin class-name">echo</span> -E <span class="token string">'asda'</span><span class="token string">$'<span class="token entity" title="\n">\n</span>'</span>'adasadasd<span class="token string">'$'</span><span class="token punctuation">\</span>n<span class="token string">''</span>asdasdasdassd<span class="token string">' | \
while IFS= read -r line; do array+=("$&#123;line&#125;"); done
declare -p array
# bash 输出
# declare -a array='</span><span class="token punctuation">(</span><span class="token punctuation">)</span>'
<span class="token comment"># zsh 输出</span>
<span class="token comment"># typeset -a array=( asda adasadasd asdasdasdassd )</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h1 id="代码块的性质"><a class="header-anchor" href="#代码块的性质"></a>代码块的性质</h1>
<h3 id="代码块的组合命令"><a class="header-anchor" href="#代码块的组合命令"></a>代码块的组合命令</h3>
<p>不论哪种代码, 均有以下性质</p>
<ul>
<li><code>帽 代码块 靴 | 命令</code> : 表示对整个代码块的输出 经过管道 送给<code>命令</code></li>
<li><code>帽 代码块 靴 &gt;文件</code> :  表示对整个代码块的输出 写入到<code>文件</code>. <code>&gt;&gt;</code>同理</li>
</ul>
<h3 id="循环体"><a class="header-anchor" href="#循环体"></a>循环体</h3>
<ul>
<li><code>for/while xxx do; 代码块; done 管道或写入文件</code>  是对所有轮的输出 整体执行一次.</li>
<li><code>for/while xxx do; &#123; 代码块; &#125; 管道或写入文件; done</code> 是每轮循环输出 执行一次管道/文件写入</li>
</ul>
<p>例如</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">..</span><span class="token number">3</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">$i</span>
<span class="token keyword">done</span> <span class="token operator">|</span> <span class="token function">sort</span> -r <span class="token comment"># 降序</span>

<span class="token comment"># 结果为</span>
<span class="token comment"># 3</span>
<span class="token comment"># 2</span>
<span class="token comment"># 1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="条件体"><a class="header-anchor" href="#条件体"></a>条件体</h3>
<p><code>if ... if 管道或写入文件</code> 不论对于哪个条件分支, 或不满足任何分支条件的情况, 均会执行</p>
<p>例如</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">rm</span> result
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token number">1</span> -ne <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">'1 -ne 1'</span>
    <span class="token builtin class-name">echo</span> <span class="token string">'1 != 1'</span>
<span class="token keyword">fi</span> <span class="token operator">></span> result
<span class="token comment"># 结果为 创建了一个空的 result 文件</span>

<span class="token function">rm</span> result
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token number">1</span> -ne <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
<span class="token punctuation">&#123;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">'1 -ne 1'</span>
    <span class="token builtin class-name">echo</span> <span class="token string">'1 != 1'</span>
<span class="token punctuation">&#125;</span> <span class="token operator">></span> result
<span class="token keyword">fi</span>
<span class="token comment"># 结果为 没有创建result文件</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="获得命令输出"><a class="header-anchor" href="#获得命令输出"></a>获得命令输出</h1>
<h2 id="输出返回为匿名字符串"><a class="header-anchor" href="#输出返回为匿名字符串"></a><code>$(...)</code> <code>`....`</code>输出返回为匿名字符串</h2>
<p>以下对zsh与bash同时成立</p>
<h3 id="子shell执行"><a class="header-anchor" href="#子shell执行"></a>子shell执行</h3>
<ul>
<li><code>`xx`</code>   完全等价于  <code>$(xx)</code>：用<strong>当前shell开子shell</strong>执行<code>xx</code>命令，将其返回为无名变量。例如</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">`</span><span class="token function">ls</span><span class="token variable">`</span></span>
<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">ls</span><span class="token variable">)</span></span>
<span class="token assign-left variable">result</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">ls</span><span class="token variable">`</span></span>
<span class="token assign-left variable">result</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ls</span><span class="token variable">)</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><code>`bash -c &quot;xx&quot;`</code>   完全等价于  <code>$(bash -c &quot;xx&quot;)</code>：用<strong>bash</strong>执行<code>xx</code>命令，将其返回为无名变量</li>
</ul>
<h3 id="输出"><a class="header-anchor" href="#输出"></a>输出</h3>
<p><code>`xx`</code>   完全等价于  <code>$(xx)</code>只获得<code>xx</code>命令的正常输出(<code>&gt;&amp;1</code>)，不获得</p>
<ul>
<li><code>xx</code>的报错报警输出(<code>&gt;&amp;2</code>)仍然打印在屏幕</li>
<li>若想<code>xx</code>重定向到文件的输出, 则写<code>&gt;文件</code></li>
</ul>
<p>例如：</p>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function-name function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token builtin class-name">echo</span> <span class="token string">'file'</span> <span class="token operator">></span> /dev/null <span class="token comment"># 报错报警</span>
    <span class="token builtin class-name">echo</span> <span class="token string">'warring'</span> <span class="token operator">></span><span class="token file-descriptor important">&amp;2</span> <span class="token comment"># 报错报警</span>
    <span class="token builtin class-name">echo</span> <span class="token string">'normal'</span> <span class="token operator">></span><span class="token file-descriptor important">&amp;1</span> <span class="token comment"># 正常输报警</span>
    <span class="token builtin class-name">echo</span> <span class="token string">'normal'</span> <span class="token comment"># 默认是正常输报警</span>
<span class="token punctuation">&#125;</span>
<span class="token assign-left variable">return_string</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>f<span class="token variable">)</span></span>
<span class="token comment"># 输出如下</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>warring</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token variable">$return_string</span>
<span class="token comment"># 输出如下</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<blockquote>
<p>normal<br>
normal</p>
</blockquote>
<h2 id="输出返回为匿名文件"><a class="header-anchor" href="#输出返回为匿名文件"></a><code>&lt;(...)</code>输出返回为匿名文件</h2>
<p>以下对zsh与bash同时成立</p>
<p><code>&lt;(命令)</code>, 将命令的输出返回为匿名文件.</p>
<p>注意:</p>
<ul>
<li>用<strong>当前shell开子shell</strong>执行<code>xx</code>命令</li>
<li>此文件只获得<code>xx</code>命令的正常输出(<code>&gt;&amp;1</code>), 报错报警输出(<code>&gt;&amp;2</code>)仍然打印在屏幕</li>
</ul>
<p>辨析:</p>
<ul>
<li><code>命令 &lt; &lt;(echo -E &quot;$&#123;string&#125;”)</code> 等价于 <code>命令 &lt;&lt;&lt; &quot;$&#123;string&#125;&quot;</code></li>
</ul>
<p>例如:</p>
<ul>
<li>
<p>比较两个目录的差异</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">diff</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token function">ls</span> dirA<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token function">ls</span> dirB<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p>逐行读取多行字符串</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">while</span> <span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span> <span class="token builtin class-name">read</span> -r line<span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$line</span>"</span>
<span class="token keyword">done</span> <span class="token operator">&lt;</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token builtin class-name">echo</span> -E <span class="token string">"<span class="token variable">$&#123;string&#125;</span>"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>等价于</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">while</span> <span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span> <span class="token builtin class-name">read</span> -r line<span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$line</span>"</span>
<span class="token keyword">done</span> <span class="token operator">&lt;&lt;&lt;</span> <span class="token string">"<span class="token variable">$&#123;string&#125;</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h1 id="各种引号"><a class="header-anchor" href="#各种引号"></a>各种引号</h1>
<p>以下对zsh和bash皆成立</p>
<h2 id="转义"><a class="header-anchor" href="#转义"></a>转义</h2>
<h3 id="创建字符串-各种引号"><a class="header-anchor" href="#创建字符串-各种引号"></a>创建字符串, 各种引号</h3>
<p>赋值给字符串时:</p>
<ul>
<li>
<p>单引号：所有都不转义</p>
</li>
<li>
<p><code>$'xxx'</code>: 仅<code>\某</code>转义</p>
</li>
<li>
<p>双引号, <code>&lt;&lt;EOF</code>, <code>&lt;&lt;-EOF</code> ：<code>$&#123;xxx&#125;</code>(变量)、<code>`xx`</code> <code>$()</code>(命令返回) 转义, 用 <code>\$</code> <code>\`xxx\`</code>取消转义;  <code>\某</code> 不转义</p>
</li>
</ul>
<h3 id="输出-_2"><a class="header-anchor" href="#输出-_2"></a>输出</h3>
<p>从被输出的字符串, 到输出的字符串, 这个过程中:</p>
<ul>
<li>
<p><code>echo -E 字符串</code>: 输出  <code>\某</code> 不转义</p>
</li>
<li>
<p><code>echo [-e] 字符串</code>: 输出 <code>\某</code> 转义, <code>-e</code>即默认选项 可省去</p>
</li>
</ul>
<h2 id="双引号的优先级"><a class="header-anchor" href="#双引号的优先级"></a>双引号的优先级</h2>
<ul>
<li>
<p><code>”$(...&quot;...$&#123;variable&#125;...&quot;....)”</code>  及 <code>”`...&quot;...$&#123;variable&#125;...&quot;....`”</code>  均表示: 含有将variable变量的字符串<code>&quot;...$&#123;variable&#125;…”</code> , 用于某个子shell命令<code>...&quot;...$&#123;variable&#125;...&quot;....</code>, 其结果返回为一个字符串. 最外围的双引号不会跨过  <code>$(…)</code> 或 <code>`…`</code> 的边界与其内部的双引号成对解析. 例如</p>
</li>
<li>
<pre><code class="language-bash">  echo &quot;$([ &quot;$&#123;USER&#125;&quot; = &quot;$&#123;USER&#125;&quot; ] &amp;&amp; echo yes)&quot;
  # 返回 yes
  <pre class="line-numbers language-none"><code class="language-none">
*   &#96;”$((...&quot;...$&#123;variable&#125;...&quot;....))”&#96;  会被解析成 &#96;”$((...”&#96; 字符串, &#96;....&#96; , &#96;$&#123;variable&#125;&#96; 变量, &#96;...&#96;, &#96; &quot;....))”&#96; 字符串的concat. 例如

    &#96;&#96;&#96;bash
    a&#x3D;1; b&#x3D;2
    echo &quot;$((&quot;$a&quot; + &quot;$b&quot;))&quot;
    # 返回
    # zsh: bad math expression: illegal character: &quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

</code></pre>
</li>
</ul>
<h1 id="局部变量"><a class="header-anchor" href="#局部变量"></a>局部变量</h1>
<ul>
<li>仅函数内可见的变量，只需首次用时写<code>local</code>，之后不用再写了。但不可用于非函数内 (如脚本中 不在函数里之处), 例如</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function-name function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin class-name">local</span> <span class="token assign-left variable">variable</span><span class="token operator">=</span>xxx
    <span class="token assign-left variable">variable</span><span class="token operator">=</span>yyy <span class="token comment"># 再次使用，无需声明local</span>

    <span class="token builtin class-name">local</span> <span class="token assign-left variable">i</span><span class="token operator">=</span>
    <span class="token comment"># 不可写作 local i; 不然若之前已经创建了local i, 则此处会输出 "i=xxxx"</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token string">"<span class="token variable">$@</span>"</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token comment"># 不可写作 for local i in "$@"; do</span>
        <span class="token comment"># xxxx</span>
    <span class="token keyword">done</span>
<span class="token punctuation">&#125;</span>

f
<span class="token builtin class-name">echo</span> <span class="token variable">$&#123;varible&#125;</span> <span class="token comment"># 返回为空，因为在全局变量中，没有名为variable的变量</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><code>local variable=</code> : local variable赋值为<code>’’</code>, 用于</li>
<li><code>local variable</code> : 若无local variable, 则创建此variable; 若有local variable, 则显示&quot;vairable=xxxx&quot;.</li>
<li><code>bash/zsh/sh 文件.sh</code>及其<code>./文件.sh</code>运行脚本，脚本中所创、改、删的变量/函数不会带到运行它环境中（除非<code>export</code>），无需手动释放创建的变量/函数</li>
<li><code>source 文件.sh</code>(即<code>. 文件.sh</code>)，脚本中所创、改、删的变量/函数会带到运行它环境中(不论是否<code>export</code>)，故需手动释放创建的变量/函数</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">unset</span> -f 函数名
<span class="token builtin class-name">unset</span> -v 变量名 <span class="token comment"># -v 可缺省</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h1 id="判断"><a class="header-anchor" href="#判断"></a>判断</h1>
<p>以下适用于<code>bash</code>和<code>zsh</code></p>
<h2 id="概述"><a class="header-anchor" href="#概述"></a>概述</h2>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">if</span> <span class="token punctuation">(</span> 判断语句 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    do_something
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span> 判断语句 <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    do_something
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> 判断语句 <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    do_something
<span class="token keyword">fi</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>或</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">                              <span class="token comment"># 否定条件则写作：</span>
<span class="token punctuation">(</span> 判断语句 <span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> do_something   <span class="token comment"># ! ( 判断语句 )  &amp;&amp; do_something   也即   ( ! 判断语句 )  &amp;&amp; do_something</span>
也即 判断语句 <span class="token operator">&amp;&amp;</span> do_something   <span class="token comment"># 也即 ! 判断语句 &amp;&amp; do_something</span>

<span class="token punctuation">[</span> 判断语句 <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> do_something   <span class="token comment"># ! [ 判断语句 ]  &amp;&amp; do_something</span>

<span class="token punctuation">[</span><span class="token punctuation">[</span> 判断语句<span class="token punctuation">]</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> do_something <span class="token comment"># ! [[ 判断语句 ]]  &amp;&amp; do_something</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="判断语句"><a class="header-anchor" href="#判断语句"></a>判断语句</h2>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/ithomer/article/details/6836382?utm_source=copy">参考</a></p>
<table>
<thead>
<tr>
<th><code>( 判断语句 )</code>  也即  <code>判断语句</code></th>
<th>含义</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>command -v 命令 &gt; /dev/null</code></td>
<td>判断命令知否存在(命令可以使alias以及自定义的shell函数)</td>
<td><code>if command -v pwd &gt; /dev/null; then</code> 也即 <code>if ( command -v pwd &gt; /dev/null ); then</code></td>
</tr>
<tr>
<td>注：<code>[ command 命令 2&gt;&amp;1 | grep 'command not found']</code></td>
<td>辨析：判断命令知否存在(命令为系统原生命令，不包含可以使alias以及自定义的shell函数)</td>
<td><code>[ command ls 2&gt;&amp;1 | grep 'command not found']</code></td>
</tr>
<tr>
<td><code>[ $? -eq 0 ]</code></td>
<td><code>$?</code>表示前面所有代码里是报错的编码是啥, 为0&lt;=&gt;无错误</td>
<td>[ $? -ne 0 ] &amp;&amp;  echo Error</td>
</tr>
<tr>
<td><strong><code>[ 判断语句 ]</code></strong> (也可用<code>[[ ]]</code>)</td>
<td><strong>含义</strong></td>
<td><strong>示例</strong></td>
</tr>
<tr>
<td><strong>文件比较</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>-e file</td>
<td>存在文件或文件夹，或存在一个<strong>有效</strong>（最终（可以符号逻辑递归）指到文件或文件夹）的符号链接</td>
<td>[ -e /var/log/syslog ]</td>
</tr>
<tr>
<td>-d file</td>
<td>存在且为目录</td>
<td>[ -d /tmp/mydir ]</td>
</tr>
<tr>
<td>-f file</td>
<td>存在且为常规文件</td>
<td>[ -f /usr/bin/grep ]</td>
</tr>
<tr>
<td>-L file</td>
<td>为符号链接，不论是否<strong>有效</strong></td>
<td>[ -L /usr/bin/grep ]</td>
</tr>
<tr>
<td>-r file</td>
<td>存在且当前用户可读</td>
<td>[ -r /var/log/syslog ]</td>
</tr>
<tr>
<td>-w file</td>
<td>存在且当前用户可写</td>
<td>[ -w /var/mytmp.txt ]</td>
</tr>
<tr>
<td>-x file</td>
<td>存在且当前用户可执行</td>
<td>[ -L /usr/bin/grep ]</td>
</tr>
<tr>
<td>-c file</td>
<td>存在且为字符特殊文件</td>
<td></td>
</tr>
<tr>
<td>-b file</td>
<td>存在且为块特殊文件</td>
<td></td>
</tr>
<tr>
<td>-s file</td>
<td>存在且文件大小非0，即文件存在且非空</td>
<td></td>
</tr>
<tr>
<td>-t file</td>
<td>文件描述符(默认为1)指定的设备为终端</td>
<td>[ -t 1 ] 表示当前命令会显示在屏幕，即当前处在交互终端下</td>
</tr>
<tr>
<td>file1 -nt file2</td>
<td>file1 比 file2 新</td>
<td>[ /tmp/install/etc/services -nt /etc/services ]</td>
</tr>
<tr>
<td>file1 -ot file2</td>
<td>file1 比 file2 旧</td>
<td>[ /boot/bzImage -ot arch/i386/boot/bzImage ]</td>
</tr>
<tr>
<td><strong>字符串比较</strong></td>
<td></td>
<td>要用引号</td>
</tr>
<tr>
<td>-z string</td>
<td>长度为零，即串空</td>
<td>[ -z “$myvar” ]</td>
</tr>
<tr>
<td>-n string</td>
<td>长度非零，即串非空</td>
<td>[ -n “$myvar” ]</td>
</tr>
<tr>
<td><code>-z $&#123;var+x&#125;</code></td>
<td>变量var是否有定义（<code>$var=''</code>即var无定义）</td>
<td>[ -z “${myvar+x}&quot; ]</td>
</tr>
<tr>
<td>string</td>
<td>与上等价</td>
<td>[ “$myvar” ]</td>
</tr>
<tr>
<td>string1 = string2</td>
<td>string1 与 string2 相同</td>
<td>[ “$myvar” = “one two three” ]</td>
</tr>
<tr>
<td>string1 != string2</td>
<td>string1 与 string2 不同</td>
<td>[ “$myvar” != “one two three” ]</td>
</tr>
<tr>
<td><strong>布尔值</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>&quot;$mybool&quot; = true</code></td>
<td>是否真</td>
<td><code>[ &quot;$mybool&quot; = true ]</code></td>
</tr>
<tr>
<td><code>&quot;$mybool&quot; = false</code></td>
<td>是否假</td>
<td><code>[ &quot;$mybool&quot; = false ]</code></td>
</tr>
<tr>
<td><code>&quot;$myboo1l&quot; = &quot;$mybool2&quot;</code></td>
<td>是否同</td>
<td><code>[ &quot;$myboo1l&quot; = &quot;$mybool2&quot; ]</code></td>
</tr>
<tr>
<td><code>&quot;$myboo1l&quot; != &quot;$mybool2&quot;</code></td>
<td>是否异</td>
<td><code>&quot;$myboo1l&quot; != &quot;$mybool2&quot;</code></td>
</tr>
<tr>
<td><strong><code>[[ 判断语句 ]]</code></strong></td>
<td><strong>含义</strong></td>
<td><strong>示例</strong></td>
</tr>
<tr>
<td><strong>匹配</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>&quot;$string&quot; =~ &quot;$substring” </code>  及 <code>&quot;$string&quot; =~ 'xxxx' </code></td>
<td>bash中：string是否<strong>包含</strong>substring (普通字符串）； zsh中是：string是否匹配<strong>正则表达式</strong>，例如</td>
<td><code>[[ &quot;$string&quot; =~ &quot;$substring&quot; ]]</code> 及 <code>[[ &quot;$string&quot; =~ &quot;balabala&quot; ]]</code></td>
</tr>
<tr>
<td><code>&quot;$string&quot; =~ $正则表达式</code> 及 <code>&quot;$string&quot; =~ xxxx </code></td>
<td>在zsh和bash中：是否string包含**<code>正则表达式</code>**，例如</td>
<td><code>[[ &quot;$string&quot; =~ ^[0-9]+$ ]]</code></td>
</tr>
<tr>
<td><code>&quot;$string&quot; = $通配符</code> 及 <code>&quot;$string&quot; = xxxx</code></td>
<td>在zsh和bash中：string是否能匹配**<code>通配符</code>**，例如</td>
<td><code>[[ &quot;$path&quot; = */images/* ]]</code></td>
</tr>
<tr>
<td><strong>算术比较</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>num1 -eq num2</td>
<td>==</td>
<td>[[ 3 -eq $mynum ]]</td>
</tr>
<tr>
<td>num1 -ne num2</td>
<td>!=</td>
<td>[[ 3 -ne $mynum ]]</td>
</tr>
<tr>
<td>num1 -lt num2</td>
<td>&lt;</td>
<td>[[ 3 -lt $mynum ]]</td>
</tr>
<tr>
<td>num1 -le num2</td>
<td>&lt;=</td>
<td>[[ 3 -le $mynum ]]</td>
</tr>
<tr>
<td>num1 -gt num2</td>
<td>&gt;</td>
<td>[[ 3 -gt $mynum ]]</td>
</tr>
<tr>
<td>num1 -ge</td>
<td>&gt;=</td>
<td>[[ 3 -ge $mynum ]]</td>
</tr>
</tbody>
</table>
<p><strong>注意</strong></p>
<ul>
<li><strong>运算符前后要有空格至少一个</strong></li>
<li><strong><code>[、[[</code>后<code>]、]]</code>前要有空格至少一个</strong></li>
</ul>
<h2 id="其他特殊判断"><a class="header-anchor" href="#其他特殊判断"></a>其他特殊判断</h2>
<table>
<thead>
<tr>
<th>式子</th>
<th>含义</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[ &quot;$&#123;variable-no&#125;&quot; != no ]</code></td>
<td>变量<code>variable</code>有定义</td>
<td>若变量 <code>variable</code>无定义, 则<code>$&#123;variable-xxxx&#125;</code>返回“xxxx”<br><code>variable</code>有定义, 则返回<code>$&#123;variable&#125;</code></td>
</tr>
<tr>
<td></td>
<td></td>
<td><code>variable=</code>  : 等价于  <code>variable=‘’</code> , 故有定义<br><code>unset variable</code> : 注销variable, 故无定义</td>
</tr>
</tbody>
</table>
<h2 id="逻辑运算"><a class="header-anchor" href="#逻辑运算"></a>逻辑运算</h2>
<p>以下以<code>[ 判断语句 ]</code>为例，<code>[[ 判断语句 ]]</code>同理</p>
<table>
<thead>
<tr>
<th>逻辑运算</th>
<th>含义</th>
<th>例</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[ 判断语句 ] &amp;&amp; [ 判断语句 ]</code></td>
<td>与，次次优先</td>
<td></td>
</tr>
<tr>
<td><code>[ 判断语句 ] || [ 判断语句 ]</code></td>
<td>或，次次优先</td>
<td></td>
</tr>
<tr>
<td><code>! [ 判断语句 ]</code> 或 <code> [ ! 判断语句 ]</code></td>
<td>非，次优先</td>
<td>! 和 [ 中间必需有至少一个空格</td>
</tr>
<tr>
<td><code>( 上述三种运算 )</code></td>
<td>结合，最优先</td>
<td>if ! ( [ 判断1 ] ||  [ 判断2 ] )  &amp;&amp; [ 判断3 ]; then dosomething; fi</td>
</tr>
</tbody>
</table>
<h2 id="与-辨析"><a class="header-anchor" href="#与-辨析"></a><code>[[ ... ]]</code> 与 <code>[ ... ]</code> 辨析</h2>
<ul>
<li>linux的sh不支持<code>[[...]]</code></li>
<li>在zsh,bash,mac的sh, <s>linux的sh</s> 中:
<ul>
<li>凡是能用<code>[...]</code>的判断语句, 都能用 <code>[[...]]</code></li>
<li><code>[[...]]</code> 可以把 <code>&amp;&amp;</code>, <code>||</code> , <code>()</code>, <code>!</code> 写在里面:  例如<code>[[ 1 = 1 &amp;&amp; 2 =2 ]]</code>, <code>[[ ( ! 判断1 || 判断2 ) &amp;&amp; ( 判断3 )]]</code></li>
</ul>
</li>
<li>在linux与mac的sh/bash/zsh中, <code>[…]</code>, <code>[[...]]</code> . 它们都可以把 <s><code>&amp;&amp;</code></s> ,<s><code>||</code></s>, <s><code>()</code></s>, <code>!</code> 写在里面: 例如 <code>[ ! 1 = 2 ]</code>  <code>[[ ! 1 = 2 ]]</code></li>
</ul>
<h1 id="输入"><a class="header-anchor" href="#输入"></a>输入</h1>
<h2 id="get-one-char"><a class="header-anchor" href="#get-one-char"></a>get one char</h2>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">answer</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">bash</span> -c <span class="token string">"read  -n 1 -p '&lt;要显示的提示句> ? [Y|N]' c; echo \<span class="token variable">$c</span>"</span><span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token builtin class-name">echo</span>
<span class="token comment"># 调用bash执行read -n 1 -p '&lt;要显示的提示句> c', 即将提示句显示，等待输入字符，抓取即赋值给c</span>
<span class="token comment"># 将c返回到answer</span>
<span class="token comment"># echo：换行</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>适用于：zsh、bash、sh、<code>./文件</code>运行可执行文件、任何当前终端中</li>
<li>功能：等待输入，<strong>一旦输入一个字符</strong>（回车也算一个字符），<strong>立即结束等待</strong>，将这个字符返回给<code>answer</code>变量</li>
</ul>
<p>注：</p>
<ul>
<li>
<p>请不要使用</p>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> -n <span class="token string">'&lt;要显示的提示句> ? [Y|N]'</span>
<span class="token assign-left variable">answer</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">bash</span> -c <span class="token string">"read  -n 1 c; echo \<span class="token variable">$c</span>"</span><span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token builtin class-name">echo</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>因为使用sh、<code>./文件</code>运行可执行文件 的方法运行上述命令，echo不支持<code>-n</code>参数，会输出&quot;-n&quot;</p>
</li>
</ul>
<h2 id="询问Y-N"><a class="header-anchor" href="#询问Y-N"></a>询问Y/N</h2>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">while</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token comment"># echo - '提示？[Y/n]'</span>
    <span class="token assign-left variable">answer</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">bash</span> -c <span class="token string">"read  -n 1 -p '&lt;要显示的提示句>? [Y/N] ' c; echo \<span class="token variable">$c</span>"</span><span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token builtin class-name">echo</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$answer</span>"</span> <span class="token operator">=</span> <span class="token string">"y"</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$answer</span>"</span> <span class="token operator">=</span> <span class="token string">"Y"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token comment"># 回答是则如何操作</span>
        <span class="token builtin class-name">break</span>
    <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$answer</span>"</span> <span class="token operator">=</span> <span class="token string">"n"</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$answer</span>"</span> <span class="token operator">=</span> <span class="token string">"N"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token comment"># 回答否则如何操作</span>
        <span class="token builtin class-name">break</span>
    <span class="token keyword">else</span>
        <span class="token builtin class-name">echo</span> <span class="token string">'input Y/y or N/n please!'</span>
    <span class="token keyword">fi</span>
<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>例如</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;提示句&gt;? [Y|N]n
# 回答否的操作<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h1 id="重定向"><a class="header-anchor" href="#重定向"></a>重定向</h1>
<h2 id="输入重定向"><a class="header-anchor" href="#输入重定向"></a>输入重定向</h2>
<h3 id="与"><a class="header-anchor" href="#与"></a><code>&lt;</code> 与 <code>&lt;&lt;&lt;</code></h3>
<ul>
<li><code>命令 &lt; 文件</code> 等价于: 执行 <code>命令</code> 然后在 stdin 输入 { <code>cat 文件</code> 之所得}</li>
<li><code>命令 &lt;&lt;&lt; 字符串</code> 等价于: 执行 <code>命令</code> 然后在 <strong>stdin</strong> 输入 <code>字符串</code></li>
</ul>
<p>例如:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> <span class="token operator">&lt;&lt;&lt;</span> <span class="token string">"<span class="token variable">$&#123;<span class="token environment constant">HOME</span>&#125;</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
  <pre class="line-numbers language-none"><code class="language-none">&#x2F;home&#x2F;haoyu&#x2F;ENV&#x2F;CONF<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> <span class="token operator">&lt;&lt;&lt;</span> <span class="token string">'$&#123;HOME&#125;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
  <pre class="line-numbers language-none"><code class="language-none">$HOEM<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sed</span> <span class="token string">'s/a/b/g'</span> <span class="token operator">&lt;&lt;&lt;</span> <span class="token string">"aaa"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
  <pre class="line-numbers language-none"><code class="language-none">bbb<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<p><code>cat &lt; 文件</code> 等价于 <code>cat 文件</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">'aaa'</span> <span class="token operator">></span> <span class="token function">file</span>
<span class="token function">sed</span> <span class="token string">'s/a/b/g'</span> <span class="token operator">&lt;&lt;&lt;</span> <span class="token function">file</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<blockquote>
  <pre class="line-numbers language-none"><code class="language-none">bbb<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<h3 id="读取文件到变量"><a class="header-anchor" href="#读取文件到变量"></a>读取文件到变量</h3>
<ul>
<li>
<p>不保留结尾空白字符和开头空白字符</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">read</span> -r -d <span class="token string">''</span> 变量 <span class="token operator">&lt;</span> 文件<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li><code>-r</code>: raw string, 即原始的字符串</li>
<li><code>-d 分隔字符</code>: 以分隔符将分割得到的字符串数组给变量. 当其为 <code>''</code> 即不要分割.</li>
</ul>
</li>
<li>
<p>保留开头空白字符, 但不保结尾空白字符</p>
</li>
</ul>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">变量<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token operator">&lt;</span>文件<span class="token variable">)</span></span>
<span class="token comment"># 等价于</span>
变量<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> 文件<span class="token variable">)</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p>保留开头/结尾空白字符</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function-name function">file_to_var</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token builtin class-name">local</span> <span class="token assign-left variable">file_name</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$2</span>"</span>
  <span class="token builtin class-name">local</span> <span class="token assign-left variable">var_name</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$1</span>"</span>
  <span class="token builtin class-name">local</span> <span class="token assign-left variable">file_to_var_var</span><span class="token operator">=</span><span class="token string">''</span>
  <span class="token keyword">while</span> <span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span> <span class="token builtin class-name">read</span> -r line <span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token assign-left variable">file_to_var_var</span><span class="token operator">+=</span><span class="token string">"<span class="token variable">$line</span>"</span><span class="token string">$'<span class="token entity" title="\n">\n</span>'</span><span class="token punctuation">;</span>
  <span class="token keyword">done</span> <span class="token operator">&lt;</span> <span class="token variable">$file_name</span>
  <span class="token assign-left variable">file_to_var_var</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$&#123;file_to_var_var<span class="token operator">:</span>0<span class="token operator">:-</span>1&#125;</span>"</span>
  <span class="token builtin class-name">eval</span> <span class="token string">"<span class="token variable">$var_name</span>"</span><span class="token string">'="$&#123;file_to_var_var&#125;"'</span>
<span class="token punctuation">&#125;</span>
file_to_var 文件 变量<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h3 id="多行字符串"><a class="header-anchor" href="#多行字符串"></a><code>&lt;&lt;</code> 多行字符串</h3>
<ul>
<li>
<p>总述</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">命令 <span class="token operator">&lt;&lt;</span><span class="token punctuation">[</span>-<span class="token punctuation">]</span>EOF
  多行内容1
  多行内容2
EOF<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>以上等价于: 执行 <code>命令</code> 然后将 <code>&lt;&lt;[-]EOF</code> 与 <code>EOF</code> 之间的字符串 <strong>输入到 stdin</strong></li>
</ul>
</li>
<li>
<p><code>&lt;&lt;</code> / <code>&lt;&lt;-</code> 与 <code>EOF</code> 间可以有空格</p>
<ul>
<li><code>EOF</code> 可以改成任意 <code>[a-zA-Z_]+</code> 的字符串</li>
</ul>
</li>
<li>
<p><code>&lt;&lt;-</code> 表示去掉多行内容再每行开头的所有 tab, <code>&lt;&lt;</code> 则不去掉</p>
<ul>
<li>结尾的 <code>EOF</code> 必需在行首, 无缩进</li>
<li>不转义<code>\x</code>, 仅转义 <code>$&#123;xxx&#125;</code> <code>$xxx</code> <code>$(xxx)</code> <code>`xxx`</code>,  取消转义需 <code>$</code> 写做 <code>\$</code>, <code>`</code> 写做 <code>\`</code> .</li>
</ul>
</li>
<li>
<p>输出多行字符串:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
  多行内容1
  多行内容2
EOF</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出</p>
<pre class="line-numbers language-none"><code class="language-none">多行内容1
多行内容2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li>
<p>取消tab缩进, 但空格缩进不会取消:</p>
</li>
</ul>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> <span class="token operator">&lt;&lt;-</span><span class="token string">EOF
  多行内容1 # 开头是 tab, 不是空格
  多行内容2 # 开头是 tab, 不是空格
EOF</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出</p>
<pre><code><pre class="line-numbers language-none"><code class="language-none">多行内容1
多行内容2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</code></pre>
<ul>
<li>
<p>多行字符串写到文件</p>
</li>
<li>
<p>法一: <code>&gt;</code> 无法以 sudo 形式写入到文件</p>
</li>
</ul>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">  <span class="token function">cat</span> <span class="token operator">></span> 文件 <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
    多行内容1
    多行内容2
EOF</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>法二 [更灵活, 推荐之] : 允许以 sudo 形式写入到文件</li>
</ul>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">|</span> <span class="token punctuation">[</span> <span class="token function">sudo</span> <span class="token punctuation">]</span> <span class="token function">tee</span> <span class="token punctuation">[</span>-a<span class="token punctuation">]</span> 文件 <span class="token punctuation">[</span> <span class="token operator">></span>/dev/null <span class="token punctuation">]</span></span>
  多行内容1
  多行内容2
EOF</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p>多行字符串赋值给变量</p>
</li>
<li>
<p>不保留结尾空白字符和开头空白字符</p>
</li>
</ul>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">read</span> -r -d <span class="token string">''</span> var <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
  多行内容1
  多行内容2
EOF</span>

<span class="token comment"># 或将命令块的返回作为多行字符串返回给var</span>
<span class="token builtin class-name">read</span> -r -d <span class="token string">''</span> var <span class="token operator">&lt;</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span>命令块<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>保留开头/结尾空白字符</li>
</ul>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">var</span><span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">;</span> <span class="token keyword">while</span> <span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span> <span class="token builtin class-name">read</span> -r line <span class="token punctuation">;</span> <span class="token keyword">do</span> <span class="token assign-left variable">var</span><span class="token operator">+=</span><span class="token string">"<span class="token variable">$line</span>"</span><span class="token string">$'<span class="token entity" title="\n">\n</span>'</span><span class="token punctuation">;</span> <span class="token keyword">done</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">&amp;&amp;</span> <span class="token assign-left variable">var</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$&#123;var<span class="token operator">:</span>0<span class="token operator">:-</span>1&#125;</span>"</span></span>
  多行内容1
    多行内容2
EOF</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="输出重定向"><a class="header-anchor" href="#输出重定向"></a>输出重定向</h2>
<h3 id="与-_2"><a class="header-anchor" href="#与-_2"></a><code>&gt;</code> 与 <code>&gt;&gt;</code></h3>
<p>写文件的模式</p>
<ul>
<li><code>&gt;</code>： write模式：即若有文件，则重写文件；若无文件，则新创而写之</li>
<li><code>&gt;&gt;</code>： append模式：即若有文件，则追加到文件尾；若无文件，则新创而写之</li>
</ul>
<p>标准输出、标准错误重定向到文件</p>
<ul>
<li><code>命令 &gt;文件名</code>=<code>命令 1&gt;文件名</code> ：重定向标准输出到文件，write模式</li>
<li><code>命令 2&gt;文件名</code>：重定向标准错误到文件，write模式</li>
<li>上述 <code>&gt;</code>改为 <code>&gt;&gt;</code>，即变成append模式</li>
<li>（<code>&gt;</code>or <code>&gt;&gt;</code>） 与<code>文件名</code>之间可以有空格, 但与<code>&amp;1</code> <code>&amp;2</code> 之间不能有空格</li>
</ul>
<p>常用文件名</p>
<ul>
<li><code>	/dev/null</code>：可无限写入、但不保存内容的“黑洞“文件</li>
<li><code>&amp;1</code>：标准输出，会显示在显示屏</li>
<li><code>&amp;2</code>：标准错误，也会显示在显示屏</li>
</ul>
<p>标准输出、标准错误相互重定向</p>
<ul>
<li><code>2&gt;&amp;1</code>：将标准错误重定向到标准输出——标准错误不再有原标准错误的内容，而标准输出同时有远标准错误、标准输出的内容。</li>
<li><code>1&amp;&gt;2</code>：将标准输出重定向到标准错误，效果同上理</li>
</ul>
<p>重定向的组合命令：重定向从后往前执行，如 <code>命令 &gt;文件名 2&amp;&gt;1</code> 先执行  <code>2&amp;&gt;1</code> 后执行 <code>&gt;文件名</code></p>
<ul>
<li><code>命令 &amp;&gt;文件名</code> = <code>命令 &gt;文件名 2&amp;&gt;1</code> （≠ <code>命令 2&amp;&gt;1 &gt;文件名</code>）：标准输入和输出都重定向到文件，write模式</li>
<li><code>命令 &amp;&gt;&gt;文件名</code>= <code>命令 &gt;&gt;文件名 2&amp;&gt;1</code> （≠ <code>命令 2&amp;&gt;1 &gt;&gt;文件名</code>）：标准输入和输出都重定向到文件，append模式</li>
<li>上述不等的原因是，重定向从后往前执行</li>
</ul>
<p>缺点:</p>
<ul>
<li><code>&gt;</code>和 <code>&gt;&gt;</code> 不支持 sudo 重定向: 例如当执行 <code>sudo 命令 &gt;文件</code>, 仅 <code>命令</code> 是用 sudo 执行的, 重定向写文件用的是普通用户, 故若此文件仅 root 可写, 则会写入向失败. 可以使用 <code>tee</code> 来解决这个需求</li>
</ul>
<h3 id="tee-推荐"><a class="header-anchor" href="#tee-推荐"></a>tee [推荐]</h3>
<p>基础用法</p>
<ul>
<li><code>命令 | tee 文件</code>: write 模式 将命令的<strong>标准输出</strong>写在文件, 同时输出在终端</li>
<li><code>命令 | tee -a 文件</code>: append 模式 将命令的标准输出写在文件, 同时输出在终端</li>
</ul>
<p>变体用法</p>
<ul>
<li><code>命令 | tee [-a] 文件 &gt;/dev/null</code>: 仅将命令的标准输出写在文件, 标准输出<strong>不输出在终端</strong>, 标准错误才输出在终端</li>
<li><code>命令 | tee [-a] 文件 &gt;/dev/null 2&gt;&amp;1</code>: 仅将命令的标准输出写在文件, 标准输出/标准错误均<strong>不输出在终端</strong></li>
<li><code>命令 2&gt;&amp;1 | tee [-a] 文件</code>: 将命令的<strong>标准错误</strong>与标准输出写到文件, 同时输出在终端</li>
<li><code>命令 | sudo tee [-a] 文件</code> : 普通用户执行命令, <strong>sudo 模式重定向</strong>其标准输出到文件</li>
<li><code>sudo 命令 | sudo tee [-a] 文件</code> : sudo 用户执行命令, <strong>sudo 模式重定向</strong>其标准输出到文件</li>
</ul>
<p>以上变体均可组合, 如:</p>
<ul>
<li><code>sudo 命令 | sudo tee [-a] 文件 &gt;/dev/null</code> : sudo 用户执行命令, <strong>sudo 模式重定向</strong>其标准输出到文件. 仅将命令的标准输出写在文件, 标准输出<strong>不输出在终端</strong>, 标准错误才输出在终端</li>
</ul>
<p>优点:</p>
<ul>
<li>支持写到文件, 同时显示或不显示在终端</li>
<li>支持 sudo 写入到文件</li>
</ul>
<h3 id="dd"><a class="header-anchor" href="#dd"></a>dd</h3>
<p>基础用法</p>
<ul>
<li><code>命令 | dd of=文件</code>: write模式, 将命令的<strong>标准输出</strong>写在文件, 其标准输出<strong>不输出在终端</strong>, 标准错误才输出在终端</li>
<li><code>命令 | dd of=文件 oflag=append conv=notrunc</code> : append模式, 将命令的标准输出写在文件, 标准输出<strong>不输出在终端</strong></li>
</ul>
<p>变体用法</p>
<ul>
<li><code>命令 2&gt;&amp;1 | dd of=文件</code>: write模式, 将命令的<strong>标准输出</strong>/<strong>标准错误</strong>写在文件, <strong>均不输出在终端</strong></li>
<li><code>命令 | sudo dd of=文件</code>: 用普通账号运行命令; write模式, 用 sudo 模式将命令的标准输出写在文件, 标准错误才输出在终端</li>
<li><code>命令 | sudo dd of=文件</code>: 用 sudo 运行命令; write模式, 用 sudo 模式将命令的标准输出写在文件, 标准错误才输出在终端</li>
</ul>
<p>缺点:</p>
<ul>
<li>写到文件的同时无法显示在终端</li>
</ul>
<h1 id="参数传输"><a class="header-anchor" href="#参数传输"></a>参数传输</h1>
<h2 id="xargs命令"><a class="header-anchor" href="#xargs命令"></a>xargs命令</h2>
<p><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2019/08/xargs-tutorial.html">参见</a></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">前置命令 <span class="token operator">|</span> <span class="token function">xargs</span> -0  后续命令 -选项 参数 -选项 参数   <span class="token comment"># 传到最后一个参数后面做参数</span>
前置命令 <span class="token operator">|</span> <span class="token function">xargs</span> -0 -I<span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span> 后续命令 -选项 <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span> -选项 参数 <span class="token comment"># 传给&#123;&#125;所在位置的参数</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><code>-0</code>参数表示用<code>null</code>当作分隔符。</p>
<h1 id="后台运行"><a class="header-anchor" href="#后台运行"></a>后台运行</h1>
<h2 id="前台运行-重定向输出"><a class="header-anchor" href="#前台运行-重定向输出"></a>前台运行+重定向输出</h2>
<p>前台运行，在这个窗口输新命令无法立即执行</p>
<p>但又看不见输出的结果，输出都写入了文件中</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 输出写到文件，文件原来的内容全删</span>
<span class="token punctuation">&#123;</span>
   命令1
   命令2
   <span class="token punctuation">..</span>.
<span class="token punctuation">&#125;</span> <span class="token operator">>&amp;</span> 文件名    <span class="token comment"># 等价于  > 文件名 2>&amp;1</span>

<span class="token comment"># 输出追加写到文件名的屁股后面</span>
<span class="token punctuation">&#123;</span>
   命令1
   命令2
   <span class="token punctuation">..</span>.
<span class="token punctuation">&#125;</span> <span class="token operator">>></span><span class="token operator">&amp;</span> 文件名  <span class="token comment"># 等价于  > 文件名 2>&amp;1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><code>&gt; 文件名</code>表示将<code>1</code>（正常输出）写到<code>文件名</code>，文件原来的内容全删</li>
<li><code>&gt;&gt; 文件名</code>表示将<code>1</code>（正常输出）追加写到<code>文件名</code>的屁股后面</li>
<li><code>2&gt;&amp;1</code>表示将<code>2</code>（错误、警告）都用<code>1</code>（正常输出）输出</li>
<li>若 <code>文件名</code> = <code>/dev/null</code>，表示不显示到命令行，也不写到任何真实文件。<code>/dev/null</code>是一个可无限写入、但不保存内容的“黑洞“文件</li>
</ul>
<h2 id="后台运行结束插播短信"><a class="header-anchor" href="#后台运行结束插播短信"></a>后台运行结束插播短信</h2>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">&#123;</span>
   命令1
   命令2
   <span class="token punctuation">..</span>.
<span class="token punctuation">&#125;</span> <span class="token operator">&amp;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>后台执行命令1,2…</p>
<ul>
<li>开始启动时显示</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">120892</span>
用户名@服务器名 <span class="token punctuation">(</span>在此可以干别的事情<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<ul>
<li>完成时显示</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">用户名@服务器名 <span class="token punctuation">(</span>插播短信<span class="token string">"完成进程"</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>  + <span class="token number">120892</span> <span class="token keyword">done</span>       <span class="token punctuation">&#123;</span> 命令1<span class="token punctuation">;</span> 命令2<span class="token punctuation">;</span> <span class="token punctuation">..</span>. <span class="token punctuation">&#125;</span>
用户名@服务器名<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2 id="后台运行结束不插播短信-输出重定向"><a class="header-anchor" href="#后台运行结束不插播短信-输出重定向"></a>后台运行结束不插播短信+输出重定向</h2>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span> <span class="token punctuation">&#123;</span>
   命令1
   命令2
   <span class="token punctuation">..</span>.
<span class="token punctuation">&#125;</span> <span class="token operator">&amp;</span> <span class="token punctuation">)</span> <span class="token operator">>&amp;</span> <span class="token operator">&lt;</span>log_file<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>&amp;</code>：后台执行命令1,2…</p>
<p><code>&gt;&amp;</code> : 并将错误、警告、正常输出都写到 &lt;log_file&gt;</p>
<ul>
<li>程序开始和结束都不会有显示，要看输出需开`文件名</li>
</ul>
<h2 id="后台运行结束插播短信-输出重定向"><a class="header-anchor" href="#后台运行结束插播短信-输出重定向"></a>后台运行结束插播短信+输出重定向</h2>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span> <span class="token punctuation">&#123;</span>
   命令1
   命令2
   <span class="token punctuation">..</span>.
<span class="token punctuation">&#125;</span> <span class="token punctuation">)</span> <span class="token operator">>&amp;</span> <span class="token operator">&lt;</span>log_file<span class="token operator">></span> <span class="token operator">&amp;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>后台执行命令1,2…</p>
<ul>
<li>开始启动时显示</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">120892</span>
用户名@服务器名 <span class="token punctuation">(</span>在此可以干别的事情<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<ul>
<li>完成时显示</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">用户名@服务器名 <span class="token punctuation">(</span>插播<span class="token string">"完成进程"</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>  + <span class="token number">120892</span> <span class="token keyword">done</span>       <span class="token punctuation">&#123;</span> 命令1<span class="token punctuation">;</span> 命令2<span class="token punctuation">;</span> <span class="token punctuation">..</span>. <span class="token punctuation">&#125;</span>
用户名@服务器名<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ul>
<li>其余错误、警告、正常输出都写到 &lt;log_file&gt;</li>
<li>若 &lt;log_file&gt; = <code>/dev/null</code>，表示不显示到命令行，也不写到任何真实文件。/dev/null 是一个可无限写入、但不保存内容的“黑洞“文件。</li>
</ul>
<h2 id="多进程后台运行-运行完集中输出"><a class="header-anchor" href="#多进程后台运行-运行完集中输出"></a>多进程后台运行+运行完集中输出</h2>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">rand</span><span class="token operator">=</span><span class="token string">"<span class="token environment constant">$RANDOM</span>"</span>
<span class="token assign-left variable">log_file</span><span class="token operator">=</span><span class="token string">"/tmp/parallels<span class="token variable">$rand</span>"</span>
<span class="token punctuation">(</span>
    <span class="token keyword">for</span> 范围<span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token punctuation">&#123;</span>
        命令
    <span class="token punctuation">&#125;</span> <span class="token operator">>></span> <span class="token operator"><span class="token file-descriptor important">2</span>></span><span class="token file-descriptor important">&amp;1</span> <span class="token variable">$log_file</span> <span class="token operator">&amp;</span>
    <span class="token comment"># &amp;: 多进程后台运行</span>
    <span class="token comment"># >>  $log_file        # stdout 存入$log_fil</span>
    <span class="token comment"># >> 2>&amp;1 $log_file    # stdout, warning, error  存入$log_fil</span>
    <span class="token keyword">done</span>
    <span class="token function">wait</span>
<span class="token punctuation">)</span> <span class="token operator">>&amp;</span> /dev/null <span class="token comment"># stdout, warning, error, 包含 后台运行开始和结束的短信</span>
<span class="token function">cat</span> <span class="token variable">$log_file</span> <span class="token comment"># 集中输出运行结果</span>
<span class="token function">rm</span> <span class="token variable">$log_file</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="数学运算"><a class="header-anchor" href="#数学运算"></a>数学运算</h1>
<p><code> $(( 算式 ))</code> 等价于<code>$(expr 算式)</code> 等价于 <code>`xpr 算式`</code></p>
<p>算式中运算符与数值或变量之间必需有空格, 例如</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">a</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token variable">))</span></span><span class="token punctuation">;</span>  <span class="token builtin class-name">echo</span>  <span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> <span class="token number">1</span> + <span class="token number">2</span><span class="token variable">`</span></span><span class="token punctuation">;</span>  <span class="token builtin class-name">echo</span>  <span class="token variable"><span class="token variable">$(</span><span class="token function">expr</span> <span class="token number">1</span> + <span class="token number">2</span><span class="token variable">)</span></span><span class="token punctuation">;</span>  <span class="token function">expr</span> <span class="token number">1</span> + <span class="token number">2</span>
<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span>$a <span class="token operator">+</span> <span class="token number">2</span><span class="token variable">))</span></span><span class="token punctuation">;</span> <span class="token builtin class-name">echo</span>  <span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $a + <span class="token number">2</span><span class="token variable">`</span></span><span class="token punctuation">;</span> <span class="token builtin class-name">echo</span>  <span class="token variable"><span class="token variable">$(</span><span class="token function">expr</span> $a + <span class="token number">2</span><span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token function">expr</span> <span class="token variable">$a</span> + <span class="token number">2</span>
<span class="token comment"># 输出皆 3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="字符串"><a class="header-anchor" href="#字符串"></a>字符串</h1>
<p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000010885665">Zsh 开发指南（第二篇 字符串处理之常用操作）</a></p>
<p>以下的 <code>string </code>可以取做 <code>1</code> <code>2</code> …,  表示是函数或脚本的第1,2,…个参数</p>
<p>如 <code>$&#123;1:4&#125;</code> 表示第函数的1个参数的左起第4个字符(0开始计数)及往后的子串</p>
<h2 id="字符串长度"><a class="header-anchor" href="#字符串长度"></a>字符串长度</h2>
<h3 id="字符串长度-含颜色控制符"><a class="header-anchor" href="#字符串长度-含颜色控制符"></a>字符串长度 (含颜色控制符)</h3>
<p>zsh bash通用</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$&#123;<span class="token operator">#</span>string&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="字符串长度-去除颜色控制符"><a class="header-anchor" href="#字符串长度-去除颜色控制符"></a>字符串长度 (去除颜色控制符)</h3>
<p>zsh bash通用, 可以通过如下方法, 去除红色的控制符</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">string</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">'abc 123abc123'</span> <span class="token operator">|</span> <span class="token function">grep</span> --color<span class="token operator">=</span>always <span class="token number">123</span><span class="token variable">)</span></span>
<span class="token assign-left variable">length_string</span><span class="token operator">=</span><span class="token variable">$&#123;<span class="token operator">#</span>string&#125;</span>
<span class="token comment"># 等价于</span>
<span class="token assign-left variable">string_without_red</span><span class="token operator">=</span><span class="token string">"$(cat -v &lt;&lt;&lt; "<span class="token variable">$&#123;string&#125;</span>" | sed -E "s/(\^\[\[01;31m\^\[\[K|\^\[\[m\^\[\[K)//g"</span><span class="token punctuation">)</span>"
<span class="token assign-left variable">length_string_without_red</span><span class="token operator">=</span><span class="token variable">$&#123;<span class="token operator">#</span>string_without_red&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$string</span>"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$length_string</span>"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$string_without_red</span>"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$length_string_without_red</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出</p>
<pre class="line-numbers language-none"><code class="language-none">abc 123abc123
47
abc 123abc123
14<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="字符串取子串"><a class="header-anchor" href="#字符串取子串"></a>字符串取子串</h2>
<h3 id="string-始-长-从0开始-bash-zsh-支持-string-始-0-止-0-仅zsh支持"><a class="header-anchor" href="#string-始-长-从0开始-bash-zsh-支持-string-始-0-止-0-仅zsh支持"></a><code>&#123;string:始:长&#125; (从0开始)</code> bash/zsh 支持, <code>&#123;string:始&gt;=0:止&lt;0&#125; </code> 仅zsh支持</h3>
<table>
<thead>
<tr>
<th>bash或zsh支持</th>
<th>zsh支持，bash不支持</th>
<th>bash或zsh里这样写得不到想要的</th>
<th>结果（用python表示）</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&#123;string:始:长&#125;</code></td>
<td><code>&#123;string:始:止&#125;</code></td>
<td></td>
<td></td>
</tr>
<tr>
<td>始&gt;=0 左起<br>始&lt;=-1 右起<br>长&gt;=0</td>
<td>始&gt;=0 左起<br>始&lt;=-1 右起<br>止&lt;=-1 右起</td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>若始=-m&lt;=-1 且 长&gt;=0</strong></td>
<td><strong>若始=-m&lt;=-1 且 止=-n&lt;0</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>$&#123;string:始&#125;</code> <code>$&#123;string:始:止&#125;</code></td>
<td></td>
<td></td>
<td><code>string</code></td>
</tr>
<tr>
<td><code>$&#123;string:$&#123;</code> <code>#string&#125;-m:长&#125;</code></td>
<td></td>
<td></td>
<td><code>string[-m,len(string)-m+长]</code></td>
</tr>
<tr>
<td></td>
<td><code>$&#123;string:$&#123;</code> <code>#string&#125;-m:-n&#125;</code></td>
<td></td>
<td><code>string[-m,-n]</code></td>
</tr>
<tr>
<td><strong>止=倒数第 n 个 (n&gt;0)</strong></td>
<td>**若始&gt;=0 且 止=-n&lt;0 **</td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>$&#123;string:始:-n</code> = <code>$&#123;string:始:&#123;</code> <code>#string&#125;-n-始&#125;</code></td>
<td><code>$&#123;string:始:-n&#125;</code></td>
<td></td>
<td><code>string[始:-n]</code></td>
</tr>
<tr>
<td><strong>若始&gt;=0 且 长&gt;=0</strong></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>$&#123;string:始&#125;</code></td>
<td></td>
<td><code>$&#123;string:始:&#125;</code> zsh无法解析会报错，bash返回空字符串</td>
<td><code>string[始:]</code></td>
</tr>
<tr>
<td><code>$&#123;string:始:长&#125;</code></td>
<td></td>
<td></td>
<td><code>string[始:始+长]</code>即<code>string[始:min(始+长,len(string)+1]</code></td>
</tr>
<tr>
<td><code>$&#123;string:始:1&#125;</code></td>
<td></td>
<td><code>$&#123;string:始&#125;</code>结果是 <code>string[始:]</code></td>
<td><code>string[始]</code></td>
</tr>
<tr>
<td><code>$&#123;string:始:0&#125;</code></td>
<td></td>
<td></td>
<td><code>''</code></td>
</tr>
</tbody>
</table>
<p>说明:</p>
<ul>
<li><code>$&#123;string:x:y&#125;</code>: <code>x</code> <code>y</code> 可以<strong>直接写四则运算</strong>,如 <code>$&#123;stinrg:0*1+1:$&#123;</code> <code>#string&#125;/2+1&#125;</code></li>
</ul>
<h3 id="string-始-止-从1开始-仅-zsh-支持"><a class="header-anchor" href="#string-始-止-从1开始-仅-zsh-支持"></a><code>$string[始,止] (从1开始)</code> 仅 zsh 支持</h3>
<p>本写法zsh支持，bash不支持。始，止<strong>皆从1开始</strong>，可以是负数。</p>
<ul>
<li>
<p>取一个字符</p>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$string</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>取值：$n \in (-\infty,+\infty)$</p>
<p>结果：</p>
  <pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">if</span> n<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">:</span>
    n<span class="token operator">=</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n<span class="token operator">+</span><span class="token builtin">len</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> n <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> string<span class="token punctuation">[</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment"># 取出的是第n个字符</span>
<span class="token keyword">else</span>
    <span class="token keyword">return</span> <span class="token string">''</span>          <span class="token comment"># 取出的是''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li>
<p>取一段字符</p>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$string</span><span class="token punctuation">[</span>m,n<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>取值：$m,n \in (-\infty,+\infty)$</p>
<p>结果：</p>
  <pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">if</span> m<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">:</span>
    m<span class="token operator">=</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> m<span class="token operator">+</span><span class="token builtin">len</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> n<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">:</span>
    n<span class="token operator">=</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n<span class="token operator">+</span><span class="token builtin">len</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> m<span class="token operator">&lt;=</span>n<span class="token punctuation">:</span>
    <span class="token keyword">return</span> string<span class="token punctuation">[</span>m<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">]</span>    <span class="token comment"># 取出的是第[m,n] 区间的字符</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">''</span>               <span class="token comment"># 取出的是''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h2 id="遍历字符串"><a class="header-anchor" href="#遍历字符串"></a>遍历字符串</h2>
<p>以下适用于zsh和bash</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>$&#123;#string&#125;<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">))</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$&#123;string<span class="token operator">:</span>$i<span class="token operator">:</span>1&#125;</span>"</span>
<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2 id="字符串拼接"><a class="header-anchor" href="#字符串拼接"></a>字符串拼接</h2>
<p>以下适用于zsh和bash</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">string</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$&#123;sting1&#125;</span><span class="token variable">$&#123;string2&#125;</span>"</span>
<span class="token assign-left variable">string</span><span class="token operator">+=</span><span class="token string">"<span class="token variable">$&#123;sting2&#125;</span>"</span>
<span class="token assign-left variable">string</span><span class="token operator">+=</span><span class="token string">'xxxxxx'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2 id="字符串转数组"><a class="header-anchor" href="#字符串转数组"></a>字符串转数组</h2>
<pre class="line-numbers language-none"><code class="language-none">string&#x3D;&quot;1:2:3::4 :5&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><strong>zsh专用</strong></p>
<pre class="line-numbers language-none"><code class="language-none">array&#x3D;(&quot;$&#123;(@s&#x2F;【分割字符串】&#x2F;)string&#125;&quot;)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-zsh" data-language="zsh"><code class="language-zsh">array&#x3D;(&quot;$&#123;(@s&#x2F;:&#x2F;)string&#125;&quot;)
array&#x3D;(&quot;$&#123;(@s&#x2F;\n&#x2F;)string&#125;&quot;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><strong>bash专用</strong></p>
<ul>
<li>
<p>使用空白字符(正则表达式为<code>\s+</code>, 即连续尽可能多(&gt;=1个)的tab/换行/空格等)分割:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$&#123;string&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>或</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">read</span> -a array <span class="token operator">&lt;&lt;&lt;</span> <span class="token variable">$string</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ul>
<p><strong>bash与zsh通用</strong></p>
<ul>
<li>
<p>使用任何单个字符分割</p>
<p>注意, 连续两个【 分割字符】, 分割开会得到其中间的一个 “” 字符串, 这与bash专用的分割策略不同</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">hadopt</span><span class="token operator">=</span>false
<span class="token punctuation">[</span> -n <span class="token string">"<span class="token variable">$ZSH_VERSION</span>"</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span>setopt <span class="token operator">|</span> <span class="token function">grep</span> shwordsplit<span class="token variable">)</span></span>"</span> <span class="token operator">!=</span> <span class="token string">''</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
    <span class="token assign-left variable">hadopt</span><span class="token operator">=</span>true <span class="token operator">&amp;&amp;</span> setopt sh_word_split <span class="token comment"># 若为 zsh则开sh_word_split选项</span>
<span class="token assign-left variable">OLD_IFS</span><span class="token operator">=</span><span class="token string">"<span class="token environment constant">$IFS</span>"</span> <span class="token punctuation">;</span> <span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span><span class="token string">"【 分割字符】"</span> <span class="token comment"># " # 必需是单个字符，但可以是汉字</span>
<span class="token comment"># 如果是转义字符需加 $'\某'，如换行，需要写成  $'\n'，必需是单引号</span>
<span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> -E <span class="token string">"<span class="token variable">$string</span>"</span><span class="token variable">)</span></span><span class="token punctuation">)</span>
<span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span><span class="token string">"<span class="token variable">$OLD_IFS</span>"</span>
<span class="token punctuation">[</span> -n <span class="token string">"<span class="token variable">$ZSH_VERSION</span>"</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$hadopt</span>"</span> <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> unsetopt sh_word_split <span class="token comment"># 若原先没开此选项则关之</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>​	<code>zsh</code> 默认是没有开<code>sh_word_split</code>选项的，没开的话，得到的array=<code>(&quot;$&#123;string&#125;&quot;)</code></p>
<p>​	执行<code>setopt</code>命令查看开了哪些选项，若见’shwordsplot’则开了此选项</p>
</li>
<li>
<p>多行字符串, 按换行符分割为数组, 每行开头结尾的连续空白符均保留, 连续两个换行符分割出一个<code>''</code>字符串</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span> <span class="token builtin class-name">read</span> -r line <span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token assign-left variable">array</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token string">"<span class="token variable">$line</span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">done</span> <span class="token operator">&lt;&lt;&lt;</span> <span class="token string">"<span class="token variable">$&#123;string&#125;</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><code>IFS=</code> 等价于 <code>IFS=‘'</code>, 仅改变read这个命令的环境变量, 无需再恢复此环境变量</li>
</ul>
</li>
<li>
<p>若不加<code>IFS=</code>, 则line的开头/结尾的连续空白符 (<code>\s+</code>)会被删掉</p>
<ul>
<li><code>-r</code>: <code>\x</code> 不当成转义字符, 而当成普通字符串, 从而见到<code>&quot;\n”</code>不分割, 见到<code>$'\n’</code>才分割.</li>
</ul>
<p>例如</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">string</span><span class="token operator">=</span>'    asdas    <span class="token number">12312</span>

asdasd<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>’</p>
<h1 id="12312后有3个空格"><a class="header-anchor" href="#12312后有3个空格"></a>(12312后有3个空格)</h1>
<p>array=()<br>
while IFS= read -r line ; do<br>
array+=(“$line”);<br>
done &lt;&lt;&lt; “${string}”<br>
declare -p array</p>
<pre class="line-numbers language-none"><code class="language-none">
zsh输出
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
</ul>
<p>typeset -a array=( ’    asdas    12312   ’ ‘’ asdasd ‘’ ‘’ ‘’ )<br>
<pre class="line-numbers language-none"><code class="language-none">
bash输出
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><br>
declare -a array=‘([0]=&quot;    asdas    12312   &quot; [1]=“” [2]=“asdasd” [3]=“” [4]=“” [5]=“”)’<br>
<pre class="line-numbers language-none"><code class="language-none">    
    是一样的

## 字符串替换

### 引用字符串时替换

以下适用于&#96;zsh&#96;和&#96;bash&#96;

&#96;&#96;&#96;bash
&quot;$&#123;string&#x2F;旧子串&#x2F;新子串&#125;&quot;   #  替换首个旧子串
&quot;$&#123;string&#x2F;&#x2F;旧子串&#x2F;新子串&#125;&quot;  #  替换所有旧子串<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>
<ul>
<li>新旧字符串转义
<ul>
<li>空字符串：旧字符串中写作<code>$&#123;string/旧子串/&#125; </code>, 不可写作<code>$&#123;string/旧子串/''&#125; </code>(这样会替换为<code>''</code>)</li>
<li>空格 新旧字符串均写作`\ `  ，不可写作<code>' '</code></li>
<li>换行 新字符串中写作<code>\n</code>，旧字符串中写作<code>$'\n'</code></li>
<li><code>\ </code>新旧字符串均写作<code>\\</code></li>
<li><code>$ </code>新旧字符串均写作<code>\$</code></li>
<li><code>`</code>  新旧字符串均写作<code>\`</code></li>
<li><code>&quot;  </code>新旧字符串均写作<code>\&quot;</code></li>
</ul>
</li>
<li>新旧字符串不转义
<ul>
<li>不采用正则表达式</li>
<li><code>'</code>新旧字符串均写作<code>'</code> ,不可写作<code>\'</code></li>
</ul>
</li>
</ul>
<h3 id="用sed替换"><a class="header-anchor" href="#用sed替换"></a>用sed替换</h3>
<p>一下写法适用于mac、linux：</p>
<p>正则表达式进行字符串替换，<code>-E</code>表示支持正则表达式</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">new_string</span><span class="token operator">=</span><span class="token string">"<span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">echo</span> $string <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">'s/旧子串/新字符串/'</span><span class="token variable">`</span></span>"</span>   <span class="token comment"># 替换第一个匹配</span>
<span class="token assign-left variable">new_string</span><span class="token operator">=</span><span class="token string">"<span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">echo</span> $string <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">'s/旧子串/新字符串/g'</span><span class="token variable">`</span></span>"</span>  <span class="token comment"># 替换第全部匹配</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>输出文件内容并用正则表达式替换</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> 文件 <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">'s/旧子串/新字符串/'</span> <span class="token comment"># 替换第一个匹配</span>
<span class="token function">sed</span> -E <span class="token string">'s/旧子串/新字符串/'</span> 文件  <span class="token comment"># 替换第一个匹配</span>
<span class="token function">cat</span> 文件 <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">'s/旧子串/新字符串/g'</span> <span class="token comment"># 替换第全部匹配</span>
<span class="token function">sed</span> -E <span class="token string">'s/旧子串/新字符串/g'</span> 文件 <span class="token comment"># 替换第全部匹配</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><a target="_blank" rel="noopener" href="https://wiki.jikexueyuan.com/project/unix/regular-expressions.html">更多参考</a></p>
<ul>
<li>
<p>加<code>-E</code>才能在mac和linux下都支持正则表达式，不加<code>-E</code>则只linux支持正则表达式</p>
</li>
<li>
<p>新旧字符串中若有<code>/</code>，命令里应该写作<code>\/</code>，不能写作<code>&quot;/&quot;</code>,<code>'/'</code>,<code>\\\/</code>,<code>/</code></p>
</li>
<li>
<p>支持<code>[a-zA-z0-9]</code>的写法</p>
</li>
<li>
<p><code>[a-z]+</code>：加了<code>-E</code>则 应该写作 <code>[a-z]+</code> (不加<code>-E</code>写作<code>[a-z]\+</code>)</p>
</li>
<li>
<p>空白字符：不支持<code>\s</code>(空白字符)，支持<code>[:space:]</code>，</p>
<ul>
<li>例如替换所有空白字符<code>sed -E 's/[[:space:]]+//g'</code></li>
<li>例如替换所有非空白字符<code>sed -E 's/[^[:space:]]+//g'</code></li>
</ul>
</li>
<li>
<p>换成换行符：</p>
<ul>
<li>
<p>应该写成 <code>'s/旧子串/新字符串前段'$'\\\n''新字符串后段/g'</code></p>
</li>
<li>
<p>或写成</p>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token string">'s/旧子串/新字符串前段\
新字符串后段/g'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li>
<p>不可写成<code>s/旧子串/新字符串前段\n新字符串后段/g</code> ，或<code>s/旧子串/新字符串前段\\\n新字符串后段/g</code></p>
</li>
</ul>
</li>
<li>
<p>跨行替换/将换行符换掉：如些写</p>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sed</span> -e <span class="token string">':a'</span> -e <span class="token string">'N'</span> -e <span class="token string">'$!ba'</span> -Ee <span class="token string">'s/旧子串前段\n旧子串后段/新字符串/g'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p>sed的参数 <code>-e 'xxxx'</code> 表示追加一条命令，即</p>
<ul>
<li>当<code>sed</code>只执行一条命令(如<code>s/xxx/xxx/g</code>）, 则 <code>sed  &quot;s/xxx/xxx/g&quot;</code> 是 <code>sed -e &quot;s/xxx/xxx/g&quot;</code>的简写</li>
<li>当<code>sed</code>执行多条命令时，则每条命令前需要写<code>-e</code>，如<code>sed -e 'xx' -e 'xxx' -e 'xxxxx'</code></li>
</ul>
</li>
<li>
<p>选中一行再进行替换</p>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sed</span> -e <span class="token string">'/子串1/ s/字串2/字串3/'</span>       <span class="token comment"># 先选中有字串1的行，再将这些行中的字串2替换为字串3</span>
perl -pe <span class="token string">'/子串1/ &amp;&amp; s/字串2/字串3/'</span>  <span class="token comment"># 先选中有字串1的行，再将这些行中的字串2替换为字串3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li>
<p>引用被匹配的内容：<code>sed 's/xxx\(aaa\)xxx\(bbb\)xxx/yyy\1yyy\2yyy/g'</code>，则替换结果为</p>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">yyyaaayyybbbyyy<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
</li>
</ul>
<h3 id="用perl替换"><a class="header-anchor" href="#用perl替换"></a>用perl替换</h3>
<p>sed不支持正则表达式中的向前匹配、向后匹配、非贪婪匹配（即模式后面加<code>?</code>），可以用perl命令代替sed搞替换。</p>
<p>Linux系统一般默认安装Perl包</p>
<p>以下适用于<code>zsh</code>和<code>bash</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">perl -pe <span class="token string">'s/旧子串/新子串/g'</span> <span class="token operator">&lt;</span>文件路径<span class="token operator">></span> <span class="token comment"># 输出替换后的全文</span>
perl -i -pe <span class="token string">'s/旧子串/新子串/g'</span> <span class="token operator">&lt;</span>文件路径<span class="token operator">></span> <span class="token comment"># 在文件内直接替换</span>
<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$&#123;string&#125;</span>"</span> ｜ perl -pe <span class="token string">'s/旧子串/新子串/g'</span> <span class="token operator">&lt;</span>文件路径<span class="token operator">></span> <span class="token comment"># 替换输出</span>
<span class="token function">cat</span> <span class="token operator">&lt;</span>文件路径<span class="token operator">></span> ｜ perl -pe <span class="token string">'s/旧子串/新子串/g'</span> <span class="token operator">&lt;</span>文件路径<span class="token operator">></span> <span class="token comment"># 替换输出</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="取第几行"><a class="header-anchor" href="#取第几行"></a>取第几行</h2>
<p>取前m行</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$&#123;string&#125;</span>"</span> <span class="token operator">|</span> <span class="token function">head</span> -n <span class="token operator">&lt;</span>m<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>取后行</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$&#123;string&#125;</span>"</span> <span class="token operator">|</span> <span class="token function">tail</span> -n <span class="token operator">&lt;</span>m<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>去掉前<strong>m-1</strong>行</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$&#123;string&#125;</span>"</span> <span class="token operator">|</span> <span class="token function">tail</span> -n +<span class="token operator">&lt;</span>m<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>去掉后m行</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$&#123;string&#125;</span>"</span> <span class="token operator">|</span> <span class="token function">head</span> -n -<span class="token operator">&lt;</span>m<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="截取"><a class="header-anchor" href="#截取"></a>截取</h2>
<h3 id="语法"><a class="header-anchor" href="#语法"></a>语法</h3>
<table>
<thead>
<tr>
<th>写法</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>$&#123;variable#pattern&#125;</code></td>
<td>去掉variable头最短匹配的pattern</td>
</tr>
<tr>
<td><code>$&#123;variable##pattern&#125;</code></td>
<td>去掉variable头最长匹配的pattern</td>
</tr>
<tr>
<td><code>$&#123;variable%pattern&#125;</code></td>
<td>去掉variable尾最短匹配的pattern</td>
</tr>
<tr>
<td><code>$&#123;variable%%pattern&#125;</code></td>
<td>去掉variable尾最长匹配的pattern</td>
</tr>
</tbody>
</table>
<p><code>pattern</code> 采用通配符的语法:</p>
<ul>
<li><code>?</code> : 0或1个任意字符</li>
<li><code>*</code> : [0,+∞)个任意字符</li>
<li><code>[...]</code> : 匹配一个字符 中括号里面</li>
<li><code>[!...]</code> (bash), <code>[\!...]</code> (zsh): 匹配一个字符 不在中括号里</li>
</ul>
<p>注意:</p>
<ul>
<li><code>[...]</code>或<code>[!...]</code> 后加<code>+</code> <code>*</code>  <code>?</code>  均不表示对中括号描述的字符重复[1,+∞), [0,+∞), [0,1]次; 而是表示匹配完一个中括号描述的字符, 而后再匹配 一个&quot;+”字符/[0,+∞)个任意字符/0或1个任意字符</li>
</ul>
<h3 id="用法"><a class="header-anchor" href="#用法"></a>用法</h3>
<p>截取某个子串之前/之后</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token string">"<span class="token variable">$&#123;string<span class="token operator">%%</span>子串*&#125;</span>"</span>    <span class="token comment"># 截取 string 第一个 &lt;子串> 之前</span>
<span class="token string">"<span class="token variable">$&#123;string<span class="token operator">%</span>子串*&#125;</span>"</span>     <span class="token comment"># 截取 string 最后一个 &lt;子串> 之前</span>
<span class="token string">"<span class="token variable">$&#123;string<span class="token operator">#</span>*子串&#125;</span>"</span>     <span class="token comment"># 截取 string 第一个 &lt;子串> 之后</span>
<span class="token string">"<span class="token variable">$&#123;string<span class="token operator">##</span>*子串&#125;</span>"</span>    <span class="token comment"># 截取 string 最后一个 &lt;子串> 之后</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>注释:</p>
<ul>
<li>
<p><code>子串</code> 可以直接写字符, 可以是单个或多个字符, 如</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">string</span><span class="token operator">=</span><span class="token string">'https://github.com/someone://other'</span>
<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$&#123;string<span class="token operator">%%</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>*&#125;</span>"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$&#123;string<span class="token operator">#</span>*<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>&#125;</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>返回</p>
<pre class="line-numbers language-none"><code class="language-none">https
github.com&#x2F;someone:&#x2F;&#x2F;other<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li>
<p><code>子串</code> 可以写 <code>$&#123;substring&#125;</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">string</span><span class="token operator">=</span><span class="token string">'https://github.com/someone://other'</span>
<span class="token assign-left variable">substring</span><span class="token operator">=</span><span class="token string">'://'</span>
<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$&#123;string<span class="token operator">%%</span>$&#123;substring&#125;</span>*&#125;"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$&#123;string<span class="token operator">#</span>*$&#123;substring&#125;</span>&#125;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>也返回同上</p>
</li>
<li>
<p>若无目标子串, 则各自均换返回整个字符串, 例如</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">string</span><span class="token operator">=</span><span class="token string">'https://github.com/someone://other'</span>
<span class="token assign-left variable">substring</span><span class="token operator">=</span><span class="token string">'///'</span>
<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$&#123;string<span class="token operator">%%</span>$&#123;substring&#125;</span>*&#125;"</span>
<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$&#123;string<span class="token operator">#</span>*$&#123;substring&#125;</span>&#125;"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>返回</p>
<pre class="line-numbers language-none"><code class="language-none">https:&#x2F;&#x2F;github.com&#x2F;someone:&#x2F;&#x2F;other
https:&#x2F;&#x2F;github.com&#x2F;someone:&#x2F;&#x2F;other<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
</ul>
<h2 id="调用"><a class="header-anchor" href="#调用"></a>调用</h2>
<p>bash与zsh通用的写法是 <code>&quot;$&#123;string&#125;”</code> 或 <code>&quot;$string&quot;</code>, 加不加<code>&#123;...&#125;</code>无影响</p>
<h4 id="bash"><a class="header-anchor" href="#bash"></a>bash</h4>
<p>bash中, 调用变量名为string的字符串, 必需两侧加引号.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token string">"<span class="token variable">$string</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>若不加引号, 则其中所有连续大于等于1个空白符(即正则表达式的<code>\s+</code>)均替换为一个空格</p>
<p>且在echo时, 行开头<s>与结尾</s>的连续空白符(即<code>^\s+</code>)会删去. 例如</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">a</span><span class="token operator">=</span><span class="token string">'   a b  c   d
e
f  '</span> <span class="token comment"># d后有四个空格, 可能代码里显示不出来</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token variable">$a</span><span class="token string">'|'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
  <pre class="line-numbers language-none"><code class="language-none">a b c d e f |<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">'|'</span><span class="token variable">$a</span><span class="token string">'|'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
  <pre class="line-numbers language-none"><code class="language-none">| a b c d e f |<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$a</span>|"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
  <pre class="line-numbers language-none"><code class="language-none">   a b  c   d
e
f  |<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$a</span>|"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
  <pre class="line-numbers language-none"><code class="language-none">|   a b  c   d
e
f  |<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h4 id="zsh"><a class="header-anchor" href="#zsh"></a>zsh</h4>
<p>zsh中, 调用变量名为string的字符串, 加不加引号皆可, 均会输出完整的字符串, 各行齐全, 空白符未改动.</p>
<p>即 zsh中 <code>&quot;$string”</code> 与 <code>$string</code> 结果都是 与bash中的 <code>&quot;$string”</code> 相同的.</p>
<h2 id="输出-_3"><a class="header-anchor" href="#输出-_3"></a>输出</h2>
<p>以下适用于<code>zsh</code>和<code>bash</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> -E 字符串 <span class="token comment"># 输出不转义，即`\某`不会转义，输出还是`\某`</span>
<span class="token builtin class-name">echo</span> -e 字符串 <span class="token comment"># 输出会转义，即`\某`会转义</span>
<span class="token builtin class-name">echo</span> -n 字符串 <span class="token comment"># 结尾不换行</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2 id="输入-_2"><a class="header-anchor" href="#输入-_2"></a>输入</h2>
<p>参数含义：输入写到string变量</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">read</span> -r string <span class="token comment"># 输入不转义，即`\某`不会转义，输入还是`\某`；输入完会换行</span>
<span class="token builtin class-name">read</span> -s string <span class="token comment"># 输入字符不显示；输入完不会换行</span>
<span class="token builtin class-name">read</span> -p 提示信息 string <span class="token comment"># bash支持，zsh不支持</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>组合用法：以下适用于<code>zsh</code>和<code>bash</code></p>
<ul>
<li>
<p>输入普通信息</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> -n 提示信息<span class="token punctuation">;</span> <span class="token builtin class-name">read</span> -r string<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">提示信息:输入内容
输入完进入下一行<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</blockquote>
</li>
<li>
<p>输入密码</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> -n 提示信息<span class="token punctuation">;</span> <span class="token builtin class-name">read</span> -rs string<span class="token punctuation">;</span> <span class="token builtin class-name">echo</span> <span class="token string">''</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">提示信息:                       &#x2F;&#x2F; 输入内容不显示
输入完进入下一行<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</blockquote>
</li>
</ul>
<h2 id="转义-_2"><a class="header-anchor" href="#转义-_2"></a>转义</h2>
<p>以下适用于<code>zsh</code>和<code>bash</code></p>
<ul>
<li><code>'</code> in <code>'xxxx'</code>：<code>'xxx'\''xxxx'</code>(推荐) 或 <code>'xxx'&quot;'&quot;'xxx'</code>
<ul>
<li><code>'xxx\'xxxx'</code> 无用，会被解析成<code>xxx\</code>(字符串),<code>xxxx</code>(变量), <code>'</code>(另一个字符串的开头)</li>
</ul>
</li>
<li><code>&quot;</code> in <code>&quot;xxxx&quot;</code>:    <code>&quot;xxx&quot;\&quot;&quot;xxxx&quot;</code> 或 <code>&quot;xxx\&quot;xxx&quot;</code>(推荐)</li>
</ul>
<h1 id="数组"><a class="header-anchor" href="#数组"></a>数组</h1>
<p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000010910381">参考</a></p>
<h2 id="显示数组"><a class="header-anchor" href="#显示数组"></a>显示数组</h2>
<pre class="line-numbers language-none"><code class="language-none">declare -p array<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>返回如下</p>
<p><strong>zsh</strong></p>
<pre class="line-numbers language-none"><code class="language-none">typeset -a array&#x3D;( 1 &#39;2\n&#39; 3 &#39;4 &#39; 5 )<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><strong>bash</strong></p>
<pre class="line-numbers language-none"><code class="language-none">declare -a array&#x3D;&#39;([0]&#x3D;&quot;1&quot; [1]&#x3D;&quot;2\\n&quot; [2]&#x3D;&quot;3&quot; [3]&#x3D;&quot;4 &quot; [4]&#x3D;&quot;5&quot;)&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="数组取元素"><a class="header-anchor" href="#数组取元素"></a>数组取元素</h2>
<h3 id="array-始-长-从0开始-sh-bash-zsh共享"><a class="header-anchor" href="#array-始-长-从0开始-sh-bash-zsh共享"></a><code>$&#123;array[@]:始:长&#125; (从0开始)</code>  sh/bash/zsh共享</h3>
<ul>
<li>array数组     起始数字从 0 开始, 长度&gt;=1;        函数的参数   起始数字从 1 开始, 长度&gt;=1</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># array数组                            函数的参数</span>
<span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span><span class="token operator">:</span>起始数字<span class="token operator">:</span>1&#125;</span>"</span>               <span class="token string">"<span class="token variable">$&#123;@<span class="token operator">:</span>起始数字<span class="token operator">:</span>1&#125;</span>"</span>      <span class="token comment"># return array[起始数字]</span>
<span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span><span class="token operator">:</span>起始数字<span class="token operator">:</span>长度&#125;</span>"</span>             <span class="token string">"<span class="token variable">$&#123;@<span class="token operator">:</span>起始数字<span class="token operator">:</span>长度&#125;</span>"</span>   <span class="token comment"># return array[起始数字:长度]</span>
<span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span><span class="token operator">:</span>起始数字&#125;</span>"</span>                 <span class="token string">"<span class="token variable">$&#123;@<span class="token operator">:</span>起始数字&#125;</span>"</span>        <span class="token comment"># return array[起始数字:]</span>
<span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span>"</span>                         <span class="token string">"<span class="token variable">$&#123;@&#125;</span>"</span>               <span class="token comment"># return array</span>
<span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span><span class="token operator">:</span>$&#123;<span class="token operator">#</span>array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span>&#125;"</span>            <span class="token string">"<span class="token variable">$&#123;@<span class="token operator">:</span>$<span class="token operator">#</span>&#125;</span>"</span>            <span class="token comment"># return array[-1]</span>
<span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span><span class="token operator">:</span>$&#123;$((<span class="token operator">#</span>array<span class="token punctuation">[</span>@<span class="token punctuation">]</span> - 1))&#125;</span>&#125;"</span>   <span class="token string">"<span class="token variable">$&#123;@<span class="token operator">:</span>$(($<span class="token operator">#</span> - 1))&#125;</span>"</span>   <span class="token comment"># return array[-2:]     $(( 算式 )) 等价于 `expr 算式 `</span>
<span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span><span class="token operator">:</span>$&#123;$((<span class="token operator">#</span>array<span class="token punctuation">[</span>@<span class="token punctuation">]</span> - 1))&#125;</span>:1&#125;"</span> <span class="token string">"<span class="token variable">$&#123;@<span class="token operator">:</span>$(($<span class="token operator">#</span> - 1))<span class="token operator">:</span>1&#125;</span>"</span> <span class="token comment"># return array[-2:]     $(( 算式 )) 等价于 `expr 算式 `</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p>当 <code>始</code>, <code>长</code> 为变量时, 必须写<code>$</code>, 例如</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span><span class="token operator">:</span>$index<span class="token operator">:</span>2&#125;</span>"</span>    <span class="token comment"># 可以解析</span>
<span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span><span class="token operator">:</span>index<span class="token operator">:</span>2&#125;</span>"</span>     <span class="token comment"># 无法解析</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li>
<p>当 <code>始</code>, <code>长</code> 为四则运算时, 直接写算式即可, 支持<code>+</code> <code>- </code> <code>*</code> <code>/</code> <code>(</code> <code>)</code>, 例如</p>
</li>
</ul>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span>zero one two three four five six seven eight nine ten <span class="token punctuation">)</span>
<span class="token assign-left variable">idx</span><span class="token operator">=</span><span class="token number">3</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span><span class="token operator">:</span>(($idx+2)<span class="token operator">/</span>2)*3-1<span class="token operator">:</span>1&#125;</span>
<span class="token comment"># 返回 5</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="数-从1开始-sh-bash-zsh共享"><a class="header-anchor" href="#数-从1开始-sh-bash-zsh共享"></a><code>$数 (从1开始)</code>   sh/bash/zsh共享</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token string">"$数"</span>                     <span class="token comment"># 函数的第[数]个参数</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li>
<p>当<code>数</code>为变量时, 只能用<code>eval var=\&quot;\$&#123;$&#123;idx&#125;&#125;\&quot;</code> 来获得 (如下), 或用 <code>$&#123;@:$idx:1&#125;</code> (必需写$)</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function-name function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token assign-left variable">idx</span><span class="token operator">=</span><span class="token number">2</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">$idx</span>  <span class="token comment"># 返回 2</span>
    <span class="token builtin class-name">eval</span> <span class="token assign-left variable">var</span><span class="token operator">=</span><span class="token punctuation">\</span>"<span class="token punctuation">\</span><span class="token variable">$&#123;$&#123;idx&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">\</span>"  <span class="token punctuation">;</span>	<span class="token builtin class-name">echo</span> <span class="token variable">$&#123;var&#125;</span>  <span class="token comment"># 返回  arg 2</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">$&#123;$&#123;idx&#125;</span><span class="token punctuation">&#125;</span> <span class="token comment"># 返回 2</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">$&#123;$idx&#125;</span> <span class="token comment">#  返回 f:5: bad substitution</span>
<span class="token punctuation">&#125;</span>

f <span class="token string">'arg 1'</span> <span class="token string">'arg 2'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li>
<p>当 <code>数</code> 为size运算算式时, 只能用<code>eval var=\&quot;\$&#123;$((算式))&#125;\&quot;</code> 来获得 (如下), 或用 <code>$&#123;@:直接写size运算:1&#125;</code> (必需写$)</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function-name function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin class-name">eval</span> <span class="token assign-left variable">var</span><span class="token operator">=</span><span class="token punctuation">\</span>"<span class="token punctuation">\</span><span class="token variable">$&#123;$((1 + 1))&#125;</span><span class="token punctuation">\</span>"
    <span class="token builtin class-name">echo</span> <span class="token variable">$var</span>
<span class="token punctuation">&#125;</span>
f <span class="token string">'arg 1'</span> <span class="token string">'arg 2'</span>
<span class="token comment"># 返回 arg 2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h3 id="array-数-”-bash从0开始-zsh从1开始"><a class="header-anchor" href="#array-数-”-bash从0开始-zsh从1开始"></a><code>&quot;$&#123;array[数]&#125;” (bash从0开始, zsh从1开始)</code></h3>
<ul>
<li>sh/bash: 数字 从0开始</li>
<li>zsh: 数字从1开始</li>
<li><code>&quot;$&#123;@[数字]&#125;”</code> 写法无效</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>数字<span class="token punctuation">]</span>&#125;</span>"</span>           <span class="token comment"># return array[数字]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li>
<p>当 <code>数</code> 为变量时, 可以不写<code>$</code>, 例如</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span><span class="token operator">:</span>$index<span class="token operator">:</span>2&#125;</span>"</span>    <span class="token comment"># 可以解析</span>
<span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span><span class="token operator">:</span>index<span class="token operator">:</span>2&#125;</span>"</span>     <span class="token comment"># 可以解析</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li>
<p>当 <code>始</code>, <code>长</code> 为四则运算时, 直接写算式即可, 支持<code>+</code> <code>- </code> <code>*</code> <code>/</code> <code>(</code> <code>)</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span>zero one two three four five six seven eight nine ten <span class="token punctuation">)</span>
<span class="token assign-left variable">idx</span><span class="token operator">=</span><span class="token number">3</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$&#123;array<span class="token punctuation">[</span>(($idx+2)<span class="token operator">/</span>2)*3-1<span class="token punctuation">]</span>&#125;</span>
<span class="token comment"># bash 返回 five, zsh 返回 four</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h3 id="array-始-止-从1开始-仅zsh支持"><a class="header-anchor" href="#array-始-止-从1开始-仅zsh支持"></a><code>$&#123;array[始,止]&#125; (从1开始)</code>  仅zsh支持</h3>
<ul>
<li>数字/起始数字 从1开始, 表示正着数</li>
<li>起始数字, 结束数字可为-1,-2, …, 表示结束数字倒着数</li>
<li>不论正着数还是倒着数, 只要起始位置比结束位置靠右, 则返回空白字符串</li>
<li>当 <code>始</code>, <code>止</code> 为变量时, 必须写<code>$</code></li>
<li>当 <code>始</code>, <code>止</code> 为四则运算时, 直接写算式即可, 支持<code>+</code> <code>- </code> <code>*</code> <code>/</code> <code>(</code> <code>)</code></li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># array数组                  函数的参数</span>
<span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>数字<span class="token punctuation">]</span>&#125;</span>"</span>             <span class="token string">"<span class="token variable">$&#123;@<span class="token punctuation">[</span>数字<span class="token punctuation">]</span>&#125;</span>"</span>              <span class="token comment"># 按照上述index计法, 返回第 数字 个元素, 对应Python: array[数字-1]</span>
<span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>起始数字<span class="token operator">,</span>结束数字<span class="token punctuation">]</span>&#125;</span>"</span>  <span class="token string">"<span class="token variable">$&#123;@<span class="token punctuation">[</span>起始数字<span class="token operator">,</span>结束数字<span class="token punctuation">]</span>&#125;</span>"</span> <span class="token comment"># 按照上述 index 计法, 返回数组 取闭区间 [起始数字,正结束数字]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><code>$&#123;array[起始数字,结束数字]&#125;</code> 对应的 python 代码</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">if</span> 结束数字<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> array<span class="token punctuation">[</span>起始数字<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>结束数字<span class="token punctuation">]</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> 结束数字<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> 结束数字<span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> array<span class="token punctuation">[</span>起始数字<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> array<span class="token punctuation">[</span>起始数字<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>结束数字<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="数组长度"><a class="header-anchor" href="#数组长度"></a>数组长度</h2>
<p>zsh/bash通用</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$&#123;<span class="token operator">#</span>array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>zsh专用</p>
<pre class="line-numbers language-zsh" data-language="zsh"><code class="language-zsh">$&#123;#array&#125;
# 或
$#array<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2 id="判断是否是数组"><a class="header-anchor" href="#判断是否是数组"></a>判断是否是数组</h2>
<p><strong>封装成函数</strong></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function-name function">is_array</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin class-name">local</span> <span class="token assign-left variable">array_name</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$1</span>"</span>
    <span class="token comment"># declare -p $array_name</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">declare</span> -p $array_name<span class="token variable">)</span></span>"</span> <span class="token operator">=~</span> <span class="token string">'declare -a '</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">\</span>
       <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">declare</span> -p $array_name<span class="token variable">)</span></span>"</span> <span class="token operator">=~</span> <span class="token string">'typeset -g -a '</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">\</span>
       <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">declare</span> -p $array_name<span class="token variable">)</span></span>"</span> <span class="token operator">=~</span> <span class="token string">'typeset -a '</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token builtin class-name">echo</span> <span class="token boolean">true</span>
    <span class="token keyword">else</span>
        <span class="token builtin class-name">echo</span> <span class="token boolean">false</span>
    <span class="token keyword">fi</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-none"><code class="language-none">a&#x3D;(gpu&#123;1..3&#125;)
is_array a<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">true<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">a&#x3D;adsaasd
is_array a<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">false<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<p>注：</p>
<ul>
<li>
<p>bash 返回</p>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">declare -a array_name&#x3D;&#39;([0]&#x3D;&quot;gpu1&quot; [1]&#x3D;&quot;gpu2&quot; [2]&#x3D;&quot;gpu3&quot;)&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
</li>
<li>
<p>zsh   返回</p>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">typeset -g -a array_name&#x3D;( gpu1 gpu2 gpu3 )
或
typeset -a array_name&#x3D;( gpu1 gpu2 gpu3 )<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</blockquote>
</li>
</ul>
<h2 id="数组赋值与拼接"><a class="header-anchor" href="#数组赋值与拼接"></a>数组赋值与拼接</h2>
<p>以下适用于<code>zsh</code>和<code>bash</code>的</p>
<ul>
<li>数组赋值</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">"<span class="token variable">$&#123;array1<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span>"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>declare -p array</code>和<code>declare -p array1</code>输出结果会完全一样，即array和array1的每个元素都一样，元素内可以含有空格、换行，均不影响赋值。</p>
<ul>
<li>数组拼接并赋值</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">"<span class="token variable">$&#123;array1<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span>"</span> <span class="token string">"<span class="token variable">$&#123;array2<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span>"</span><span class="token punctuation">)</span>
<span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">"<span class="token variable">$&#123;array1<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span>"</span> <span class="token string">"string"</span><span class="token punctuation">)</span>
<span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">"string"</span> <span class="token string">"<span class="token variable">$&#123;array2<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span>"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">array</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token string">"<span class="token variable">$&#123;array2<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span>"</span><span class="token punctuation">)</span>
<span class="token comment"># 等价于</span>
<span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span>"</span> <span class="token string">"<span class="token variable">$&#123;array2<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span>"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>array1、array2元素内可以含有空格、换行，均不影响拼接和赋值。</p>
<p>上述不可省略<code>&quot;</code>，这是因为</p>
<ul>
<li>
<p><code>$&#123;array[@]&#125;$</code>(bash)  返回 <code>'\n'.join(array).split('\n')</code>(python)</p>
</li>
<li>
<p><code>&quot;$&#123;array[@]&#125;$&quot;</code> (zsh、bash) 和 <code>$&#123;array[@]&#125;$</code>(zsh)   返回 <code>array</code>(python)</p>
<p><strong>例如</strong>：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">array1</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'asd'</span> <span class="token string">'asd\nsads
asdsa'</span><span class="token punctuation">)</span>
<span class="token assign-left variable">array2</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'asd'</span><span class="token punctuation">)</span>
<span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$&#123;array1<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span> <span class="token variable">$&#123;array2<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span><span class="token punctuation">)</span>
<span class="token builtin class-name">declare</span> -p array<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p>bash中返回</p>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">declare -a array&#x3D;&#39;([0]&#x3D;&quot;asd&quot; [1]&#x3D;&quot;asd\\nsads&quot; [2]&#x3D;&quot;asdsa&quot; [3]&#x3D;&quot;asd&quot;)&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<p>即<code>array</code>数组成员中若有换行， <code>$&#123;array[@]&#125;$</code>  会得到两个数组成员，在换行号处断开成</p>
</li>
<li>
<p>zsh中</p>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">typeset -a array&#x3D;( asd $&#39;asd\nsads\nasdsa&#39; asd )<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<p>即<code>array</code>数组成员中若有换行， <code>$&#123;array[@]&#125;$</code>  不会得到两个数组成员，不在换行号处断开成</p>
</li>
</ul>
</li>
</ul>
<h2 id="生成range"><a class="header-anchor" href="#生成range"></a>生成range</h2>
<p>以下适用于<code>zsh</code>和<code>bash</code></p>
<h3 id="一组range"><a class="header-anchor" href="#一组range"></a>一组range</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'前缀'</span><span class="token punctuation">&#123;</span>起始数字<span class="token punctuation">..</span>结束数字<span class="token punctuation">&#125;</span><span class="token string">'后缀'</span><span class="token punctuation">)</span>  <span class="token comment"># 前缀、后缀可有空格、回车</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>原理：</p>
<ul>
<li>代码<code>前缀&#123;起始数字..结束数字&#125;后缀</code>等价于代码<code>'前缀xx后缀' '前缀xx后缀' …… '前缀xx后缀'  </code></li>
<li>故<code>('前缀'起始数字..结束数字&#125;'后缀')</code>返回数字<code>('前缀xx后缀' '前缀xx后缀'    ……   '前缀xx后缀')</code></li>
</ul>
<h3 id="多组range拼接起来"><a class="header-anchor" href="#多组range拼接起来"></a>多组range拼接起来</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'前缀1'</span><span class="token punctuation">&#123;</span>起始数字<span class="token punctuation">..</span>结束数字<span class="token punctuation">&#125;</span><span class="token string">'后缀1'</span> <span class="token string">'前缀2'</span><span class="token punctuation">&#123;</span>起始数字<span class="token punctuation">..</span>结束数字<span class="token punctuation">&#125;</span><span class="token string">'后缀2'</span><span class="token punctuation">)</span>  <span class="token comment"># 前缀、后缀可有空格、回车</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>原理：</p>
<ul>
<li>
<p>等价于</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'前缀1xx后缀1'</span> <span class="token string">'前缀1xx后缀1'</span> …… <span class="token string">'前缀1xx后缀1'</span> <span class="token string">'前缀2xx后缀2'</span> <span class="token string">'前缀2xx后缀2'</span> …… <span class="token string">'前缀2xx后缀2'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
</ul>
<h2 id="从文件加载数组"><a class="header-anchor" href="#从文件加载数组"></a>从文件加载数组</h2>
<p>适用于zsh、bash，mac、linux</p>
<ul>
<li>以换行为分隔符（tab和空格皆不分割）</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">IFS_old</span><span class="token operator">=</span><span class="token environment constant">$IFS</span>
<span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span><span class="token string">$'<span class="token entity" title="\r">\r</span><span class="token entity" title="\n">\n</span>'</span>
<span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable"><span class="token variable">$(</span><span class="token operator">&lt;</span>file_path<span class="token variable">)</span></span><span class="token punctuation">)</span>
<span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span><span class="token variable">$IFS_old</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>以空格为分隔符（tab和换行皆不分割）</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">IFS_old</span><span class="token operator">=</span><span class="token environment constant">$IFS</span>
<span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span><span class="token string">' '</span>
<span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable"><span class="token variable">$(</span><span class="token operator">&lt;</span>file_path<span class="token variable">)</span></span><span class="token punctuation">)</span>
<span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span><span class="token variable">$IFS_old</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>以空白字符为分割（空格、tab、换行皆分割）</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable"><span class="token variable">$(</span><span class="token operator">&lt;</span>file_path<span class="token variable">)</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="遍历数组"><a class="header-anchor" href="#遍历数组"></a>遍历数组</h2>
<h3 id="遍历元素"><a class="header-anchor" href="#遍历元素"></a>遍历元素</h3>
<p>正确写法：以下适用于<code>zsh</code>和<code>bash</code>和<code>sh</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 自定义的数组</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">idx</span> <span class="token keyword">in</span> <span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span>"</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token punctuation">..</span>.
<span class="token keyword">done</span>
<span class="token comment"># 传入函数或文件的参数</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">idx</span> <span class="token keyword">in</span> <span class="token string">"<span class="token variable">$@</span>"</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token punctuation">..</span>.
<span class="token keyword">done</span>

<span class="token comment"># 遍历数组 (1 2 3 4)</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">idx</span> <span class="token keyword">in</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token punctuation">..</span>.
<span class="token keyword">done</span>
<span class="token comment"># 遍通配符路径</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">idx</span> <span class="token keyword">in</span> ./*.zip <span class="token punctuation">..</span>/*<span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token punctuation">..</span>.
<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>错误写法：</p>
<ul>
<li>以下写法，<code>zsh </code> 会正常遍历数组；<code>bash</code> 只遍历到数组首个元素就结束了遍历。</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 自定义的数组</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">idx</span> <span class="token keyword">in</span> <span class="token variable">$array</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token punctuation">..</span>.
<span class="token keyword">done</span>

<span class="token comment"># 传入函数或文件的参数</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">idx</span> <span class="token keyword">in</span> <span class="token variable">$@</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token punctuation">..</span>.
<span class="token keyword">done</span>

<span class="token comment"># 遍历数组 (1 2 3 4)</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">idx</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token punctuation">..</span>.
<span class="token keyword">done</span>

<span class="token comment"># 遍通配符路径</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">idx</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">ls</span> ./*.zip <span class="token punctuation">..</span>/*<span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token comment"># 这样会把 被匹配到的文件夹向下列出一级, 例如</span>
    <span class="token comment"># house.zip  object_vox.zip  object.zip  room.zip  ../suncg_data.zip  texture.zip</span>

    <span class="token comment"># ../suncg_data:</span>
    <span class="token comment"># house  object  object_vox  room  texture</span>

  <span class="token comment"># ../suncg_data_old:</span>
  <span class="token comment"># house  object  object_vox  room  suncg_room_json  suncg_room_obj  texture</span>

  <span class="token comment"># ../suncg_data.zip_extract:</span>
  <span class="token comment"># house.zip  object_vox.zip  object.zip  room.zip  texture.zip</span>
    <span class="token punctuation">..</span>.
<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="遍历编号"><a class="header-anchor" href="#遍历编号"></a>遍历编号</h3>
<p>以下适用于<code>zsh</code>和<code>bash</code>和<code>sh</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> $&#123;#array[@]&#125;<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">))</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">$i</span> <span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span><span class="token operator">:</span>$i<span class="token operator">:</span>1&#125;</span>
    <span class="token comment"># 不要使用 $&#123;array[i]&#125;, bash和sh的是i从0开始，zsh的是从1开始</span>
<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>以下适用于<code>bash</code>和<code>sh</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token string">"&#123;!array[@]&#125;"</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
<span class="token comment"># bash和sh的是i从0开始</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">$i</span> <span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span><span class="token operator">:</span>$i<span class="token operator">:</span>1&#125;</span>
    <span class="token comment"># 或</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">$i</span> <span class="token variable">$&#123;array<span class="token punctuation">[</span>i<span class="token punctuation">]</span>&#125;</span>
<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="命令返回数组"><a class="header-anchor" href="#命令返回数组"></a>命令返回数组</h2>
<h3 id="法一-for-命令-或-命令"><a class="header-anchor" href="#法一-for-命令-或-命令"></a>法一 for + <code>$(命令)</code> 或 <code>`命令`</code></h3>
<ul>
<li>在<code>zsh</code>/<code>bash</code>中返回一个字符串（不论多少行），输入给函数或for，则会自动用空格分割。</li>
<li>而不是返回数组(自带切分，而不是以空格或换行符切分)。</li>
</ul>
<p>例：在一个文件夹下有<code>file1</code> <code>file with space</code> <code>有空格的 中文文件</code>，</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 返回给for</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">ls</span><span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"|<span class="token variable">$i</span>|"</span>
<span class="token keyword">done</span>
<span class="token comment"># 或返回给函数</span>
<span class="token function-name function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token string">"<span class="token variable">$@</span>"</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token builtin class-name">echo</span> <span class="token string">"|<span class="token variable">$i</span>|"</span>
    <span class="token keyword">done</span>
<span class="token punctuation">&#125;</span>
f <span class="token variable"><span class="token variable">$(</span><span class="token function">ls</span><span class="token variable">)</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>在bash下返回</p>
<blockquote>
<p>|file1|</p>
<p>| file with space|</p>
<p>|有空格的 中文文件|</p>
</blockquote>
<p>在zsh/bash下返回</p>
<blockquote>
<p>|file1|<br>
|file|<br>
|with|<br>
|space|<br>
|有空格的|<br>
|中文文件|</p>
</blockquote>
<ul>
<li>
<p>解决办法：将<code>命令</code>结果分行返回( 如<code>ls -1</code> 一个文件返回一行)，然后设置<code>IFS=$'\n'</code> ，则返回给<code>for</code>或<code>函数</code>的均是数组</p>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">hadopt</span><span class="token operator">=</span>false
<span class="token punctuation">[</span> -n <span class="token string">"<span class="token variable">$ZSH_VERSION</span>"</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span>setopt <span class="token operator">|</span> <span class="token function">grep</span> shwordsplit<span class="token variable">)</span></span>"</span> <span class="token operator">!=</span> <span class="token string">''</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
    <span class="token assign-left variable">hadopt</span><span class="token operator">=</span>true <span class="token operator">&amp;&amp;</span> setopt sh_word_split <span class="token comment"># 若为 zsh则开sh_word_split选项</span>
<span class="token assign-left variable">OLD_IFS</span><span class="token operator">=</span><span class="token string">"<span class="token environment constant">$IFS</span>"</span><span class="token punctuation">;</span> <span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span><span class="token string">$'<span class="token entity" title="\n">\n</span>'</span>
<span class="token comment"># ---</span>
<span class="token comment"># 返回给for</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">ls</span> -1<span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"|<span class="token variable">$i</span>|"</span>
<span class="token keyword">done</span>
<span class="token comment"># 或返回给函数</span>
f <span class="token variable"><span class="token variable">$(</span><span class="token function">ls</span><span class="token variable">)</span></span>
<span class="token comment"># ---</span>
<span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span><span class="token string">"<span class="token variable">$OLD_IFS</span>"</span>
<span class="token punctuation">[</span> -n <span class="token string">"<span class="token variable">$ZSH_VERSION</span>"</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$hadopt</span>"</span> <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> unsetopt sh_word_split <span class="token comment"># 若原先没开此选项则关之</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">
    结果

    &gt; |file1|
    &gt;
    &gt; | file with space|
    &gt;
    &gt; |有空格的 中文文件|

## 数组传入传出函数

以下适用于zsh和bash

### 法一 &#96;传入&quot;$&#123;array[@]&#125;&quot;&#96;

以下适用于zsh和bash，向文件或函数传入数组

**传入数组**

写法：

* 传入一个数组

​&#96;&#96;&#96;bash
zsh&#x2F;bash 文件.sh &quot;$&#123;array[@]&#125;&quot;
zsh&#x2F;bash  文件.sh &quot;$@&quot;
func &quot;$&#123;array[@]&#125;&quot;
func &quot;$@&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>传入多个数组(以函数为例，其余同理成立)</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">func <span class="token string">"string1"</span> <span class="token string">"<span class="token variable">$&#123;array1<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span>"</span> <span class="token string">"string2"</span> <span class="token string">"<span class="token variable">$&#123;array2<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span>"</span> <span class="token string">"string3"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>“${array[@]}” <strong>必需得加引号</strong>，若不加引号，则会如下出错：</p>
<p>file.zsh内容为</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token string">"<span class="token variable">$@</span>"</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"|<span class="token variable">$i</span>|"</span>
<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>而在bash中运行函数</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function-name function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token function">zsh</span> file.sh <span class="token variable">$@</span> <span class="token punctuation">&#125;</span>
f asdas <span class="token string">'qwe qweasd'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>会输出</p>
<blockquote>
<p>|asdas|</p>
<p>|qwe|</p>
<p>|qweasd|</p>
</blockquote>
<p><strong>例子</strong></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function-name function">get_array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token builtin class-name">local</span> <span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">"<span class="token variable">$@</span>"</span><span class="token punctuation">)</span> <span class="token comment"># 把传入变成数组</span>
  <span class="token builtin class-name">declare</span> -p array <span class="token comment"># 检测</span>
<span class="token punctuation">&#125;</span>
<span class="token function-name function">go_through_arg</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">idx</span> <span class="token keyword">in</span> <span class="token string">"<span class="token variable">$@</span>"</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token comment"># 遍历输入，若输入有 `go_through_arg 'sad asd' 'asd' adasd`</span>
    <span class="token comment"># bash 中不支持 写作 $@，$*，"$*"</span>
    <span class="token comment"># zsh 中不支持写作 "$*"，但支持写作$@，$*</span>
    <span class="token comment"># zsh和bash 仅 "$@"通用，可输出三行，分别是'sad asd'，'asd'， 'adasd'</span>
        <span class="token builtin class-name">echo</span> <span class="token string">"|<span class="token variable">$idx</span>|"</span>
    <span class="token keyword">done</span>
<span class="token punctuation">&#125;</span>
<span class="token function-name function">argparse</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token builtin class-name">echo</span> <span class="token string">"|<span class="token variable">$1</span>|"</span>
        <span class="token builtin class-name">echo</span> <span class="token string">"|<span class="token variable">$2</span>|"</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"|<span class="token variable">$3</span>|"</span>
<span class="token punctuation">&#125;</span>

<span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">"a"</span> <span class="token string">"b asd"</span> <span class="token string">"c<span class="token entity" title="\n">\n</span>asd
asdsa"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>传参写法</strong></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">get_array <span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span>"</span> <span class="token comment"># 传入数组</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">typeset -a array&#x3D;( a &#39;b asd&#39; &#39;c\nasd\nasdsa&#39; )<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">go_through_arg <span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span>"</span> <span class="token comment"># 传入数组</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">|a|
|b asd|
|c
asd
asdsa|<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">argparse <span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span>"</span> <span class="token comment"># 传入数组</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">|a|
|b asd|
|c
asd
asdsa|<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h3 id="法二-用declare-p-array作为表示"><a class="header-anchor" href="#法二-用declare-p-array作为表示"></a>法二 用<code>declare -p array</code>作为表示</h3>
<p>以下适用于zsh和bash</p>
<p>缺点：依赖于zsh的版本的操作系统</p>
<p><strong>传出数组</strong></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function-name function">make_array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token builtin class-name">local</span> array
  <span class="token builtin class-name">declare</span> -a array
  <span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'a'</span> <span class="token string">'b asd'</span> <span class="token string">'c\nasd\nasds
  asdas'</span><span class="token punctuation">)</span>
  <span class="token builtin class-name">echo</span> -E <span class="token variable">$&#123;"$(declare -p array )"<span class="token operator">#</span>*=&#125;</span> <span class="token comment">#</span>
<span class="token punctuation">&#125;</span>
make_array<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>mac zsh 5.7.1 (x86_64-apple-darwin18.2.0) 返回，不能使用本法</p>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">( a &#39;b asd&#39; &#39;c\nasd\nasdsa&#39; )<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<p>Linux zsh 5.4.2 (x86_64-ubuntu-linux-gnu)返回 ，能使用本法</p>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">( a &#39;b asd&#39; $&#39;c\\nasd\\nasds\n  asdas&#39; )<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<p>Linux zsh 5.0.5 (x86_64-pc-linux-gnu) 返回 ，能使用本法</p>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">(a &#39;b asd&#39; &#39;c\nasd\nasds
asdas&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</blockquote>
<p><strong>传入数组</strong></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function-name function">get_array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token builtin class-name">local</span> getton_array
    <span class="token builtin class-name">declare</span> -a getton_array
  <span class="token builtin class-name">eval</span> <span class="token string">"getton_array="</span><span class="token variable">$1</span> <span class="token comment"># get array</span>
  <span class="token builtin class-name">declare</span> -p getton_array
<span class="token punctuation">&#125;</span>
get_array <span class="token string">"<span class="token variable"><span class="token variable">$(</span>make_array<span class="token variable">)</span></span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>mac zsh 5.7.1 (x86_64-apple-darwin18.2.0) 返回，不能使用本法</p>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">typeset -a getton_array&#x3D;( a &#39;b asd&#39; $&#39;c\nasd\nasds\n  asdas&#39; )<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<p>Linux zsh 5.4.2 (x86_64-ubuntu-linux-gnu)返回 ，能使用本法</p>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">typeset -a getton_array&#x3D;( a &#39;b asd&#39; $&#39;c\\nasd\\nasds\n  asdas&#39; )<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<p>Linux zsh 5.0.5 (x86_64-pc-linux-gnu) 返回 ，能使用本法</p>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">typeset -a getton_array
getton_array&#x3D;(a &#39;b asd&#39; &#39;c\nasd\nasds
asdas&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h3 id="法三-修改分隔符"><a class="header-anchor" href="#法三-修改分隔符"></a>法三 修改分隔符</h3>
<p>以下适用于zsh和bash</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function-name function">a2s</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin class-name">local</span> <span class="token assign-left variable">string</span><span class="token operator">=</span><span class="token string">''</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$#</span> -ne <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">string</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$1</span>"</span>
        <span class="token builtin class-name">shift</span>
    <span class="token keyword">fi</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token string">"<span class="token variable">$@</span>"</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token assign-left variable">string</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$string</span>䴅<span class="token variable">$i</span>"</span> <span class="token comment"># 可以用任意字符，但只能是单个字符，故选用冷门汉字</span>
    <span class="token keyword">done</span>
  <span class="token builtin class-name">echo</span> -E <span class="token string">"<span class="token variable">$string</span>"</span>
<span class="token punctuation">&#125;</span>
<span class="token function-name function">make_array</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin class-name">local</span> array
  <span class="token builtin class-name">declare</span> -a array
  <span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'a'</span> <span class="token string">'b asd'</span> <span class="token string">'c\nasd\nasdss
  asdas'</span><span class="token punctuation">)</span>
  a2s <span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span>"</span>
  <span class="token comment"># echo -E "$(a2s \"$&#123;array[@]&#125;\")"</span>
<span class="token punctuation">&#125;</span>
make_array<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>返回</p>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">a䴅b asd䴅c\nasd\nasdss
asdas<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function-name function">get_array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  <span class="token builtin class-name">local</span> <span class="token assign-left variable">str</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$1</span>"</span>
  <span class="token builtin class-name">local</span> <span class="token assign-left variable">OLD_IFS</span><span class="token operator">=</span><span class="token environment constant">$IFS</span>
  <span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span><span class="token string">'䴅'</span>
  <span class="token builtin class-name">local</span> <span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> -E <span class="token string">"<span class="token variable">$str</span>"</span><span class="token variable">)</span></span><span class="token punctuation">)</span>
  <span class="token comment"># local array=($str)</span>
  <span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span><span class="token variable">$OLD_IFS</span>
  <span class="token builtin class-name">declare</span> -p array
<span class="token punctuation">&#125;</span>
get_array <span class="token string">"<span class="token variable"><span class="token variable">$(</span>make_array<span class="token variable">)</span></span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>返回</p>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">typeset -a array
array&#x3D;( &#39;c\nasd\nasdss
asdas&#39; )<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h2 id="引用传参——在函数中修改参数"><a class="header-anchor" href="#引用传参——在函数中修改参数"></a>引用传参——在函数中修改参数</h2>
<p>适用于 zsh  与 bash</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function-name function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token builtin class-name">local</span> <span class="token assign-left variable">a_</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$1</span>"</span>
  <span class="token builtin class-name">eval</span> <span class="token variable">$a_</span><span class="token operator">=</span><span class="token string">'asdsad'</span> <span class="token comment"># 注意，这里的`a_`不要和传入`f`的值`a`重名</span>
<span class="token punctuation">&#125;</span>
<span class="token comment"># 或</span>
<span class="token function-name function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token builtin class-name">eval</span> <span class="token variable">$1</span><span class="token operator">=</span><span class="token string">'asdsad'</span>
<span class="token punctuation">&#125;</span>
<span class="token comment"># 或</span>
<span class="token function-name function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token builtin class-name">local</span> <span class="token assign-left variable">a_</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$1</span>"</span>
  <span class="token builtin class-name">local</span> <span class="token assign-left variable">c</span><span class="token operator">=</span><span class="token string">'asdsad'</span>
  <span class="token builtin class-name">eval</span> <span class="token variable">$a_</span><span class="token operator">=</span><span class="token punctuation">\</span>"<span class="token punctuation">\</span><span class="token variable">$c</span><span class="token punctuation">\</span>"
<span class="token punctuation">&#125;</span>
<span class="token comment"># 或</span>
<span class="token function-name function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token builtin class-name">local</span> <span class="token assign-left variable">c</span><span class="token operator">=</span><span class="token string">'asdsad'</span>
  <span class="token builtin class-name">eval</span> <span class="token variable">$1</span><span class="token operator">=</span><span class="token punctuation">\</span>"<span class="token punctuation">\</span><span class="token variable">$c</span><span class="token punctuation">\</span>"
<span class="token punctuation">&#125;</span>
<span class="token comment"># 而后</span>
<span class="token function-name function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token builtin class-name">local</span> <span class="token assign-left variable">a</span><span class="token operator">=</span><span class="token number">123</span>
  f a <span class="token comment"># 注意，这里的`a`不要和`f`中的`a_`重名</span>
  <span class="token builtin class-name">echo</span> <span class="token variable">$a</span>
<span class="token punctuation">&#125;</span>
<span class="token builtin class-name">test</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<pre class="line-numbers language-none"><code class="language-none">asdsad<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<p>其原理是<code>eval $a_=\&quot;\$c\&quot;</code> 等价于执行了<code>a=&quot;$c&quot;</code></p>
<h2 id="运行数组"><a class="header-anchor" href="#运行数组"></a>运行数组</h2>
<h3 id="错误的做法"><a class="header-anchor" href="#错误的做法"></a>错误的做法</h3>
<ul>
<li>
<p>方法一</p>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">eval</span> <span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span>"</span>  <span class="token comment"># 即等价于 python 中的 sys.command(' '.join(array))</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li>这样会把含有空白字符的字符串拆开</li>
</ul>
</li>
<li>
<p>方法二</p>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li>当array的第一个元素不是终端的命令时（如第一个元素为<code>CUDA_VISIBLE_DEVICES=1</code>），则无法执行</li>
<li>当array中有元素等于<code>|</code>、<code>;</code>、<code>&#123;</code>，<code>&#125; </code> <code>&amp;&amp;</code> <code>||</code>等时，也无法执行</li>
</ul>
</li>
</ul>
<h3 id="正确的做法"><a class="header-anchor" href="#正确的做法"></a>正确的做法</h3>
<p>本方法可以克服上述法一、二的所有问题</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function-name function">evalarray</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$#</span> -eq <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token comment"># 若array仅一个元素，则直接 sys.command(array[0])</span>
        <span class="token builtin class-name">eval</span> <span class="token string">"<span class="token variable">$1</span>"</span>
    <span class="token keyword">else</span>
        <span class="token comment"># 否则 sys.command( ' '.join([</span>
        <span class="token comment">#	x.replace("'", "'\''")</span>
        <span class="token comment">#    if ' ' in x or  '\n' in x or  '\t' in x</span>
        <span class="token comment">#    else x</span>
        <span class="token comment">#    for x in array]</span>
        <span class="token comment"># ) )</span>
        <span class="token builtin class-name">local</span> <span class="token assign-left variable">processedarray</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> <span class="token for-or-select variable">arg</span> <span class="token keyword">in</span> <span class="token string">"<span class="token variable">$@</span>"</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
            <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$arg</span>"</span> <span class="token operator">=~</span> <span class="token string">' '</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$arg</span>"</span> <span class="token operator">=~</span> <span class="token string">$'<span class="token entity" title="\t">\t</span>'</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">||</span>  <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$arg</span>"</span> <span class="token operator">=~</span> <span class="token string">$'<span class="token entity" title="\n">\n</span>'</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                <span class="token comment"># 若arg中有空白字符，则arg两端加',arg中间的</span><span class="token string">'改为'</span><span class="token punctuation">\</span>'<span class="token string">'
                processedarray+=("'</span><span class="token variable">$&#123;arg<span class="token operator">/</span><span class="token operator">/</span>'<span class="token operator">/</span>'\\''&#125;</span>'<span class="token string">")
            else
                processedarray+=("</span><span class="token variable">$&#123;arg&#125;</span><span class="token string">")
            fi
        done
        eval "</span><span class="token variable">$processedarray</span><span class="token punctuation">[</span>@<span class="token punctuation">]</span>"
    <span class="token keyword">fi</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>使用</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">evalarray <span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>例如：</p>
<ul>
<li>用法一：所有命令和参数均分开写。当参数含有空白字符和特殊运算连接符（<code>|</code>、<code>;</code>、<code>&#123;</code>，<code>&#125; </code> <code>&amp;&amp;</code> <code>||</code>等）时，才用括号括起来。</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span>touch <span class="token string">'文件名 有空格'</span> <span class="token string">'&amp;&amp;'</span> <span class="token function">ls</span> <span class="token punctuation">..</span> <span class="token string">'|'</span>  <span class="token function">grep</span> a<span class="token punctuation">)</span>
evalarray <span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span>"</span>
<span class="token comment"># 或</span>
evalarray <span class="token function">touch</span> <span class="token string">'文件名 有空格'</span> <span class="token string">'&amp;&amp;'</span> <span class="token function">ls</span> <span class="token punctuation">..</span> <span class="token string">'|'</span>  <span class="token function">grep</span> a
evalarray <span class="token function">touch</span> 文件名<span class="token punctuation">\</span> 有空格 <span class="token string">'&amp;&amp;'</span> <span class="token function">ls</span> <span class="token punctuation">..</span> <span class="token string">'|'</span>  <span class="token function">grep</span> a<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>用法二：所有命令和参数写在一个字符串中</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'touch 文件名\ 有空格 &amp;&amp; ls .. |  grep a'</span><span class="token punctuation">)</span>
evalarray <span class="token string">"<span class="token variable">$&#123;array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>&#125;</span>"</span>
<span class="token comment"># 或</span>
evalarray <span class="token string">'touch 文件名\ 有空格 &amp;&amp; ls .. |  grep a'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>注意，用法一二不能混着写，例如，</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">evalarray <span class="token function">touch</span> <span class="token string">'文件名 有空格'</span> <span class="token string">'&amp;&amp;'</span> <span class="token function">ls</span> <span class="token punctuation">..</span> <span class="token string">'|'</span>  <span class="token string">'grep a'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>这样不行，运行时会把’grep a’当成一个终端命令，故而报错</p>
<pre class="line-numbers language-none"><code class="language-none">(eval):1: command not found: grep a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h1 id="输出表格"><a class="header-anchor" href="#输出表格"></a>输出表格</h1>
<h3 id="column-命令"><a class="header-anchor" href="#column-命令"></a><code>column</code> 命令</h3>
<p><code>代码块 | column -t -s 分割字符的集合</code> 即能输出表格, 使得各列左对齐</p>
<ul>
<li>
<p>例1: 单个分隔字符:</p>
<p>注意必需写成<code>$'\t’</code> 才会转义成制表符, 用它分隔列; 写成<code>&quot;\t</code>”  <code>'\t’</code> 均不转义, 而是用<code>\</code> 与 <code>t</code> 这两个字符分列</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">'Name\tScore
-----\t-----
Somebody with a very long name\t100
ShortNmae\t1231981738184788381413131
Ann\t
    \tnana'</span> <span class="token operator">|</span> <span class="token function">column</span> -t -s <span class="token string">$'<span class="token entity" title="\t">\t</span>'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出</p>
<pre class="line-numbers language-none"><code class="language-none">Name                            Score
-----                           -----
Somebody with a very long name  100
ShortNmae                       1231981738184788381413131
Ann
                                nana<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li>
<p>例2: 多个分隔字符</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">'Name|Score\n-----|-----
Somebody with a very long name\t100
ShortNmae\t1231981738184788381413131
Ann|
    |nana'</span> <span class="token operator">|</span> <span class="token function">column</span> -t -s <span class="token string">$'<span class="token entity" title="\t">\t</span>|'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出同例1</p>
</li>
</ul>
<h2 id="sudo执行"><a class="header-anchor" href="#sudo执行"></a>sudo执行</h2>
<h3 id="sudo执行非sudo的函数"><a class="header-anchor" href="#sudo执行非sudo的函数"></a>sudo执行非sudo的函数</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">bash</span> -c <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">declare</span> -f <span class="token operator">&lt;</span>非sodu的函数名<span class="token operator">></span><span class="token variable">)</span></span>; &lt;非sodu的函数名>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="sudo执行代码段"><a class="header-anchor" href="#sudo执行代码段"></a>sudo执行代码段</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">bash</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
代码段
EOF</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="sudo执行文件"><a class="header-anchor" href="#sudo执行文件"></a>sudo执行文件</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">bash</span> <span class="token operator">&lt;</span>文件路径<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/e303a4a3/" rel="prev" title="bash设置">
                  <i class="fa fa-chevron-left"></i> bash设置
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/posts/6f7822e5/" rel="next" title="mac的移动硬盘分区方案">
                  mac的移动硬盘分区方案 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline-comments"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">∞亼</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">370k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">20:32</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"all","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://waline-hyliang96.vercel.app","placeholder":"Jヾﾉ≧∀≦)o来啊，快活啊!","avatar":"mp","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":["nick","mail"],"libUrl":"https://cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js","el":"#waline-comments","path":"/posts/Infinity/"}</script>
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() => 
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => {
    new Waline(CONFIG.waline);
  });
});
</script>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300,"hOffset":-25,"vOffset":-60},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
