<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon16.png">
  <link rel="mask-icon" href="/images/favicon.svg" color="#222">
  <meta name="google-site-verification" content="VYSqFXy4SdSulNvauNz8l6z0WDUa1-t62R0hKya9Xmw">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"hyliang96.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.8.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>
<meta name="description" content="参考：Ipmitool工具的使用方式 ipmi带外管理 IPMI介绍 需求">
<meta property="og:type" content="article">
<meta property="og:title" content="IPMI带外管理教程">
<meta property="og:url" content="https://hyliang96.github.io/posts/85a6419c/index.html">
<meta property="og:site_name" content="丹炉志">
<meta property="og:description" content="参考：Ipmitool工具的使用方式 ipmi带外管理 IPMI介绍 需求">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hyliang96.github.io/posts/85a6419c/ScreenShot%202019-12-19%2023.54.27.png">
<meta property="og:image" content="https://hyliang96.github.io/posts/85a6419c/image-20200206175520485.png">
<meta property="og:image" content="https://hyliang96.github.io/posts/85a6419c/image-20200206175801169.png">
<meta property="og:image" content="https://hyliang96.github.io/posts/85a6419c/ScreenShot%202020-02-06%2018.22.03.png">
<meta property="og:image" content="https://hyliang96.github.io/posts/85a6419c/image-20200206180245990.png">
<meta property="og:image" content="https://hyliang96.github.io/posts/85a6419c/image-20200206182014080.png">
<meta property="og:image" content="https://hyliang96.github.io/posts/85a6419c/ScreenShot%202020-02-06%2018.24.37.png">
<meta property="og:image" content="https://hyliang96.github.io/posts/85a6419c/ScreenShot%202020-02-06%2018.24.40.png">
<meta property="og:image" content="https://hyliang96.github.io/posts/85a6419c/ScreenShot%202020-02-06%2018.25.07.png">
<meta property="og:image" content="https://hyliang96.github.io/posts/85a6419c/image-20200206211639722.png">
<meta property="og:image" content="https://hyliang96.github.io/posts/85a6419c/mceclip1.png">
<meta property="og:image" content="https://hyliang96.github.io/posts/85a6419c/mceclip2.png">
<meta property="og:image" content="https://hyliang96.github.io/posts/85a6419c/Configuration-SSL-Certification-Menu.png">
<meta property="og:image" content="https://hyliang96.github.io/posts/85a6419c/image-20201119231400452.png">
<meta property="article:published_time" content="2021-07-30T13:17:59.000Z">
<meta property="article:modified_time" content="2023-07-22T14:47:29.204Z">
<meta property="article:author" content="∞亼">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hyliang96.github.io/posts/85a6419c/ScreenShot%202019-12-19%2023.54.27.png">


<link rel="canonical" href="https://hyliang96.github.io/posts/85a6419c/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://hyliang96.github.io/posts/85a6419c/","path":"posts/85a6419c/","title":"IPMI带外管理教程"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>IPMI带外管理教程 | 丹炉志</title>
  



<link rel="dns-prefetch" href="https://waline-hyliang96.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">丹炉志</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">深度学习及其运维日志</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>概览</a></li>
        <li class="menu-item menu-item-tools"><a href="/categories/%E5%99%A8/" rel="section"><i class="fa fa-wrench fa-fw"></i>器</a></li>
        <li class="menu-item menu-item-academics"><a href="/categories/%E6%9C%AF/" rel="section"><i class="fa fa-book fa-fw"></i>术</a></li>
        <li class="menu-item menu-item-philosophy"><a href="/categories/%E9%81%93/" rel="section"><i class="fas fa-circle-notch fa-fw"></i>道</a></li>
        <li class="menu-item menu-item-book"><a href="/categories/%E4%B9%A6%E7%B1%8D/" rel="section"><i class="fa fa-bookmark fa-fw"></i>书</a></li>
        <li class="menu-item menu-item-movie"><a href="/categories/%E5%BD%B1/" rel="section"><i class="fa fa-film fa-fw"></i>影</a></li>
        <li class="menu-item menu-item-photo"><a href="/categories/%E7%85%A7%E7%89%87/" rel="section"><i class="fas fa-photo-video fa-fw"></i>相</a></li>
        <li class="menu-item menu-item-essay"><a href="/categories/%E9%9A%8F%E7%AC%94/" rel="section"><i class="fas fa-edit fa-fw"></i>杂谈</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#IPMI%E4%BB%8B%E7%BB%8D"><span class="nav-text">IPMI介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9C%80%E6%B1%82"><span class="nav-text">需求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%A6%E5%A4%96%E7%AE%A1%E7%90%86"><span class="nav-text">带外管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IPMI%E7%9A%84%E5%8E%9F%E7%90%86"><span class="nav-text">IPMI的原理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEIPMI"><span class="nav-text">配置IPMI</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85ipmitool"><span class="nav-text">安装ipmitool</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ipmi%E7%9A%84%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE"><span class="nav-text">ipmi的网络配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEimp%E8%B4%A6%E5%8F%B7"><span class="nav-text">配置imp账号</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%BA%BF%E8%B7%AF%E4%B8%8E%E7%AE%A1%E7%90%86%E7%BA%BF%E8%B7%AF"><span class="nav-text">数据线路与管理线路</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%BF%E8%B7%AF%E8%BF%9E%E6%8E%A5"><span class="nav-text">线路连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ip%E8%AE%BE%E7%BD%AE"><span class="nav-text">ip设置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NAT"><span class="nav-text">NAT</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ipmi%E5%90%84%E7%A7%8D%E8%BF%9E%E6%8E%A5%E7%AB%AF%E5%8F%A3"><span class="nav-text">ipmi各种连接端口</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%8E%E5%A4%96%E9%83%A8%E8%BF%9E%E6%8E%A5ipmi"><span class="nav-text">从外部连接ipmi</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8"><span class="nav-text">浏览器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A1%8C%E9%9D%A2%E8%BF%9C%E7%A8%8B%E6%93%8D%E6%8E%A7"><span class="nav-text">桌面远程操控</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%ADiKVM-HTML5"><span class="nav-text">浏览器中iKVM&#x2F;HTML5</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8Java-iKVM-Viewer"><span class="nav-text">使用Java iKVM Viewer</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8E%B7%E5%BE%97jnlp%E6%96%87%E4%BB%B6"><span class="nav-text">获得jnlp文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E4%BF%AE%E6%94%B9"><span class="nav-text">端口修改</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5"><span class="nav-text">启动远程连接</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%88%E7%AB%AF"><span class="nav-text">终端</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E6%A0%BC%E5%BC%8F"><span class="nav-text">命令格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E7%9A%84-ipmi%E7%9A%84%E5%91%BD%E4%BB%A4"><span class="nav-text">常用的&lt;ipmi的命令&gt;</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%AD%BB%E6%9C%BA%E5%A4%84%E7%BD%AE%E5%8A%9E%E6%B3%95"><span class="nav-text">服务器死机处置办法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8%E6%B5%8F%E8%A7%88%E5%99%A8%E9%87%8D%E5%90%AF"><span class="nav-text">用浏览器重启</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8%E5%91%BD%E4%BB%A4%E9%87%8D%E5%90%AF"><span class="nav-text">用命令重启</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6%E5%BC%80%E6%9C%BA%E7%95%8C%E9%9D%A2"><span class="nav-text">远程控制开机界面</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9C%8B%E9%97%A8%E7%8B%97%E5%AE%89%E8%A3%85"><span class="nav-text">看门狗安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9C%8B%E9%97%A8%E7%8B%97%E5%8E%9F%E7%90%86"><span class="nav-text">看门狗原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE%E6%96%B9%E6%B3%95-%E6%89%8B%E5%8A%A8%E6%89%A7%E8%A1%8C"><span class="nav-text">安装配置方法 手动执行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E4%B8%8E%E6%B5%8B%E8%AF%95%E8%84%9A%E6%9C%AC"><span class="nav-text">安装与测试脚本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%96%E6%B6%88%E7%9C%8B%E9%97%A8%E7%8B%97"><span class="nav-text">取消看门狗</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B2%A1%E6%9C%89reset%E6%8C%81%E7%BB%AD%E5%80%92%E8%AE%A1%E6%97%B6-%E6%8A%A2%E6%95%91%E6%96%B9%E6%B3%95"><span class="nav-text">没有reset持续倒计时 - 抢救方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9C%8B%E9%97%A8%E7%8B%97%E7%9A%84%E5%BC%80%E5%85%B3"><span class="nav-text">看门狗的开关</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9C%8B%E9%97%A8%E7%8B%97%E8%A1%8C%E4%B8%BA%E8%AE%BE%E7%BD%AE"><span class="nav-text">看门狗行为设置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#https%E4%B8%8D%E5%AE%89%E5%85%A8-SSL%E8%AF%81%E4%B9%A6%E8%BF%87%E6%9C%9F"><span class="nav-text">https不安全-SSL证书过期</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%B7%BB%E5%8A%A0%E8%87%AA%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6"><span class="nav-text">服务器端添加自签名证书</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E7%AB%AF%E8%AE%BE%E7%BD%AE"><span class="nav-text">浏览器端设置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8A%8A%E5%88%9A%E6%89%8D%E7%9A%84%E8%AF%81%E4%B9%A6%E6%B7%BB%E5%8A%A0%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%9A%84%E9%92%A5%E5%8C%99%E4%B8%B2"><span class="nav-text">把刚才的证书添加到本地的钥匙串</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E6%B5%8F%E8%A7%88%E5%99%A8%E5%85%81%E8%AE%B8%E8%AE%BF%E9%97%AE%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84localhost"><span class="nav-text">设置浏览器允许访问不安全的localhost</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="nav-text">其他参考资料</span></a></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="∞亼"
      src="/images/heat.jpg">
  <p class="site-author-name" itemprop="name">∞亼</p>
  <div class="site-description" itemprop="description">一切节约归根到底是时间的节约</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">82</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/hyliang96" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hyliang96" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hyliang96@gmail.com" title="E-Mail → mailto:hyliang96@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

  <a href="https://github.com/hyliang96" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hyliang96.github.io/posts/85a6419c/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/heat.jpg">
      <meta itemprop="name" content="∞亼">
      <meta itemprop="description" content="一切节约归根到底是时间的节约">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="丹炉志">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          IPMI带外管理教程
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-07-30 21:17:59" itemprop="dateCreated datePublished" datetime="2021-07-30T21:17:59+08:00">2021-07-30</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2023-07-22 22:47:29" itemprop="dateModified" datetime="2023-07-22T22:47:29+08:00">2023-07-22</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%99%A8/" itemprop="url" rel="index"><span itemprop="name">器</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%99%A8/%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%9E%E6%8E%A5/" itemprop="url" rel="index"><span itemprop="name">服务器连接</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/posts/85a6419c/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/posts/85a6419c/" data-xid="/posts/85a6419c/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>15k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>49 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>参考：<a target="_blank" rel="noopener" href="https://xiaoyeshiyu.github.io/linux/2017/12/11/IPMITool/">Ipmitool工具的使用方式</a> <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/50bec5e2f96e">ipmi带外管理</a></p>
<h2 id="IPMI介绍"><a class="header-anchor" href="#IPMI介绍"></a>IPMI介绍</h2>
<h3 id="需求"><a class="header-anchor" href="#需求"></a>需求</h3>
<p>有的时候，ssh无法连接到服务器，如</p>
<ul>
<li>死机，需要重启</li>
<li>服务器的临时路由表配错，造成ssh无法访问服务器，需要重启</li>
</ul>
<p>类似情况，为了能不亲自去机房就管理服务器，需要使用远程控制装置，也即带外管理，IPMI即是其中一种。</p>
<h3 id="带外管理"><a class="header-anchor" href="#带外管理"></a>带外管理</h3>
<ul>
<li>经过服务器所在的工作网络 来连接服务器（如通过ssh），此通道名曰数据通道。由数据通道理服务器，称带内管理。当服务器或工作网络出现物理故障时，就无法带内管理。</li>
<li>使用独立的管理通道连接服务器，不论开机与否，也不论工作网络是否正常，均可进行连接与控制。由管理通道管理服务器，称带外管理。</li>
</ul>
<h3 id="IPMI的原理"><a class="header-anchor" href="#IPMI的原理"></a>IPMI的原理</h3>
<p>IPMI 独立于 CPU BIOS 和 操作系统，故不论开机否，皆可监视控制服务器。ipmi 是一种规范的标准，其中最重要的物理部件就是 BMC (Baseboard Management Controller)，一种嵌入式管理微控制器，它相当于整个平台管理的“大脑”，通过它 ipmi 可以监控各个传感器的数据并记录各种事件的日志。</p>
<p>引自：<a target="_blank" rel="noopener" href="https://xiaoyeshiyu.github.io/linux/2017/12/11/IPMITool/">Ipmitool工具的使用方式</a></p>
<h2 id="配置IPMI"><a class="header-anchor" href="#配置IPMI"></a>配置IPMI</h2>
<p>有两种方法配置IPMI：进入BIOS或使用impitool软件。进入BIOS配置IMPI，详见<a href="./IPMI%E8%BF%9C%E7%A8%8B%E7%AE%A1%E7%90%86%E5%8A%9F%E8%83%BD%E4%BD%BF%E7%94%A8%E4%BB%8B%E7%BB%8D.docx">IPMI远程管理功能使用介绍.docx</a>。而impitool方法介绍如下，以下操作均在服务器上，用ssh连接之即可完成</p>
<h3 id="安装ipmitool"><a class="header-anchor" href="#安装ipmitool"></a>安装ipmitool</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> ipmitool<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="ipmi的网络配置"><a class="header-anchor" href="#ipmi的网络配置"></a>ipmi的网络配置</h3>
<p>显示ipmi的网络配置</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ipmitool lan print <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>返回</p>
<pre class="line-numbers language-none"><code class="language-none">Set in Progress         : Set Complete
Auth Type Support       : NONE MD2 MD5 PASSWORD
Auth Type Enable        : Callback : MD2 MD5 PASSWORD
                        : User     : MD2 MD5 PASSWORD
                        : Operator : MD2 MD5 PASSWORD
                        : Admin    : MD2 MD5 PASSWORD
                        : OEM      : MD2 MD5 PASSWORD
IP Address Source       : Static Address
IP Address              : 192.168.245.33
Subnet Mask             : 255.255.255.0
MAC Address             : ac:1f:6b:a7:0b:39
SNMP Community String   : public
IP Header               : TTL&#x3D;0x00 Flags&#x3D;0x00 Precedence&#x3D;0x00 TOS&#x3D;0x00
BMC ARP Control         : ARP Responses Enabled, Gratuitous ARP Disabled
Default Gateway IP      : 192.168.245.97
Default Gateway MAC     : 00:00:00:00:00:00
Backup Gateway IP       : 0.0.0.0
Backup Gateway MAC      : 00:00:00:00:00:00
802.1q VLAN ID          : Disabled
802.1q VLAN Priority    : 0
RMCP+ Cipher Suites     : 1,2,3,6,7,8,11,12
Cipher Suite Priv Max   : XaaaXXaaaXXaaXX
                        :     X&#x3D;Cipher Suite Unused
                        :     c&#x3D;CALLBACK
                        :     u&#x3D;USER
                        :     o&#x3D;OPERATOR
                        :     a&#x3D;ADMIN
                        :     O&#x3D;OEM
Bad Password Threshold  : 0
Invalid password disable: no
Attempt Count Reset Int.: 0
User Lockout Interval   : 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>IPMI的网络有两模式：</p>
<ul>
<li>
<p>自动获取（dhcp），设置方法如下：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ipmitool lan <span class="token builtin class-name">set</span> <span class="token number">1</span> ipsrc dhcp<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>它会自动获取到ipmi的ip、掩码、网关</p>
</li>
<li>
<p>静态（static），设置方法如下</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ipmitool lan <span class="token builtin class-name">set</span> <span class="token number">1</span> ipsrc static<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>需要自己配ipmi的ip、掩码、网关</p>
</li>
<li>
<p>设置ipmi的ip</p>
</li>
</ul>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ipmitool lan <span class="token builtin class-name">set</span> <span class="token number">1</span> ipaddr <span class="token operator">&lt;</span>ipmi的ip<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li>设置ipmi的掩码</li>
</ul>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ipmitool lan <span class="token builtin class-name">set</span> <span class="token number">1</span> netmask <span class="token operator">&lt;</span>ipmi的掩码<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li>设置ipmi的网关</li>
</ul>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ipmitool lan <span class="token builtin class-name">set</span> <span class="token number">1</span> defgw ipaddr <span class="token operator">&lt;</span>ipmi的网关<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="配置imp账号"><a class="header-anchor" href="#配置imp账号"></a>配置imp账号</h3>
<ul>
<li>
<p>查看通道</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ipmitool channel info <span class="token punctuation">[</span><span class="token operator">&lt;</span>通道号<span class="token operator">>=</span><span class="token operator">=</span><span class="token number">0,1</span>,2,3<span class="token punctuation">..</span>.,12, 无13, <span class="token number">14,15</span><span class="token punctuation">;</span> 缺省<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>一般 15号通道返回, 表示支持网页图形界面控制, 此通道的用户需要开<code>ipmi=on</code>权限, 才能用网页远程控制</p>
<pre class="line-numbers language-none"><code class="language-none">Channel 0xf info:
  Channel Medium Type   : System Interface
  Channel Protocol Type : KCS
  Session Support       : session-less
  Active Session Count  : 0
  Protocol Vendor ID    : 7154<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>1号通道返回如下, 表示支持 ipmi 协议, 此通道的用户需要开<code>ipmi=on</code>权限, 才能用ipmi命令搞远程控制</p>
<pre class="line-numbers language-none"><code class="language-none">Channel 0x1 info:
  Channel Medium Type   : 802.3 LAN
  Channel Protocol Type : IPMB-1.0
  Session Support       : multi-session
  Active Session Count  : 0
  Protocol Vendor ID    : 7154
  Volatile(active) Settings
    Alerting            : enabled
    Per-message Auth    : enabled
    User Level Auth     : enabled
    Access Mode         : always available
  Non-Volatile Settings
    Alerting            : enabled
    Per-message Auth    : enabled
    User Level Auth     : enabled
    Access Mode         : always available<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li>
<p>查看用户</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ipmitool user list <span class="token punctuation">[</span><span class="token operator">&lt;</span>通道号<span class="token operator">>=</span><span class="token operator">=</span><span class="token number">0,1</span>,2,3<span class="token punctuation">..</span>.,12, 无13, <span class="token number">14,15</span><span class="token punctuation">;</span> 缺省<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-none"><code class="language-none">ID  Name	     Callin  Link Auth	IPMI Msg   Channel Priv Limit
1                    true    false      false      Unknown (0x00)
2   ADMIN            true    false      false      Unknown (0x00)
3                    true    false      false      Unknown (0x00)
4                    true    false      false      Unknown (0x00)
5                    true    false      false      Unknown (0x00)
6                    true    false      false      Unknown (0x00)
7                    true    false      false      Unknown (0x00)
8                    true    false      false      Unknown (0x00)
9                    true    false      false      Unknown (0x00)
10                   true    false      false      Unknown (0x00)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>一般服务器出厂自带的用户名<code>ADMIN</code>，其出厂权限如下:</p>
<ul>
<li>15号通道, 即缺省通道</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ipmitool user list <span class="token comment"># 缺省channel号 是 15</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-none"><code class="language-none">ID  Name	         Callin  Link Auth	IPMI Msg   Channel Priv Limit
2   ADMIN            true    false      false      Unknown (0x00)
【下面的命令用此id&#x3D;2】【需callin&#x3D;true,浏览器才能登录】<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ul>
<li>1号通道</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ipmitool user list <span class="token number">1</span> <span class="token comment"># 1 是channel 号, 一般不改</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>返回</p>
<pre class="line-numbers language-none"><code class="language-none">ID  Name	         Callin  Link Auth	IPMI Msg   Channel Priv Limit
2   ADMIN            false    false      true         ADMINISTRATOR (0x00)
【IPMI&#x3D;true才能使用ipmi的命令行登录】<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li>
<p>若返回如上, 则不需要改用户权限</p>
</li>
<li>
<p>若权限不对, 则执行以下命令</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ipmitool channel setaccess <span class="token number">15</span> <span class="token number">2</span> <span class="token assign-left variable">callin</span><span class="token operator">=</span>on <span class="token assign-left variable">link</span><span class="token operator">=</span>off <span class="token assign-left variable">ipmi</span><span class="token operator">=</span>on <span class="token assign-left variable">privilege</span><span class="token operator">=</span>0x0 <span class="token comment"># 缺省channel号 是 0</span>
<span class="token comment"># 和</span>
<span class="token function">sudo</span> ipmitool channel setaccess <span class="token number">1</span> <span class="token number">2</span> <span class="token assign-left variable">callin</span><span class="token operator">=</span>off <span class="token assign-left variable">link</span><span class="token operator">=</span>off <span class="token assign-left variable">ipmi</span><span class="token operator">=</span>on <span class="token assign-left variable">privilege</span><span class="token operator">=</span>0x4 <span class="token comment"># 1 是 channel 号</span>

<span class="token comment"># 2是用户号, 根据`sudo ipmitool user list [1]`返回的用户号来写</span>
<span class="token comment"># Privilege-level=Administrator</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Privilege levels <code>privilege</code> 的取值</p>
<ul>
<li>
<p><code>0x0</code> - Unknown [初始化为这个, 可以不改]</p>
</li>
<li>
<p><code>0x1</code> - Callbac</p>
</li>
<li>
<p><code>0x2</code> - User</p>
</li>
<li>
<p><code>0x3</code> - Operator</p>
</li>
<li>
<p><code>0x4</code> - Administrator [如果要改, 一般就设成这个]</p>
</li>
<li>
<p><code>0x5</code> - OEM Proprietary</p>
</li>
<li>
<p><code>0xF</code> - No Access</p>
</li>
</ul>
<p>得到上述所需权限</p>
</li>
<li>
<p>交互地修改密码: 对所有通道的第2号用户重设密码</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ipmitool user <span class="token builtin class-name">set</span> password <span class="token number">2</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>然后输入两边密码 <code>junipmi</code></p>
<p>或直接非交互地执行</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ipmitool user <span class="token builtin class-name">set</span> password <span class="token number">2</span> <span class="token operator">&lt;</span>密码<span class="token operator">></span>  <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> <span class="token function">sed</span> -i <span class="token string">'$d'</span> /root/.zsh_history<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>删去最后1行 避免暴露密码</p>
</li>
</ul>
<h2 id="数据线路与管理线路"><a class="header-anchor" href="#数据线路与管理线路"></a>数据线路与管理线路</h2>
<h3 id="线路连接"><a class="header-anchor" href="#线路连接"></a>线路连接</h3>
<p>ipmi的网口接线有两种方法：</p>
<ul>
<li>独立线路：
<ul>
<li>管理线路：一根单独的网线，一段插在服务器上，另一端插在一个交换机上，然后通到外网。此线路仅供ipmi使用。</li>
<li>数据线路：另一单独的网线，一段插在服务器上，另一端插在另一交换机上，然后通到外网。此线路供ssh、http(s)等使用，ipmi不用。</li>
</ul>
</li>
<li>共用线路：上述两线路合并成一个。优点是可以节约一个服务器的网络插口，以及交换机；缺点是，当数据线路坏了，就得去机房修，ipmi用不了。<a target="_blank" rel="noopener" href="https://serverfault.com/questions/259792/how-does-ipmi-sideband-share-the-ethernet-port-with-the-host">参考</a></li>
</ul>
<h3 id="ip设置"><a class="header-anchor" href="#ip设置"></a>ip设置</h3>
<p>不论哪种接线，服务器有以下两个IP（通常是局域网IP）：</p>
<ul>
<li><code>/etc/network/interfaces</code>之<code>eth0</code>（或<code>enp97s0f0</code>等) 的address（即ip）</li>
<li>上文设置的ipmi的ip</li>
</ul>
<p>此二IP必须不同。若是同一个IP，企图用端口区分——ipmi用特定的端口，而ssh、http(s)等用其他特定端口，则从无法连接到ipmi，例如，用浏览器访问此IP，则会显示的是服务器的http(s)的页面，而非ipmi管理页面。</p>
<h3 id="NAT"><a class="header-anchor" href="#NAT"></a>NAT</h3>
<p>为了能在外网用浏览器连接ipmi管理服务器，需要在ipmi的网关上，设置NAT，使得<code>&lt;ipmi的网关的外网ip&gt;:&lt;ipmi的NAT端口&gt;</code> 转发到 <code>&gt;ipmi的ip&gt;:443</code>。其中443是ipmi的https端口。</p>
<h3 id="ipmi各种连接端口"><a class="header-anchor" href="#ipmi各种连接端口"></a>ipmi各种连接端口</h3>
<p>以 Supermicro IPMI (firmware SMT_X9_218) 为例</p>
<table>
<thead>
<tr>
<th>端口</th>
<th>对应协议</th>
<th>协议版本</th>
</tr>
</thead>
<tbody>
<tr>
<td>22/tcp</td>
<td>ssh</td>
<td>Dropbear sshd 2012.55 (protocol 2.0)</td>
</tr>
<tr>
<td>80/tcp</td>
<td>http</td>
<td>lighttpd</td>
</tr>
<tr>
<td>443/tcp</td>
<td>https</td>
<td>lighttpd</td>
</tr>
<tr>
<td>623/tcp</td>
<td>ipmi-rmcp</td>
<td>SuperMicro IPMI RMCP</td>
</tr>
<tr>
<td>623/udp</td>
<td>IPMI</td>
<td>?</td>
</tr>
<tr>
<td>1900/udp</td>
<td>UPnP SSDP</td>
<td>?</td>
</tr>
<tr>
<td>5900/tcp</td>
<td>vnc, ikvm (远程桌面重定向)</td>
<td>VNC (protocol 3.8)</td>
</tr>
<tr>
<td>5985/tcp</td>
<td>wsman</td>
<td>？</td>
</tr>
<tr>
<td>49152/tcp</td>
<td>upnp</td>
<td>ntel UPnP reference SDK 1.3.1 (Linux 2.6.17.WB_WPCM450.1.3; UPnP 1.0)</td>
</tr>
</tbody>
</table>
<p>详见:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://blog.rapid7.com/2013/07/02/a-penetration-testers-guide-to-ipmi/">A Penetration Tester’s Guide to IPMI and BMCs - Network Services</a></li>
<li><a target="_blank" rel="noopener" href="https://www.medo64.com/2018/07/supermicros-ipmi-firewall-rules/">Supermicro’s IPMI Firewall Rules</a></li>
</ul>
<h2 id="从外部连接ipmi"><a class="header-anchor" href="#从外部连接ipmi"></a>从外部连接ipmi</h2>
<p>有多种方法从其他机器连接ipmi来管理服务器：浏览器、命令行工具SMCIPMITool、专用GUI工具<a target="_blank" rel="noopener" href="https://www.supermicro.com/en/solutions/management-software/ipmi-utilities">IPMIView</a>，详见<a target="_blank" rel="noopener" href="https://www.supermicro.com/en/solutions/management-software/ipmi-utilities">简介</a>。一般用浏览器就好了。</p>
<h3 id="浏览器"><a class="header-anchor" href="#浏览器"></a>浏览器</h3>
<p>机房的局域网内，浏览器访问<code>https://&lt;ipmi的ip&gt;</code>；机房外的网络，浏览器访问<code>https://&lt;ipmi的网关的外网ip&gt;:&lt;ipmi的NAT端口&gt;</code></p>
<p>然后在如下界面中输入ipmi账号和密码</p>
<p><img data-src="/posts/85a6419c/ScreenShot%202019-12-19%2023.54.27.png" alt="ScreenShot 2019-12-19 23.54.27"></p>
<p>更多用法，详见<a href="./IPMI%E8%BF%9C%E7%A8%8B%E7%AE%A1%E7%90%86%E5%8A%9F%E8%83%BD%E4%BD%BF%E7%94%A8%E4%BB%8B%E7%BB%8D.docx">IPMI远程管理功能使用介绍.docx</a>。</p>
<h3 id="桌面远程操控"><a class="header-anchor" href="#桌面远程操控"></a>桌面远程操控</h3>
<p>ipmi 支持基于 iKVM 技术, 将服务器的桌面图像发送到远端, 进行桌面远程控制. 有两种方法来实现, 分别是 浏览器中的<code>iKVM/HTML5</code> 和 本地程序<code>Java iKVM Viewer</code>.  此二方法等效.</p>
<h4 id="浏览器中iKVM-HTML5"><a class="header-anchor" href="#浏览器中iKVM-HTML5"></a>浏览器中<code>iKVM/HTML5</code></h4>
<p>本法可直接在浏览器中进行远程桌面控制, 本地程序<code>Java iKVM Viewer</code>比方便. 但老旧版本的服务器的ipmi不支持<code>iKVM/HTML5</code>功能, 在下图中找不到<code>iKVM/HTML5</code>按钮.</p>
<p>在浏览器中连上ipmi的控制页面 (如上文), 如下点击如下</p>
<p><img data-src="/posts/85a6419c/image-20200206175520485.png" alt="image-20200206175520485"></p>
<p>于是浏览器弹出另一个标签页, 内容如下, 在此可进行服务器桌面的远程操控.</p>
<p><img data-src="/posts/85a6419c/image-20200206175801169.png" alt="image-20200206175801169"></p>
<h4 id="使用Java-iKVM-Viewer"><a class="header-anchor" href="#使用Java-iKVM-Viewer"></a>使用<code>Java iKVM Viewer</code></h4>
<p>本法依赖于本地的Java, 用以运行 <code>jnlp </code>文件来加载 Java iKVM Viewer, 以进行远程桌面控制.</p>
<h5 id="获得jnlp文件"><a class="header-anchor" href="#获得jnlp文件"></a>获得jnlp文件</h5>
<p>在浏览器中连上ipmi的控制页面 (如上文), 然后如下点</p>
<p><img data-src="/posts/85a6419c/ScreenShot%202020-02-06%2018.22.03.png" alt="ScreenShot 2020-02-06 18.22.03"></p>
<p>或者点击如下</p>
<p><img data-src="/posts/85a6419c/image-20200206180245990.png" alt="image-20200206180245990"></p>
<p>浏览器会下载一个文件 <code>launch.jnlp</code>. 这个文件需要本地安装有Java才能运行.</p>
<h5 id="端口修改"><a class="header-anchor" href="#端口修改"></a>端口修改</h5>
<p>若你采用了 ssh的端口映射 来连接远程服务器, 则需要把  <code>launch.jnlp</code> 中的端口改成ssh映射到的本地端口.</p>
<p>例如, 若连接服务器采用命令为</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ssh</span> <span class="token operator">&lt;</span>用户名<span class="token operator">></span>@<span class="token operator">&lt;</span>跳板机<span class="token operator">></span> -L <span class="token operator">&lt;</span>ipmi-https-本地端口<span class="token operator">></span>:localhost:443 <span class="token punctuation">\</span>
<span class="token operator">&lt;</span>ipmi-ipmi命令行工具-本地端口<span class="token operator">></span>:localhost:623 <span class="token punctuation">\</span>
<span class="token operator">&lt;</span>ipmi-ikvm-本地端口<span class="token operator">></span>:localhost:5900<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>其中 <code>443</code> 是ipmi的https默认端口,  <code>623</code> 是ipmi的命令行工具默认端口,  <code>5900</code> 是ipmi的ikvm默认端口.</p>
<p>则需要把 <code>launch.jnlp</code> 文件第一行的 <code>443</code> 改为 <code>&lt;ipmi-https-本地端口&gt;</code>,</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jnlp</span> <span class="token attr-name">spec</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1.0+<span class="token punctuation">"</span></span> <span class="token attr-name">codebase</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://localhost:443/<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>文件结尾的  <code>5900</code> 改为 <code>&lt;ipmi-ipmi命令行工具-本地端口&gt;</code>, <code>5900</code> 改为 <code>&lt;ipmi-ikvm-本地端口&gt;</code>.</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>argument</span><span class="token punctuation">></span></span>null<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>argument</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>argument</span><span class="token punctuation">></span></span>5900<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>argument</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>argument</span><span class="token punctuation">></span></span>623<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>argument</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>argument</span><span class="token punctuation">></span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>argument</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>argument</span><span class="token punctuation">></span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>argument</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>application-desc</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jnlp</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="启动远程连接"><a class="header-anchor" href="#启动远程连接"></a>启动远程连接</h5>
<p>双击 <code>launch.jnlp</code> 文件, 然后会依次弹出窗口如下,</p>
<ul>
<li>点 <code>继续</code></li>
</ul>
<p><img data-src="/posts/85a6419c/image-20200206182014080.png" alt="image-20200206182014080"></p>
<ul>
<li>等完成<code>验证</code>, 啥也别点</li>
</ul>
<p><img data-src="/posts/85a6419c/ScreenShot%202020-02-06%2018.24.37.png" alt="ScreenShot 2020-02-06 18.24.37"></p>
<ul>
<li>点<code>运行</code></li>
</ul>
<p><img data-src="/posts/85a6419c/ScreenShot%202020-02-06%2018.24.40.png" alt="ScreenShot 2020-02-06 18.24.40"></p>
<ul>
<li>然后弹出<code>Java iKVM Viewer</code>窗口, 在其中可以进行远程桌面控制.</li>
</ul>
<p><img data-src="/posts/85a6419c/ScreenShot%202020-02-06%2018.25.07.png" alt="ScreenShot 2020-02-06 18.25.07"></p>
<h3 id="终端"><a class="header-anchor" href="#终端"></a>终端</h3>
<h4 id="命令格式"><a class="header-anchor" href="#命令格式"></a>命令格式</h4>
<p>ipmitool除了可以直接在服务器上配置ipmi（见上文），还可以从另一台电脑的终端 远程地控制服务器的ipmi。格式：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ipmitool -H <span class="token operator">&lt;</span>远程ipmi的ip<span class="token operator">></span> -p <span class="token operator">&lt;</span>远程ipmi的端口<span class="token operator">></span>  -I lanplus -U <span class="token operator">&lt;</span>远程ipmi的用户名<span class="token operator">></span> <span class="token punctuation">[</span>-P <span class="token operator">&lt;</span>远程ipmi的密码<span class="token operator">></span><span class="token punctuation">]</span> <span class="token operator">&lt;</span>ipmi的命令<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li>
<p><code>-p &lt;远程ipmi的端口&gt;</code> : 缺省为 <code>623</code>，即iipmi-rmcp协议的默认端口。当使用NAT，将  <code>服务器集群的ipmi的公网ip:ipmi的公网端口</code> NAT 成某服务器的 <code>ipmi的内网ip:ipmi的内网端口</code> ，则此参数写为 <code>-H &lt;服务器集群的ipmi的公网ip&gt; -p &lt;ipmi的公网端口&gt;</code></p>
</li>
<li>
<p><code>-P &lt;远程ipmi的密码&gt;</code> : 此参数若不加，则为交互式输入ipmi的密码，推荐之；否则加此参数，要输入密码明文（不建议）</p>
</li>
<li>
<p><code>&lt;ipmi的命令&gt;</code> : 相当于在服务器上执行了命令 <code>sudo ipmitool &lt;ipmi的命令&gt; </code> ，例如 <code>&lt;ipmi的命令&gt;</code> = <code>lan print 1 </code>，以显示远程服务器上显示ipmi的网络配置</p>
</li>
</ul>
<h4 id="常用的-ipmi的命令"><a class="header-anchor" href="#常用的-ipmi的命令"></a>常用的<code>&lt;ipmi的命令&gt;</code></h4>
<ul>
<li><code>chassis power status</code> ：查看远程服务器电源状态</li>
<li><code>chassis power reset</code> ：重启远程服务器, 相当于按重启机箱上的按键,  掉电后立即上电</li>
<li><code>chassis power reset</code> : 重启远程服务器, 从掉电到上电有１秒钟的间隔</li>
<li><code>chassis power off</code> ：关闭远程服务器电源</li>
<li><code>chassis power on</code> ：然后再开启远程服务器. 这样也相当于按重启机箱上的按键</li>
</ul>
<h2 id="服务器死机处置办法"><a class="header-anchor" href="#服务器死机处置办法"></a>服务器死机处置办法</h2>
<p>以下操作均等效于按机箱上的电源键. 不推荐用<code>power reset</code>, 而是先<code>power off</code>再<code>power on</code>, 因为直接 <code>power reset</code> 掉电后立即上电, 不知道是否关机成功, 而先 <code>power off</code> 再<code>power on</code> 则可根据返回判断是否关机成功.</p>
<h3 id="用浏览器重启"><a class="header-anchor" href="#用浏览器重启"></a>用浏览器重启</h3>
<p>首先考虑用浏览器连接ipmi:</p>
<ul>
<li>点<code>Power Down</code>, 看见 <code>Power On</code> 按钮从灰变亮, 则说明关电源成功.</li>
<li>此时再点 <code>Power On</code>, 看见 <code>Power On</code> 按钮从亮变灰, 且点 <code>Refresh Console Preview</code> 后显示开机界面, 则说明开机成功.</li>
</ul>
<p><img data-src="/posts/85a6419c/image-20200206211639722.png" alt="image-20200206211639722"></p>
<h3 id="用命令重启"><a class="header-anchor" href="#用命令重启"></a>用命令重启</h3>
<p>若用浏览器连ipmi重启服务器不成功, 则尝试用命令行重启服务器</p>
<ul>
<li>关机</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ipmitool -H <span class="token operator">&lt;</span>远程ipmi的ip<span class="token operator">></span> -p <span class="token operator">&lt;</span>远程ipmi的端口<span class="token operator">></span>  -I lanplus -U <span class="token operator">&lt;</span>远程ipmi的用户名<span class="token operator">></span> <span class="token punctuation">[</span>-P <span class="token operator">&lt;</span>远程ipmi的密码<span class="token operator">></span><span class="token punctuation">]</span> chassis power off<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>返回如下则关机成功</p>
<pre class="line-numbers language-none"><code class="language-none">Chassis Power Control: Down&#x2F;Off<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li>开机</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ipmitool -H <span class="token operator">&lt;</span>远程ipmi的ip<span class="token operator">></span> -p <span class="token operator">&lt;</span>远程ipmi的端口<span class="token operator">></span>  -I lanplus -U <span class="token operator">&lt;</span>远程ipmi的用户名<span class="token operator">></span> <span class="token punctuation">[</span>-P <span class="token operator">&lt;</span>远程ipmi的密码<span class="token operator">></span><span class="token punctuation">]</span> chassis power on<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>返回如下则开机成功</p>
<pre class="line-numbers language-none"><code class="language-none">Chassis Power Control: Up&#x2F;On<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>返回如下则是&lt;远程ipmi的密码&gt;输入错误</p>
<pre class="line-numbers language-none"><code class="language-none">Error: Unable to establish IPMI v2 &#x2F; RMCP+ session<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li>浏览器上查看</li>
</ul>
<p>然后在浏览器上ipmi页面, 点 <code>Refresh Console Preview</code> 后显示开机界面, 则说明开机成功.</p>
<h3 id="远程控制开机界面"><a class="header-anchor" href="#远程控制开机界面"></a>远程控制开机界面</h3>
<p>若上面虽然重启成功, 但ssh仍然连不上去, 则说明操作系统启动失败. 此时需要用<a href="#%E6%A1%8C%E9%9D%A2%E8%BF%9C%E7%A8%8B%E6%93%8D%E6%8E%A7">桌面远程操控</a>来进入recovery模式, 进行修复. 操作方法详见 <a href="https://hyliang96.github.io/posts/d3d6ed05/">linux开机界面</a>.</p>
<h2 id="看门狗安装"><a class="header-anchor" href="#看门狗安装"></a>看门狗安装</h2>
<p><a target="_blank" rel="noopener" href="https://github.com/miniwark/miniwark-howtos/blob/master/setup_the_hardware_watchdog_timer_on-ubuntu_12.04.md">参考1</a>   <a target="_blank" rel="noopener" href="https://lesterlo.wordpress.com/2017/06/23/enable-ipmi-watchdog/">参考2</a></p>
<h3 id="看门狗原理"><a class="header-anchor" href="#看门狗原理"></a>看门狗原理</h3>
<p>BMC 上运行了一个计时器，称看门狗。操作性上运行了喂狗的守护进程，每隔几秒（如10秒）去重置 BMC 上的计时器，让它恢复起始计时（如300秒）。若因内内核死机（panic）、内存冻结等，没法及时喂狗，则计时器会持续倒计时。数到0秒时，“狗饿死咬人”，即 BMC 会执行预定操作，如让服务器重启、断电。注意，不是看门狗让系统死机，是若死机则看门狗让系统重启。</p>
<h3 id="安装配置方法-手动执行"><a class="header-anchor" href="#安装配置方法-手动执行"></a>安装配置方法 手动执行</h3>
<p><a target="_blank" rel="noopener" href="http://www.crawford-space.co.uk/old_psc/watchdog/watchdog-configure.html">文档</a></p>
<ul>
<li>安装喂狗进程</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> ipmitool <span class="token comment"># 安装ipmi的命令行工具</span>
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> watchdog <span class="token comment"># 安装喂狗进程</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<ul>
<li>配置喂狗进程：<code>sudo vim /etc/watchdog.conf</code>, 确认有以下几行，若被注释则解注释，若value不同则改之，若无此行则加此行</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">watchdog-device   <span class="token operator">=</span> /dev/watchdog   <span class="token comment"># 狗的驱动 在文件系统下显示为一个特殊文件 /dev/watchdog，喂狗即每几秒往当中写东西，若此文件不更新，则狗“饿死”（倒计时耗尽）“咬人”（执行action）</span>
watchdog-timeout  <span class="token operator">=</span> <span class="token number">300</span>             <span class="token comment"># 狗的倒计时秒数</span>
interval          <span class="token operator">=</span> <span class="token number">10</span>              <span class="token comment"># 喂狗的间隔秒数</span>
realtime         <span class="token operator">=</span> <span class="token function">yes</span>              <span class="token comment">#</span>
priority         <span class="token operator">=</span> <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>设置喂狗进程开机自启 <code>sudo vim /etc/modules</code>, 行尾添加</li>
</ul>
<pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">ipmi_watchdog<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li>设置action：以下是失败的探索</li>
</ul>
<p>设置计时到0后的操作默认为’reset’，即重启服务器，如需修改，则可尝试如下办法，<a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/Kernel_module">来源</a>，但此方法【我实验过无效】：</p>
<p><code>sudo vim /etc/default/openipmi</code>， 确认有以下几行，若被注释则解注释，若value不同则改之，若无此行则加此行</p>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">IPMI_Watchdog</span><span class="token operator">=</span>yes
<span class="token assign-left variable">IPMI_WATCHDOG_OPTIONS</span><span class="token operator">=</span><span class="token string">"timeout=240 action=reset"</span> <span class="token comment"># action的其他选项  'none', 'power_cycle', 'power_off'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<ul>
<li>
<p>重启服务器，以使上述配置生效。重启之后测试：</p>
<ul>
<li>开机自启</li>
</ul>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">lsmod <span class="token operator">|</span> <span class="token function">grep</span> ipmi<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>返回</p>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ipmi_devintf
ipmi_si
ipmi_watchdog   <span class="token comment"># 必需要有这个</span>
ipmi_msghandler<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>喂狗进程状态</li>
</ul>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">service</span> watchdog status<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>返回中必需有如下字样，表面喂狗进程持续运行</p>
  <pre class="line-numbers language-none"><code class="language-none">active (running)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li>查看看门狗状态：连续执行多次</li>
</ul>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ipmitool <span class="token function">mc</span> watchdog get<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>返回</p>
  <pre class="line-numbers language-none"><code class="language-none">Watchdog Timer Use:     SMS&#x2F;OS (0x44)
Watchdog Timer Is:      Started&#x2F;Running   # 需要是Started&#x2F;Running
Watchdog Timer Actions: Hard Reset (0x01) # 需要是Hard Reset
Pre-timeout interval:   0 seconds
Timer Expiration Flags: 0x10
Initial Countdown:      300 sec
Present Countdown:      292 sec  # 多执行几次 这个数不小于 300 - 10 （喂狗间隔）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li>
<p>死机测试：当上述测试正常，且目前无要运行的用户任务，则可在服务器上，用下法人为制造死机（<a target="_blank" rel="noopener" href="https://unix.stackexchange.com/questions/66197/how-to-cause-kernel-panic-with-a-single-command">来源</a>），看看300秒后能否自动重启。若可以，说明看门狗能正常工作。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">su</span>
<span class="token builtin class-name">echo</span> <span class="token number">1</span> <span class="token operator">></span> /proc/sys/kernel/sysrq
<span class="token builtin class-name">echo</span> c <span class="token operator">></span> /proc/sysrq-trigger<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h3 id="安装与测试脚本"><a class="header-anchor" href="#安装与测试脚本"></a>安装与测试脚本</h3>
<p>安装脚本</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> ipmitool -y
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> watchdog -y

<span class="token function">sudo</span> <span class="token function">mv</span> /etc/watchdog.conf /etc/watchdog.conf_backup
<span class="token function">sudo</span> <span class="token function">cat</span> <span class="token operator">&lt;&lt;-</span> <span class="token string">EOM<span class="token bash punctuation"> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> /etc/watchdog.conf <span class="token operator">></span> /dev/null</span>
# ping           = 172.31.14.1
# ping           = 172.26.1.255
# interface      = eth0
# file           = /var/log/messages
# change         = 1407

# Uncomment to enable test. Setting one of these values to '0' disables it.
# These values will hopefully never reboot your machine during normal use
# (if your machine is really hung, the loadavg will go much higher than 25)
# max-load-1     = 24
# max-load-5     = 18
# max-load-15        = 12

# Note that this is the number of pages!
# To get the real size, check how large the pagesize is on your machine.
# min-memory     = 1
# allocatable-memory = 1

# repair-binary      = /usr/sbin/repair
# repair-timeout     = 60
# test-binary        =
# test-timeout       = 60

# The retry-timeout and repair limit are used to handle errors in a more robust
# manner. Errors must persist for longer than retry-timeout to action a repair
# or reboot, and if repair-maximum attempts are made without the test passing a
# reboot is initiated anyway.
# retry-timeout      = 60
# repair-maximum     = 1

watchdog-device = /dev/watchdog
watchdog-timeout  = 300

# Defaults compiled into the binary
# temperature-sensor =
# max-temperature    = 90

# Defaults compiled into the binary
# admin          = root
interval        = 10
# logtick   = 1
# log-dir        = /var/log/watchdog

# This greatly decreases the chance that watchdog won't be scheduled before
# your machine is really loaded
realtime        = yes
priority        = 1

# Check if rsyslogd is still running by enabling the following line
# pidfile        = /var/run/rsyslogd.pid
EOM</span>

<span class="token function">sudo</span> <span class="token builtin class-name">echo</span> ipmi_watchdog <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> -a /etc/modules <span class="token operator">></span> /dev/null

<span class="token comment"># 确认安装成功</span>
<span class="token builtin class-name">echo</span> <span class="token string">'---------------------------------------------------'</span>
<span class="token function">sudo</span> ipmitool <span class="token function">mc</span> watchdog get
<span class="token builtin class-name">echo</span> <span class="token string">'---------------------------------------------------'</span>
<span class="token function">cat</span> /etc/watchdog.conf
<span class="token builtin class-name">echo</span> <span class="token string">'---------------------------------------------------'</span>
<span class="token function">cat</span> /etc/modules<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>重启</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">reboot</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>测试脚本</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">lsmod <span class="token operator">|</span> <span class="token function">grep</span>  ipmi_watchdog<span class="token punctuation">;</span> <span class="token builtin class-name">echo</span><span class="token punctuation">;</span>
<span class="token function">service</span> watchdog status<span class="token punctuation">;</span> <span class="token builtin class-name">echo</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">..</span><span class="token number">5</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token keyword">do</span> <span class="token function">sudo</span> ipmitool <span class="token function">mc</span> watchdog get<span class="token punctuation">;</span> <span class="token builtin class-name">echo</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$i</span> -ne <span class="token number">5</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span> <span class="token function">sleep</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token keyword">fi</span><span class="token punctuation">;</span> <span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>死机测试</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> /proc/sys/kernel/sysrq
<span class="token builtin class-name">echo</span> c <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span>  /proc/sysrq-trigger<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="取消看门狗"><a class="header-anchor" href="#取消看门狗"></a>取消看门狗</h3>
<p>若要让之后每次开机, 看门狗都关着, 需要如下设置:</p>
<ul>
<li>
<p>从 <code>sudo vim /etc/modules</code> , 删去 <code>ipmi_watchdog</code></p>
</li>
<li>
<p>重启系统 <code>sudo reboot</code></p>
</li>
<li>
<p>再次开机后, 看门狗还是开着的, 会持续倒计时, 一直数到 0, 然后自动重启系统. 自动重启前, 看门狗的状态为:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">sudo</span> ipmitool <span class="token function">mc</span> watchdog get
Watchdog Timer Use:     SMS/OS <span class="token punctuation">(</span>0x44<span class="token punctuation">)</span>
Watchdog Timer Is:      Started/Running <span class="token comment"># 看门狗是开着的</span>
Watchdog Timer Actions: Hard Reset <span class="token punctuation">(</span>0x01<span class="token punctuation">)</span> <span class="token comment"># 到 0 重启系统</span>
Pre-timeout interval:   <span class="token number">0</span> seconds
Timer Expiration Flags: 0x10
Initial Countdown:      <span class="token number">600</span> sec
Present Countdown:      <span class="token number">230</span> sec <span class="token comment"># 持续减少, 到 0 重启系统</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li>
<p>自动重启后, 看门狗变成了 stopped, 此后每次重启系统都是这样的:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">sudo</span> ipmitool <span class="token function">mc</span> watchdog get
Watchdog Timer Use:     SMS/OS <span class="token punctuation">(</span>0x04<span class="token punctuation">)</span>
Watchdog Timer Is:      Stopped <span class="token comment"># 变成stop了</span>
Watchdog Timer Actions: Hard Reset <span class="token punctuation">(</span>0x01<span class="token punctuation">)</span>
Pre-timeout interval:   <span class="token number">0</span> seconds
Timer Expiration Flags: 0x10
Initial Countdown:      <span class="token number">600</span> sec
Present Countdown:      <span class="token number">0</span> sec<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h3 id="没有reset持续倒计时-抢救方法"><a class="header-anchor" href="#没有reset持续倒计时-抢救方法"></a>没有reset持续倒计时 - 抢救方法</h3>
<p>若 <code>ipmi_watchdog</code> 模块之前一直在用，之后首次开机没有加载 <code>ipmi_watchdog</code> 模块（可能情况如:上文<a href="#%E5%8F%96%E6%B6%88%E7%9C%8B%E9%97%A8%E7%8B%97">取消看门狗</a>初次重启后，或 <code>ipmi_watchdog</code> 模块开机加载失败 ，等等原因），就会出现如下情况：</p>
<p>看见 <code>sudo ipmitool mc watchdog get</code> 返回</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Watchdog Timer Use:     SMS/OS <span class="token punctuation">(</span>0x44<span class="token punctuation">)</span>
Watchdog Timer Is:      Started/Running
Watchdog Timer Actions: Hard Reset <span class="token punctuation">(</span>0x01<span class="token punctuation">)</span> <span class="token comment"># 只要不是none</span>
Pre-timeout interval:   <span class="token number">0</span> seconds
Timer Expiration Flags: 0x10
Initial Countdown:      <span class="token number">300</span> sec
Present Countdown:      <span class="token number">292</span> sec <span class="token comment"># 在不断减小，不reset</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这表明电脑将很快执行重启、断点等action。故请立即执行</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ipmitool <span class="token function">mc</span> watchdog off<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>如此，倒计时关了，不再用担心被关机。</p>
<p>而后执行如下命令，以设置action=none。此设置立即生效，且只要开机不加载 <code>ipmi_watchdog</code> 模块，此设置在之后开机后依然有效，<a target="_blank" rel="noopener" href="https://fossies.org/linux/watchdog/README.watchdog.ipmi">参考</a>。若开机加载 <code>ipmi_watchdog</code> 模块，则实际执行的是 <code>/etc/watchdog.conf </code> 设置，而非如下设置。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ipmitool raw 0x06 0x24 0x04 0x00 0x00 0x10 0xb8 0x0b<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>如此，会得到action=none, timeout=<code>0xb8 0x0b</code>= 300 s</p>
<pre class="line-numbers language-none"><code class="language-none">$ sudo ipmitool mc watchdog get
Watchdog Timer Use:     SMS&#x2F;OS (0x44)
Watchdog Timer Is:      Started&#x2F;Running
Watchdog Timer Actions: No action (0x00)
Pre-timeout interval:   0 seconds
Timer Expiration Flags: 0x00
Initial Countdown:      300 sec
Present Countdown:      288 sec<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="看门狗的开关"><a class="header-anchor" href="#看门狗的开关"></a>看门狗的开关</h3>
<ul>
<li>查看看门狗配置</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ipmitool <span class="token function">mc</span> watchdog get<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li>关看门狗，不再倒计时</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ipmitool <span class="token function">mc</span> watchdog off<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li>依照最新的看门狗行为设置 启动看门狗</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ipmitool <span class="token function">mc</span> watchdog reset<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="看门狗行为设置"><a class="header-anchor" href="#看门狗行为设置"></a>看门狗行为设置</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> ipmitool raw      0x06 0x24   0x04 0x<span class="token operator">&lt;</span>XX<span class="token operator">></span> 0x00 0x10 0x<span class="token operator">&lt;</span>YY<span class="token operator">></span> 0x<span class="token operator">&lt;</span>ZZ<span class="token operator">></span>
<span class="token comment"># sudo ipmitool raw  | 0x06 0x24 | 0x04 0x&lt;XX> 0x00 0x10 0x&lt;YY> 0x&lt;ZZ></span>
<span class="token comment">#                    |所设是看门狗 | 设置参数</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><code>0x06 0x24</code>：所设置是看门狗</p>
<ul>
<li>第一段 netfn： <code>0x06</code> = &quot;App Application Requests”</li>
<li>第二段 cmd：<code>0x24</code> = &quot;Set Watchdog Timer”</li>
</ul>
<p><code>0x04 0x&lt;XX&gt; 0x00 0x10 0x&lt;YY&gt; 0x&lt;ZZ&gt;</code> ：看门狗的设置参数，<a target="_blank" rel="noopener" href="https://sourceforge.net/p/ipmitool/mailman/ipmitool-devel/thread/4380D254.90908@eurus.dti.ne.jp/">详见</a>。以下只讲解action和实践，<a target="_blank" rel="noopener" href="https://advantech-ncg.zendesk.com/hc/en-us/articles/360028285872-How-to-use-ipmitool-command-to-set-BMC-watchdog-timer-">来源</a> ：</p>
<ul>
<li>action：<code> 0x&lt;XX&gt;</code></li>
</ul>
<p><img data-src="/posts/85a6419c/mceclip1.png" alt="mceclip1.png"></p>
<ul>
<li>倒计时时长：范围 0.1(0X0001) ~6553.5(0XFFFF) seconds</li>
</ul>
<p><img data-src="/posts/85a6419c/mceclip2.png" alt="mceclip2.png"></p>
<p>例如</p>
<p><code>0xc8 0x00</code> = <code> 0x00c8</code> x 100ms = 20,000 ms =20 s</p>
<p><code>0x00 0x0c</code>= <code>0x0c00</code> x 100ms =  307 s</p>
<p><code>0xb8 0x0b</code> = <code>0x0bb8</code> x 100ms = 300 s</p>
<h2 id="https不安全-SSL证书过期"><a class="header-anchor" href="#https不安全-SSL证书过期"></a>https不安全-SSL证书过期</h2>
<h3 id="服务器端添加自签名证书"><a class="header-anchor" href="#服务器端添加自签名证书"></a>服务器端添加自签名证书</h3>
<p><a target="_blank" rel="noopener" href="https://www.bytesizedalex.com/supermicro-ipmi-ssl-tls-certificate-replacement/">参考</a></p>
<p><a target="_blank" rel="noopener" href="http://pkolesni.blogspot.com/2018/02/how-to-replace-supermicro-ipmi-ssl-tls.html">有效教程</a></p>
<p>创私钥  <code>ipmi.pem</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">openssl genrsa -out ipmi.pem <span class="token number">2048</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>用私钥 <code>ipmi.pem</code> 制备证书  <code>ipmi.cert </code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">openssl req -new -key ipmi.pem -out ipmi.cert<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>交互输入如下</p>
<pre class="line-numbers language-none"><code class="language-none">You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter &#39;.&#39;, the field will be left blank.
-----
Country Name (2 letter code) [AU]:CN
State or Province Name (full name) [Some-State]:Beijing
Locality Name (eg, city) []:Beijing
Organization Name (eg, company) [Internet Widgits Pty Ltd]:THU
Organizational Unit Name (eg, section) []:XXX-Lab
        # 也可不填
Common Name (e.g. server FQDN or YOUR name) []:localhost
        # 其他的项目可以乱填，但这个必须写【localhost】，才能用ssh -L端口映射ipmi到localhost后，能安全地连接ipmi
Email Address []:aaaa@xxx.yyyy.cn
        # 邮箱随便填

Please enter the following &#39;extra&#39; attributes
to be sent with your certificate request
A challenge password []:
    # 可不填, 直接回车
An optional company name []:
    # 可不填, 直接回车<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>用私钥 <code>ipmi.pem</code> 签证书 <code>ipmi.cert </code>, 有效820天 (tls服务器证书有效期必需&lt;=825天 <a target="_blank" rel="noopener" href="https://segmentfault.com/q/1010000020699053">出处</a>)</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">openssl x509 -req -days <span class="token number">820</span> -in ipmi.cert  -signkey ipmi.pem -out ipmi.cert<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>然后将  <code>ipmi.cert</code> 上传到 <code>New SSL Certificate</code>,  <code>ipmi.pem </code> 上传到 <code>New Private Key</code>, 再点 <code>Update</code>.</p>
<p><img data-src="/posts/85a6419c/Configuration-SSL-Certification-Menu.png" alt="img"></p>
<p>若显示提交成功, 则会重启ipmi设备 (不是操作系统重启), 一分钟后重新登录此页面, 则有了一个自签名的SSL证书.</p>
<h3 id="浏览器端设置"><a class="header-anchor" href="#浏览器端设置"></a>浏览器端设置</h3>
<h4 id="把刚才的证书添加到本地的钥匙串"><a class="header-anchor" href="#把刚才的证书添加到本地的钥匙串"></a>把刚才的证书添加到本地的钥匙串</h4>
<ul>
<li>mac:</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 若仅为当前用户添加, catalina系统还允许如此操作</span>
security <span class="token function">import</span> ipmi.pem  -k ~/Library/Keychains/login.keychain
<span class="token comment"># 若需为所有用户添加, 但catalina系统不允许如此操作了</span>
<span class="token function">sudo</span> security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain ipmi.pem<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="设置浏览器允许访问不安全的localhost"><a class="header-anchor" href="#设置浏览器允许访问不安全的localhost"></a>设置浏览器允许访问不安全的localhost</h4>
<ul>
<li>chrome 浏览器 访问如下url</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">chrome:&#x2F;&#x2F;flags&#x2F;#allow-insecure-localhost<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<img data-src="/posts/85a6419c/image-20201119231400452.png" alt="image-20201119231400452" style="zoom:50%;">
<p>此项改成enable, 即可访问 <code>https://127.0.0.1:&lt;端口&gt;</code></p>
<ul>
<li>firefox: 无需设置即可访问 <code>https://127.0.0.1:&lt;端口&gt;</code></li>
<li>safari: 可直接访问<code>https://localhost:&lt;端口&gt;</code>; 若无法访问之, 可访问 <code>https://127.0.0.1:&lt;端口&gt;</code>; 欲修复<code>https://localhost:&lt;端口&gt;</code>的访问, 需</li>
</ul>
<h1 id="其他参考资料"><a class="header-anchor" href="#其他参考资料"></a>其他参考资料</h1>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/whatday/article/details/88016972">看门狗的原理</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/erik-smit/oohhh-what-does-this-ipmi-doooo-no-deedee-nooooo/blob/master/1-discovering/snippets/Computercheese/IPMI-BMC%20Watchdog%20Timer%20Commands.txt">ipmitool watchdog 使用示例</a></p>
<p><a target="_blank" rel="noopener" href="https://support.huawei.com/enterprise/zh/doc/EDOC1000061915/528f51d3/configuring-the-ibmc-by-using-the-ipmitool">ipmitool命令文档</a></p>
<p><a target="_blank" rel="noopener" href="https://community.pivotal.io/s/article/How-to-work-on-IPMI-and-IPMITOOL">ipmitool常用命令指南</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/ad9590ca225b">ipmitool常用命令</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.pcfe.net/hugo/posts/2018-08-23-ipmi-watchdog/">IPMI hardware watchdog with RHEL 7 / CentOS 7设置方法</a></p>
<p><a target="_blank" rel="noopener" href="https://serverfault.com/questions/638064/watchdog-service-is-not-working-because-dev-watchdog-does-not-exist">/dev/watchdog文件不存在</a></p>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/17f6ba77/" rel="prev" title="teamviewer-检测为商业用途">
                  <i class="fa fa-chevron-left"></i> teamviewer-检测为商业用途
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/posts/6349216c/" rel="next" title="Zotero安装与配置">
                  Zotero安装与配置 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline-comments"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">∞亼</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">370k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">20:32</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"all","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://waline-hyliang96.vercel.app","placeholder":"Jヾﾉ≧∀≦)o来啊，快活啊!","avatar":"mp","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":["nick","mail"],"libUrl":"https://cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js","el":"#waline-comments","path":"/posts/85a6419c/"}</script>
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() => 
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => {
    new Waline(CONFIG.waline);
  });
});
</script>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300,"hOffset":-25,"vOffset":-60},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
